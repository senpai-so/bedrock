import { createCp } from './cp.js';
import { createRm } from './rm.js';
import mergeOpts from 'merge-options';
import { withTimeoutOption } from 'ipfs-core-utils/with-timeout-option';
const mergeOptions = mergeOpts.bind({ ignoreUndefined: true });
const defaultOptions = {
  parents: false,
  flush: true,
  cidVersion: 0,
  hashAlg: 'sha2-256',
  shardSplitThreshold: 1000
};
export function createMv(context) {
  async function mfsMv(from, to, options = {}) {
    const opts = mergeOptions(defaultOptions, options);
    await createCp(context)(from, to, opts);
    await createRm(context)(from, {
      ...opts,
      recursive: true
    });
  }
  return withTimeoutOption(mfsMv);
}