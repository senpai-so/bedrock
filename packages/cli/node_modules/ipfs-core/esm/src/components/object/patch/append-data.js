import { withTimeoutOption } from 'ipfs-core-utils/with-timeout-option';
import { concat as uint8ArrayConcat } from 'uint8arrays/concat';
import { createGet } from '../get.js';
import { createPut } from '../put.js';
export function createAppendData({repo, preload}) {
  const get = createGet({
    repo,
    preload
  });
  const put = createPut({
    repo,
    preload
  });
  async function appendData(cid, data, options = {}) {
    const node = await get(cid, options);
    const newData = uint8ArrayConcat([
      node.Data || [],
      data
    ]);
    return put({
      ...node,
      Data: newData
    }, options);
  }
  return withTimeoutOption(appendData);
}