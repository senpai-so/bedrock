(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2pGossipsub = factory()}(typeof self !== 'undefined' ? self : this, function () {
var Libp2pGossipsub=(()=>{var su=Object.defineProperty;var g1=t=>su(t,"__esModule",{value:!0});var pn=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(e,r)=>(typeof require!="undefined"?require:e)[r]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var ee=(t,e)=>()=>(t&&(e=t(t=0)),e);var m=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Re=(t,e)=>{g1(t);for(var r in e)su(t,r,{get:e[r],enumerable:!0})};var au=m((EI,ou)=>{var dn=1e3,yn=dn*60,gn=yn*60,Fr=gn*24,b1=Fr*7,v1=Fr*365.25;ou.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return m1(t);if(r==="number"&&isFinite(t))return e.long?w1(t):x1(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function m1(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*v1;case"weeks":case"week":case"w":return r*b1;case"days":case"day":case"d":return r*Fr;case"hours":case"hour":case"hrs":case"hr":case"h":return r*gn;case"minutes":case"minute":case"mins":case"min":case"m":return r*yn;case"seconds":case"second":case"secs":case"sec":case"s":return r*dn;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function x1(t){var e=Math.abs(t);return e>=Fr?Math.round(t/Fr)+"d":e>=gn?Math.round(t/gn)+"h":e>=yn?Math.round(t/yn)+"m":e>=dn?Math.round(t/dn)+"s":t+"ms"}function w1(t){var e=Math.abs(t);return e>=Fr?Ji(t,e,Fr,"day"):e>=gn?Ji(t,e,gn,"hour"):e>=yn?Ji(t,e,yn,"minute"):e>=dn?Ji(t,e,dn,"second"):t+" ms"}function Ji(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}});var uu=m((_I,cu)=>{function E1(t){r.debug=r,r.default=r,r.coerce=f,r.disable=s,r.enable=i,r.enabled=o,r.humanize=au(),r.destroy=u,Object.keys(t).forEach(a=>{r[a]=t[a]}),r.names=[],r.skips=[],r.formatters={};function e(a){let h=0;for(let l=0;l<a.length;l++)h=(h<<5)-h+a.charCodeAt(l),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=e;function r(a){let h,l=null,d,p;function y(...v){if(!y.enabled)return;let b=y,w=Number(new Date),I=w-(h||w);b.diff=I,b.prev=h,b.curr=w,h=w,v[0]=r.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let P=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(S,K)=>{if(S==="%%")return"%";P++;let U=r.formatters[K];if(typeof U=="function"){let ye=v[P];S=U.call(b,ye),v.splice(P,1),P--}return S}),r.formatArgs.call(b,v),(b.log||r.log).apply(b,v)}return y.namespace=a,y.useColors=r.useColors(),y.color=r.selectColor(a),y.extend=n,y.destroy=r.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(d!==r.namespaces&&(d=r.namespaces,p=r.enabled(a)),p),set:v=>{l=v}}),typeof r.init=="function"&&r.init(y),y}function n(a,h){let l=r(this.namespace+(typeof h=="undefined"?":":h)+a);return l.log=this.log,l}function i(a){r.save(a),r.namespaces=a,r.names=[],r.skips=[];let h,l=(typeof a=="string"?a:"").split(/[\s,]+/),d=l.length;for(h=0;h<d;h++)!l[h]||(a=l[h].replace(/\*/g,".*?"),a[0]==="-"?r.skips.push(new RegExp("^"+a.substr(1)+"$")):r.names.push(new RegExp("^"+a+"$")))}function s(){let a=[...r.names.map(c),...r.skips.map(c).map(h=>"-"+h)].join(",");return r.enable(""),a}function o(a){if(a[a.length-1]==="*")return!0;let h,l;for(h=0,l=r.skips.length;h<l;h++)if(r.skips[h].test(a))return!1;for(h=0,l=r.names.length;h<l;h++)if(r.names[h].test(a))return!0;return!1}function c(a){return a.toString().substring(2,a.toString().length-2).replace(/\.\*\?$/,"*")}function f(a){return a instanceof Error?a.stack||a.message:a}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}cu.exports=E1});var Xi=m((Xe,Zi)=>{Xe.formatArgs=S1;Xe.save=I1;Xe.load=A1;Xe.useColors=_1;Xe.storage=C1();Xe.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Xe.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function _1(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function S1(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+Zi.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),t.splice(n,0,e)}Xe.log=console.debug||console.log||(()=>{});function I1(t){try{t?Xe.storage.setItem("debug",t):Xe.storage.removeItem("debug")}catch(e){}}function A1(){let t;try{t=Xe.storage.getItem("debug")}catch(e){}return!t&&typeof process!="undefined"&&"env"in process&&(t=process.env.DEBUG),t}function C1(){try{return localStorage}catch(t){}}Zi.exports=uu()(Xe);var{formatters:B1}=Zi.exports;B1.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var qo=m((SI,Mo)=>{"use strict";var bn=typeof Reflect=="object"?Reflect:null,fu=bn&&typeof bn.apply=="function"?bn.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},es;bn&&typeof bn.ownKeys=="function"?es=bn.ownKeys:Object.getOwnPropertySymbols?es=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:es=function(e){return Object.getOwnPropertyNames(e)};function T1(t){console&&console.warn&&console.warn(t)}var hu=Number.isNaN||function(e){return e!==e};function te(){te.init.call(this)}Mo.exports=te;Mo.exports.once=O1;te.EventEmitter=te;te.prototype._events=void 0;te.prototype._eventsCount=0;te.prototype._maxListeners=void 0;var lu=10;function ts(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(te,"defaultMaxListeners",{enumerable:!0,get:function(){return lu},set:function(t){if(typeof t!="number"||t<0||hu(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");lu=t}});te.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};te.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||hu(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function pu(t){return t._maxListeners===void 0?te.defaultMaxListeners:t._maxListeners}te.prototype.getMaxListeners=function(){return pu(this)};te.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var c=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw c.context=o,c}var f=s[e];if(f===void 0)return!1;if(typeof f=="function")fu(f,this,r);else for(var u=f.length,a=vu(f,u),n=0;n<u;++n)fu(a[n],this,r);return!0};function du(t,e,r,n){var i,s,o;if(ts(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=pu(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=o.length,T1(c)}return t}te.prototype.addListener=function(e,r){return du(this,e,r,!1)};te.prototype.on=te.prototype.addListener;te.prototype.prependListener=function(e,r){return du(this,e,r,!0)};function R1(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function yu(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=R1.bind(n);return i.listener=r,n.wrapFn=i,i}te.prototype.once=function(e,r){return ts(r),this.on(e,yu(this,e,r)),this};te.prototype.prependOnceListener=function(e,r){return ts(r),this.prependListener(e,yu(this,e,r)),this};te.prototype.removeListener=function(e,r){var n,i,s,o,c;if(ts(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount==0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){c=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():P1(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,c||r)}return this};te.prototype.off=te.prototype.removeListener;te.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function gu(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?D1(i):vu(i,i.length)}te.prototype.listeners=function(e){return gu(this,e,!0)};te.prototype.rawListeners=function(e){return gu(this,e,!1)};te.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):bu.call(t,e)};te.prototype.listenerCount=bu;function bu(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}te.prototype.eventNames=function(){return this._eventsCount>0?es(this._events):[]};function vu(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function P1(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function D1(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function O1(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}mu(t,e,s,{once:!0}),e!=="error"&&k1(t,i,{once:!0})})}function k1(t,e,r){typeof t.on=="function"&&mu(t,"error",e,r)}function mu(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}});var ce=m((II,wu)=>{"use strict";function xu(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function N1(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return xu(t,r)}catch(n){r.message=t.message,r.stack=t.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(t)),xu(new i,r)}}wu.exports=N1});var Uo=m((AI,vn)=>{var Eu=(...t)=>{let e;for(;t.length;)e=t.shift()(e);return e},Fo=t=>t&&(typeof t[Symbol.asyncIterator]=="function"||typeof t[Symbol.iterator]=="function"||typeof t.next=="function"),rs=t=>t&&typeof t.sink=="function"&&Fo(t.source),L1=t=>e=>(t.sink(e),t.source),_u=(...t)=>{if(rs(t[0])){let e=t[0];t[0]=()=>e.source}else if(Fo(t[0])){let e=t[0];t[0]=()=>e}if(t.length>1&&rs(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let e=1;e<t.length-1;e++)rs(t[e])&&(t[e]=L1(t[e]));return Eu(...t)};vn.exports=_u;vn.exports.pipe=_u;vn.exports.rawPipe=Eu;vn.exports.isIterable=Fo;vn.exports.isDuplex=rs});var Iu=m((CI,Go)=>{"use strict";var K1=Object.prototype.hasOwnProperty,Ve="~";function Xn(){}Object.create&&(Xn.prototype=Object.create(null),new Xn().__proto__||(Ve=!1));function M1(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function Su(t,e,r,n,i){if(typeof r!="function")throw new TypeError("The listener must be a function");var s=new M1(r,n||t,i),o=Ve?Ve+e:e;return t._events[o]?t._events[o].fn?t._events[o]=[t._events[o],s]:t._events[o].push(s):(t._events[o]=s,t._eventsCount++),t}function ns(t,e){--t._eventsCount==0?t._events=new Xn:delete t._events[e]}function Oe(){this._events=new Xn,this._eventsCount=0}Oe.prototype.eventNames=function(){var e=[],r,n;if(this._eventsCount===0)return e;for(n in r=this._events)K1.call(r,n)&&e.push(Ve?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r)):e};Oe.prototype.listeners=function(e){var r=Ve?Ve+e:e,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,o=new Array(s);i<s;i++)o[i]=n[i].fn;return o};Oe.prototype.listenerCount=function(e){var r=Ve?Ve+e:e,n=this._events[r];return n?n.fn?1:n.length:0};Oe.prototype.emit=function(e,r,n,i,s,o){var c=Ve?Ve+e:e;if(!this._events[c])return!1;var f=this._events[c],u=arguments.length,a,h;if(f.fn){switch(f.once&&this.removeListener(e,f.fn,void 0,!0),u){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,r),!0;case 3:return f.fn.call(f.context,r,n),!0;case 4:return f.fn.call(f.context,r,n,i),!0;case 5:return f.fn.call(f.context,r,n,i,s),!0;case 6:return f.fn.call(f.context,r,n,i,s,o),!0}for(h=1,a=new Array(u-1);h<u;h++)a[h-1]=arguments[h];f.fn.apply(f.context,a)}else{var l=f.length,d;for(h=0;h<l;h++)switch(f[h].once&&this.removeListener(e,f[h].fn,void 0,!0),u){case 1:f[h].fn.call(f[h].context);break;case 2:f[h].fn.call(f[h].context,r);break;case 3:f[h].fn.call(f[h].context,r,n);break;case 4:f[h].fn.call(f[h].context,r,n,i);break;default:if(!a)for(d=1,a=new Array(u-1);d<u;d++)a[d-1]=arguments[d];f[h].fn.apply(f[h].context,a)}}return!0};Oe.prototype.on=function(e,r,n){return Su(this,e,r,n,!1)};Oe.prototype.once=function(e,r,n){return Su(this,e,r,n,!0)};Oe.prototype.removeListener=function(e,r,n,i){var s=Ve?Ve+e:e;if(!this._events[s])return this;if(!r)return ns(this,s),this;var o=this._events[s];if(o.fn)o.fn===r&&(!i||o.once)&&(!n||o.context===n)&&ns(this,s);else{for(var c=0,f=[],u=o.length;c<u;c++)(o[c].fn!==r||i&&!o[c].once||n&&o[c].context!==n)&&f.push(o[c]);f.length?this._events[s]=f.length===1?f[0]:f:ns(this,s)}return this};Oe.prototype.removeAllListeners=function(e){var r;return e?(r=Ve?Ve+e:e,this._events[r]&&ns(this,r)):(this._events=new Xn,this._eventsCount=0),this};Oe.prototype.off=Oe.prototype.removeListener;Oe.prototype.addListener=Oe.prototype.on;Oe.prefixed=Ve;Oe.EventEmitter=Oe;typeof Go!="undefined"&&(Go.exports=Oe)});var Cu=m((BI,Au)=>{"use strict";Au.exports=(t,e)=>(e=e||(()=>{}),t.then(r=>new Promise(n=>{n(e())}).then(()=>r),r=>new Promise(n=>{n(e())}).then(()=>{throw r})))});var Tu=m((TI,is)=>{"use strict";var q1=Cu(),Vo=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},Bu=(t,e,r)=>new Promise((n,i)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){n(t);return}let s=setTimeout(()=>{if(typeof r=="function"){try{n(r())}catch(f){i(f)}return}let o=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,c=r instanceof Error?r:new Vo(o);typeof t.cancel=="function"&&t.cancel(),i(c)},e);q1(t.then(n,i),()=>{clearTimeout(s)})});is.exports=Bu;is.exports.default=Bu;is.exports.TimeoutError=Vo});var Ru=m(jo=>{"use strict";Object.defineProperty(jo,"__esModule",{value:!0});function F1(t,e,r){let n=0,i=t.length;for(;i>0;){let s=i/2|0,o=n+s;r(t[o],e)<=0?(n=++o,i-=s+1):i=s}return n}jo.default=F1});var Du=m(Ho=>{"use strict";Object.defineProperty(Ho,"__esModule",{value:!0});var U1=Ru(),Pu=class{constructor(){this._queue=[]}enqueue(e,r){r=Object.assign({priority:0},r);let n={priority:r.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=r.priority){this._queue.push(n);return}let i=U1.default(this._queue,n,(s,o)=>o.priority-s.priority);this._queue.splice(i,0,n)}dequeue(){let e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return this._queue.length}};Ho.default=Pu});var Nu=m(zo=>{"use strict";Object.defineProperty(zo,"__esModule",{value:!0});var G1=Iu(),Ou=Tu(),V1=Du(),ss=()=>{},j1=new Ou.TimeoutError,ku=class extends G1{constructor(e){var r,n,i,s;super();if(this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=ss,this._resolveIdle=ss,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:V1.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(r=e.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=ss,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=ss,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let r=this._intervalEnd-e;if(r<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},r)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let r=this._queue.dequeue();return r?(this.emit("active"),r(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,r={}){return new Promise((n,i)=>{let s=async()=>{this._pendingCount++,this._intervalCount++;try{let o=this._timeout===void 0&&r.timeout===void 0?e():Ou.default(Promise.resolve(e()),r.timeout===void 0?this._timeout:r.timeout,()=>{(r.throwOnTimeout===void 0?this._throwOnTimeout:r.throwOnTimeout)&&i(j1)});n(await o)}catch(o){i(o)}this._next()};this._queue.enqueue(s,r),this._tryToStartAnother(),this.emit("add")})}async addAll(e,r){return Promise.all(e.map(async n=>this.add(n,r)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let r=this._resolveEmpty;this._resolveEmpty=()=>{r(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let r=this._resolveIdle;this._resolveIdle=()=>{r(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};zo.default=ku});var Fu=m((OI,qu)=>{"use strict";var Lu=()=>{},Ku=Symbol.for("@libp2p/js-interfaces/topology"),Mu=class{constructor({min:e=0,max:r=1/0,handlers:n={}}){this.min=e,this.max=r,this._onConnect=n.onConnect||Lu,this._onDisconnect=n.onDisconnect||Lu,this.peers=new Set}get[Symbol.toStringTag](){return"Topology"}get[Ku](){return!0}static isTopology(e){return Boolean(e&&e[Ku])}set registrar(e){this._registrar=e}disconnect(e){this._onDisconnect(e)}};qu.exports=Mu});var ju=m((kI,Vu)=>{"use strict";var H1=Fu(),Uu=Symbol.for("@libp2p/js-interfaces/topology/multicodec-topology"),Gu=class extends H1{constructor({min:e,max:r,multicodecs:n,handlers:i}){super({min:e,max:r,handlers:i});if(!n)throw new Error("one or more multicodec should be provided");if(!i)throw new Error("the handlers should be provided");if(typeof i.onConnect!="function")throw new Error("the 'onConnect' handler must be provided");if(typeof i.onDisconnect!="function")throw new Error("the 'onDisconnect' handler must be provided");this.multicodecs=Array.isArray(n)?n:[n],this._registrar=void 0,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerConnect=this._onPeerConnect.bind(this)}get[Symbol.toStringTag](){return"Topology"}get[Uu](){return!0}static isMulticodecTopology(e){return Boolean(e&&e[Uu])}set registrar(e){this._registrar=e,this._registrar.peerStore.on("change:protocols",this._onProtocolChange),this._registrar.connectionManager.on("peer:connect",this._onPeerConnect),this._updatePeers(this._registrar.peerStore.peers.values())}_updatePeers(e){for(let{id:r,protocols:n}of e)if(this.multicodecs.filter(i=>n.includes(i)).length){this.peers.add(r.toB58String());let i=this._registrar.getConnection(r);i&&this._onConnect(r,i)}else this.peers.delete(r.toB58String())}_onProtocolChange({peerId:e,protocols:r}){let n=this.peers.has(e.toB58String()),i=r.filter(s=>this.multicodecs.includes(s));n&&i.length===0&&this._onDisconnect(e);for(let s of r)if(this.multicodecs.includes(s)){let o=this._registrar.peerStore.get(e);this._updatePeers([o]);return}}_onPeerConnect(e){let r=e.remotePeer,n=this._registrar.peerStore.protoBook.get(r);!n||this.multicodecs.find(i=>n.includes(i))&&(this.peers.add(r.toB58String()),this._onConnect(r,e))}};Vu.exports=Gu});var os=m(Hu=>{"use strict";Hu.codes={ERR_INVALID_SIGNATURE_POLICY:"ERR_INVALID_SIGNATURE_POLICY",ERR_UNHANDLED_SIGNATURE_POLICY:"ERR_UNHANDLED_SIGNATURE_POLICY",ERR_MISSING_SIGNATURE:"ERR_MISSING_SIGNATURE",ERR_MISSING_SEQNO:"ERR_MISSING_SEQNO",ERR_INVALID_SIGNATURE:"ERR_INVALID_SIGNATURE",ERR_UNEXPECTED_FROM:"ERR_UNEXPECTED_FROM",ERR_UNEXPECTED_SIGNATURE:"ERR_UNEXPECTED_SIGNATURE",ERR_UNEXPECTED_KEY:"ERR_UNEXPECTED_KEY",ERR_UNEXPECTED_SEQNO:"ERR_UNEXPECTED_SEQNO"}});var Wu=m((LI,zu)=>{"use strict";zu.exports=z1;function z1(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,s=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(c,f){r[n]=function(a){if(s)if(s=!1,a)f(a);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];c.apply(null,h)}};try{t.apply(e||null,r)}catch(u){s&&(s=!1,f(u))}})}});var Ju=m(Qu=>{"use strict";var as=Qu;as.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var mn=new Array(64),$u=new Array(123);for(yt=0;yt<64;)$u[mn[yt]=yt<26?yt+65:yt<52?yt+71:yt<62?yt-4:yt-59|43]=yt++;var yt;as.encode=function(e,r,n){for(var i=null,s=[],o=0,c=0,f;r<n;){var u=e[r++];switch(c){case 0:s[o++]=mn[u>>2],f=(u&3)<<4,c=1;break;case 1:s[o++]=mn[f|u>>4],f=(u&15)<<2,c=2;break;case 2:s[o++]=mn[f|u>>6],s[o++]=mn[u&63],c=0;break}o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),o=0)}return c&&(s[o++]=mn[f],s[o++]=61,c===1&&(s[o++]=61)),i?(o&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var Yu="invalid encoding";as.decode=function(e,r,n){for(var i=n,s=0,o,c=0;c<e.length;){var f=e.charCodeAt(c++);if(f===61&&s>1)break;if((f=$u[f])===void 0)throw Error(Yu);switch(s){case 0:o=f,s=1;break;case 1:r[n++]=o<<2|(f&48)>>4,o=f,s=2;break;case 2:r[n++]=(o&15)<<4|(f&60)>>2,o=f,s=3;break;case 3:r[n++]=(o&3)<<6|f,s=0;break}}if(s===1)throw Error(Yu);return n-i};as.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var Xu=m((MI,Zu)=>{"use strict";Zu.exports=cs;function cs(){this._listeners={}}cs.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};cs.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};cs.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var af=m((qI,of)=>{"use strict";of.exports=ef(ef);function ef(t){return typeof Float32Array!="undefined"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(f,u,a){e[0]=f,u[a]=r[0],u[a+1]=r[1],u[a+2]=r[2],u[a+3]=r[3]}function s(f,u,a){e[0]=f,u[a]=r[3],u[a+1]=r[2],u[a+2]=r[1],u[a+3]=r[0]}t.writeFloatLE=n?i:s,t.writeFloatBE=n?s:i;function o(f,u){return r[0]=f[u],r[1]=f[u+1],r[2]=f[u+2],r[3]=f[u+3],e[0]}function c(f,u){return r[3]=f[u],r[2]=f[u+1],r[1]=f[u+2],r[0]=f[u+3],e[0]}t.readFloatLE=n?o:c,t.readFloatBE=n?c:o}():function(){function e(n,i,s,o){var c=i<0?1:0;if(c&&(i=-i),i===0)n(1/i>0?0:2147483648,s,o);else if(isNaN(i))n(2143289344,s,o);else if(i>34028234663852886e22)n((c<<31|2139095040)>>>0,s,o);else if(i<11754943508222875e-54)n((c<<31|Math.round(i/1401298464324817e-60))>>>0,s,o);else{var f=Math.floor(Math.log(i)/Math.LN2),u=Math.round(i*Math.pow(2,-f)*8388608)&8388607;n((c<<31|f+127<<23|u)>>>0,s,o)}}t.writeFloatLE=e.bind(null,tf),t.writeFloatBE=e.bind(null,rf);function r(n,i,s){var o=n(i,s),c=(o>>31)*2+1,f=o>>>23&255,u=o&8388607;return f===255?u?NaN:c*(1/0):f===0?c*1401298464324817e-60*u:c*Math.pow(2,f-150)*(u+8388608)}t.readFloatLE=r.bind(null,nf),t.readFloatBE=r.bind(null,sf)}(),typeof Float64Array!="undefined"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(f,u,a){e[0]=f,u[a]=r[0],u[a+1]=r[1],u[a+2]=r[2],u[a+3]=r[3],u[a+4]=r[4],u[a+5]=r[5],u[a+6]=r[6],u[a+7]=r[7]}function s(f,u,a){e[0]=f,u[a]=r[7],u[a+1]=r[6],u[a+2]=r[5],u[a+3]=r[4],u[a+4]=r[3],u[a+5]=r[2],u[a+6]=r[1],u[a+7]=r[0]}t.writeDoubleLE=n?i:s,t.writeDoubleBE=n?s:i;function o(f,u){return r[0]=f[u],r[1]=f[u+1],r[2]=f[u+2],r[3]=f[u+3],r[4]=f[u+4],r[5]=f[u+5],r[6]=f[u+6],r[7]=f[u+7],e[0]}function c(f,u){return r[7]=f[u],r[6]=f[u+1],r[5]=f[u+2],r[4]=f[u+3],r[3]=f[u+4],r[2]=f[u+5],r[1]=f[u+6],r[0]=f[u+7],e[0]}t.readDoubleLE=n?o:c,t.readDoubleBE=n?c:o}():function(){function e(n,i,s,o,c,f){var u=o<0?1:0;if(u&&(o=-o),o===0)n(0,c,f+i),n(1/o>0?0:2147483648,c,f+s);else if(isNaN(o))n(0,c,f+i),n(2146959360,c,f+s);else if(o>17976931348623157e292)n(0,c,f+i),n((u<<31|2146435072)>>>0,c,f+s);else{var a;if(o<22250738585072014e-324)a=o/5e-324,n(a>>>0,c,f+i),n((u<<31|a/4294967296)>>>0,c,f+s);else{var h=Math.floor(Math.log(o)/Math.LN2);h===1024&&(h=1023),a=o*Math.pow(2,-h),n(a*4503599627370496>>>0,c,f+i),n((u<<31|h+1023<<20|a*1048576&1048575)>>>0,c,f+s)}}}t.writeDoubleLE=e.bind(null,tf,0,4),t.writeDoubleBE=e.bind(null,rf,4,0);function r(n,i,s,o,c){var f=n(o,c+i),u=n(o,c+s),a=(u>>31)*2+1,h=u>>>20&2047,l=4294967296*(u&1048575)+f;return h===2047?l?NaN:a*(1/0):h===0?a*5e-324*l:a*Math.pow(2,h-1075)*(l+4503599627370496)}t.readDoubleLE=r.bind(null,nf,0,4),t.readDoubleBE=r.bind(null,sf,4,0)}(),t}function tf(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function rf(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function nf(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function sf(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var cf=m((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var ff=m(uf=>{"use strict";var Wo=uf;Wo.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)==55296&&(e.charCodeAt(i+1)&64512)==56320?(++i,r+=4):r+=3;return r};Wo.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var s=null,o=[],c=0,f;r<n;)f=e[r++],f<128?o[c++]=f:f>191&&f<224?o[c++]=(f&31)<<6|e[r++]&63:f>239&&f<365?(f=((f&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,o[c++]=55296+(f>>10),o[c++]=56320+(f&1023)):o[c++]=(f&15)<<12|(e[r++]&63)<<6|e[r++]&63,c>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),c=0);return s?(c&&s.push(String.fromCharCode.apply(String,o.slice(0,c))),s.join("")):String.fromCharCode.apply(String,o.slice(0,c))};Wo.write=function(e,r,n){for(var i=n,s,o,c=0;c<e.length;++c)s=e.charCodeAt(c),s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=s&63|128):(s&64512)==55296&&((o=e.charCodeAt(c+1))&64512)==56320?(s=65536+((s&1023)<<10)+(o&1023),++c,r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=s&63|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=s&63|128);return n-i}});var lf=m((UI,hf)=>{"use strict";hf.exports=W1;function W1(t,e,r){var n=r||8192,i=n>>>1,s=null,o=n;return function(f){if(f<1||f>i)return t(f);o+f>n&&(s=t(n),o=0);var u=e.call(s,o,o+=f);return o&7&&(o=(o|7)+1),u}}});var df=m((GI,pf)=>{"use strict";pf.exports=Se;var ei=pr();function Se(t,e){this.lo=t>>>0,this.hi=e>>>0}var Ur=Se.zero=new Se(0,0);Ur.toNumber=function(){return 0};Ur.zzEncode=Ur.zzDecode=function(){return this};Ur.length=function(){return 1};var $1=Se.zeroHash="\0\0\0\0\0\0\0\0";Se.fromNumber=function(e){if(e===0)return Ur;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new Se(n,i)};Se.from=function(e){if(typeof e=="number")return Se.fromNumber(e);if(ei.isString(e))if(ei.Long)e=ei.Long.fromString(e);else return Se.fromNumber(parseInt(e,10));return e.low||e.high?new Se(e.low>>>0,e.high>>>0):Ur};Se.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};Se.prototype.toLong=function(e){return ei.Long?new ei.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var lr=String.prototype.charCodeAt;Se.fromHash=function(e){return e===$1?Ur:new Se((lr.call(e,0)|lr.call(e,1)<<8|lr.call(e,2)<<16|lr.call(e,3)<<24)>>>0,(lr.call(e,4)|lr.call(e,5)<<8|lr.call(e,6)<<16|lr.call(e,7)<<24)>>>0)};Se.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Se.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Se.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Se.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var pr=m($o=>{"use strict";var N=$o;N.asPromise=Wu();N.base64=Ju();N.EventEmitter=Xu();N.float=af();N.inquire=cf();N.utf8=ff();N.pool=lf();N.LongBits=df();N.isNode=Boolean(typeof globalThis!="undefined"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);N.global=N.isNode&&globalThis||typeof window!="undefined"&&window||typeof self!="undefined"&&self||$o;N.emptyArray=Object.freeze?Object.freeze([]):[];N.emptyObject=Object.freeze?Object.freeze({}):{};N.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};N.isString=function(e){return typeof e=="string"||e instanceof String};N.isObject=function(e){return e&&typeof e=="object"};N.isset=N.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};N.Buffer=function(){try{var t=N.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(e){return null}}();N._Buffer_from=null;N._Buffer_allocUnsafe=null;N.newBuffer=function(e){return typeof e=="number"?N.Buffer?N._Buffer_allocUnsafe(e):new N.Array(e):N.Buffer?N._Buffer_from(e):typeof Uint8Array=="undefined"?e:new Uint8Array(e)};N.Array=typeof Uint8Array!="undefined"?Uint8Array:Array;N.Long=N.global.dcodeIO&&N.global.dcodeIO.Long||N.global.Long||N.inquire("long");N.key2Re=/^true|false|0|1$/;N.key32Re=/^-?(?:0|[1-9][0-9]*)$/;N.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;N.longToHash=function(e){return e?N.LongBits.from(e).toHash():N.LongBits.zeroHash};N.longFromHash=function(e,r){var n=N.LongBits.fromHash(e);return N.Long?N.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))};function yf(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}N.merge=yf;N.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function gf(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&yf(this,n)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}N.newError=gf;N.ProtocolError=gf("ProtocolError");N.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(r[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};N.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};N.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};N._configure=function(){var t=N.Buffer;if(!t){N._Buffer_from=N._Buffer_allocUnsafe=null;return}N._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},N._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var ta=m((jI,xf)=>{"use strict";xf.exports=z;var tt=pr(),Yo,us=tt.LongBits,bf=tt.base64,vf=tt.utf8;function ti(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function Qo(){}function Y1(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function z(){this.len=0,this.head=new ti(Qo,0,0),this.tail=this.head,this.states=null}var mf=function(){return tt.Buffer?function(){return(z.create=function(){return new Yo})()}:function(){return new z}};z.create=mf();z.alloc=function(e){return new tt.Array(e)};tt.Array!==Array&&(z.alloc=tt.pool(z.alloc,tt.Array.prototype.subarray));z.prototype._push=function(e,r,n){return this.tail=this.tail.next=new ti(e,r,n),this.len+=r,this};function Jo(t,e,r){e[r]=t&255}function Q1(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function Zo(t,e){this.len=t,this.next=void 0,this.val=e}Zo.prototype=Object.create(ti.prototype);Zo.prototype.fn=Q1;z.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Zo((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};z.prototype.int32=function(e){return e<0?this._push(Xo,10,us.fromNumber(e)):this.uint32(e)};z.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Xo(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}z.prototype.uint64=function(e){var r=us.from(e);return this._push(Xo,r.length(),r)};z.prototype.int64=z.prototype.uint64;z.prototype.sint64=function(e){var r=us.from(e).zzEncode();return this._push(Xo,r.length(),r)};z.prototype.bool=function(e){return this._push(Jo,1,e?1:0)};function ea(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}z.prototype.fixed32=function(e){return this._push(ea,4,e>>>0)};z.prototype.sfixed32=z.prototype.fixed32;z.prototype.fixed64=function(e){var r=us.from(e);return this._push(ea,4,r.lo)._push(ea,4,r.hi)};z.prototype.sfixed64=z.prototype.fixed64;z.prototype.float=function(e){return this._push(tt.float.writeFloatLE,4,e)};z.prototype.double=function(e){return this._push(tt.float.writeDoubleLE,8,e)};var J1=tt.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};z.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(Jo,1,0);if(tt.isString(e)){var n=z.alloc(r=bf.length(e));bf.decode(e,n,0),e=n}return this.uint32(r)._push(J1,r,e)};z.prototype.string=function(e){var r=vf.length(e);return r?this.uint32(r)._push(vf.write,r,e):this._push(Jo,1,0)};z.prototype.fork=function(){return this.states=new Y1(this),this.head=this.tail=new ti(Qo,0,0),this.len=0,this};z.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new ti(Qo,0,0),this.len=0),this};z.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};z.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};z._configure=function(t){Yo=t,z.create=mf(),Yo._configure()}});var _f=m((HI,Ef)=>{"use strict";Ef.exports=Ct;var wf=ta();(Ct.prototype=Object.create(wf.prototype)).constructor=Ct;var dr=pr();function Ct(){wf.call(this)}Ct._configure=function(){Ct.alloc=dr._Buffer_allocUnsafe,Ct.writeBytesBuffer=dr.Buffer&&dr.Buffer.prototype instanceof Uint8Array&&dr.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};Ct.prototype.bytes=function(e){dr.isString(e)&&(e=dr._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(Ct.writeBytesBuffer,r,e),this};function Z1(t,e,r){t.length<40?dr.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}Ct.prototype.string=function(e){var r=dr.Buffer.byteLength(e);return this.uint32(r),r&&this._push(Z1,r,e),this};Ct._configure()});var ia=m((zI,Bf)=>{"use strict";Bf.exports=ve;var Bt=pr(),ra,Sf=Bt.LongBits,X1=Bt.utf8;function gt(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function ve(t){this.buf=t,this.pos=0,this.len=t.length}var If=typeof Uint8Array!="undefined"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new ve(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new ve(e);throw Error("illegal buffer")},Af=function(){return Bt.Buffer?function(r){return(ve.create=function(i){return Bt.Buffer.isBuffer(i)?new ra(i):If(i)})(r)}:If};ve.create=Af();ve.prototype._slice=Bt.Array.prototype.subarray||Bt.Array.prototype.slice;ve.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,gt(this,10);return e}}();ve.prototype.int32=function(){return this.uint32()|0};ve.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function na(){var t=new Sf(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw gt(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw gt(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}ve.prototype.bool=function(){return this.uint32()!==0};function fs(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}ve.prototype.fixed32=function(){if(this.pos+4>this.len)throw gt(this,4);return fs(this.buf,this.pos+=4)};ve.prototype.sfixed32=function(){if(this.pos+4>this.len)throw gt(this,4);return fs(this.buf,this.pos+=4)|0};function Cf(){if(this.pos+8>this.len)throw gt(this,8);return new Sf(fs(this.buf,this.pos+=4),fs(this.buf,this.pos+=4))}ve.prototype.float=function(){if(this.pos+4>this.len)throw gt(this,4);var e=Bt.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};ve.prototype.double=function(){if(this.pos+8>this.len)throw gt(this,4);var e=Bt.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};ve.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw gt(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};ve.prototype.string=function(){var e=this.bytes();return X1.read(e,0,e.length)};ve.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw gt(this,e);this.pos+=e}else do if(this.pos>=this.len)throw gt(this);while(this.buf[this.pos++]&128);return this};ve.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!=4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};ve._configure=function(t){ra=t,ve.create=Af(),ra._configure();var e=Bt.Long?"toLong":"toNumber";Bt.merge(ve.prototype,{int64:function(){return na.call(this)[e](!1)},uint64:function(){return na.call(this)[e](!0)},sint64:function(){return na.call(this).zzDecode()[e](!1)},fixed64:function(){return Cf.call(this)[e](!0)},sfixed64:function(){return Cf.call(this)[e](!1)}})}});var Df=m((WI,Pf)=>{"use strict";Pf.exports=Gr;var Tf=ia();(Gr.prototype=Object.create(Tf.prototype)).constructor=Gr;var Rf=pr();function Gr(t){Tf.call(this,t)}Gr._configure=function(){Rf.Buffer&&(Gr.prototype._slice=Rf.Buffer.prototype.slice)};Gr.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Gr._configure()});var kf=m(($I,Of)=>{"use strict";Of.exports=ri;var sa=pr();(ri.prototype=Object.create(sa.EventEmitter.prototype)).constructor=ri;function ri(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");sa.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}ri.prototype.rpcCall=function t(e,r,n,i,s){if(!i)throw TypeError("request must be specified");var o=this;if(!s)return sa.asPromise(t,o,e,r,n,i);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,r[o.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(f,u){if(f)return o.emit("error",f,e),s(f);if(u===null){o.end(!0);return}if(!(u instanceof n))try{u=n[o.responseDelimited?"decodeDelimited":"decode"](u)}catch(a){return o.emit("error",a,e),s(a)}return o.emit("data",u,e),s(null,u)})}catch(c){o.emit("error",c,e),setTimeout(function(){s(c)},0);return}};ri.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var Lf=m(Nf=>{"use strict";var eb=Nf;eb.Service=kf()});var Mf=m((QI,Kf)=>{"use strict";Kf.exports={}});var Uf=m(Ff=>{"use strict";var $e=Ff;$e.build="minimal";$e.Writer=ta();$e.BufferWriter=_f();$e.Reader=ia();$e.BufferReader=Df();$e.util=pr();$e.rpc=Lf();$e.roots=Mf();$e.configure=qf;function qf(){$e.util._configure(),$e.Writer._configure($e.BufferWriter),$e.Reader._configure($e.BufferReader)}qf()});var Vr=m((ZI,Gf)=>{"use strict";Gf.exports=Uf()});var aa=m((XI,Vf)=>{"use strict";var yr=Vr(),xn=yr.Reader,oa=yr.Writer,G=yr.util,we=yr.roots["libp2p-pubsub-rpc"]||(yr.roots["libp2p-pubsub-rpc"]={});we.RPC=function(){function t(e){if(this.subscriptions=[],this.msgs=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.subscriptions=G.emptyArray,t.prototype.msgs=G.emptyArray,t.encode=function(r,n){if(n||(n=oa.create()),r.subscriptions!=null&&r.subscriptions.length)for(var i=0;i<r.subscriptions.length;++i)we.RPC.SubOpts.encode(r.subscriptions[i],n.uint32(10).fork()).ldelim();if(r.msgs!=null&&r.msgs.length)for(var i=0;i<r.msgs.length;++i)we.RPC.Message.encode(r.msgs[i],n.uint32(18).fork()).ldelim();return n},t.decode=function(r,n){r instanceof xn||(r=xn.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new we.RPC;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.subscriptions&&s.subscriptions.length||(s.subscriptions=[]),s.subscriptions.push(we.RPC.SubOpts.decode(r,r.uint32()));break;case 2:s.msgs&&s.msgs.length||(s.msgs=[]),s.msgs.push(we.RPC.Message.decode(r,r.uint32()));break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof we.RPC)return r;var n=new we.RPC;if(r.subscriptions){if(!Array.isArray(r.subscriptions))throw TypeError(".RPC.subscriptions: array expected");n.subscriptions=[];for(var i=0;i<r.subscriptions.length;++i){if(typeof r.subscriptions[i]!="object")throw TypeError(".RPC.subscriptions: object expected");n.subscriptions[i]=we.RPC.SubOpts.fromObject(r.subscriptions[i])}}if(r.msgs){if(!Array.isArray(r.msgs))throw TypeError(".RPC.msgs: array expected");n.msgs=[];for(var i=0;i<r.msgs.length;++i){if(typeof r.msgs[i]!="object")throw TypeError(".RPC.msgs: object expected");n.msgs[i]=we.RPC.Message.fromObject(r.msgs[i])}}return n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.subscriptions=[],i.msgs=[]),r.subscriptions&&r.subscriptions.length){i.subscriptions=[];for(var s=0;s<r.subscriptions.length;++s)i.subscriptions[s]=we.RPC.SubOpts.toObject(r.subscriptions[s],n)}if(r.msgs&&r.msgs.length){i.msgs=[];for(var s=0;s<r.msgs.length;++s)i.msgs[s]=we.RPC.Message.toObject(r.msgs[s],n)}return i},t.prototype.toJSON=function(){return this.constructor.toObject(this,yr.util.toJSONOptions)},t.SubOpts=function(){function e(n){if(n)for(var i=Object.keys(n),s=0;s<i.length;++s)n[i[s]]!=null&&(this[i[s]]=n[i[s]])}e.prototype.subscribe=null,e.prototype.topicID=null;var r;return Object.defineProperty(e.prototype,"_subscribe",{get:G.oneOfGetter(r=["subscribe"]),set:G.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_topicID",{get:G.oneOfGetter(r=["topicID"]),set:G.oneOfSetter(r)}),e.encode=function(i,s){return s||(s=oa.create()),i.subscribe!=null&&Object.hasOwnProperty.call(i,"subscribe")&&s.uint32(8).bool(i.subscribe),i.topicID!=null&&Object.hasOwnProperty.call(i,"topicID")&&s.uint32(18).string(i.topicID),s},e.decode=function(i,s){i instanceof xn||(i=xn.create(i));for(var o=s===void 0?i.len:i.pos+s,c=new we.RPC.SubOpts;i.pos<o;){var f=i.uint32();switch(f>>>3){case 1:c.subscribe=i.bool();break;case 2:c.topicID=i.string();break;default:i.skipType(f&7);break}}return c},e.fromObject=function(i){if(i instanceof we.RPC.SubOpts)return i;var s=new we.RPC.SubOpts;return i.subscribe!=null&&(s.subscribe=Boolean(i.subscribe)),i.topicID!=null&&(s.topicID=String(i.topicID)),s},e.toObject=function(i,s){s||(s={});var o={};return i.subscribe!=null&&i.hasOwnProperty("subscribe")&&(o.subscribe=i.subscribe,s.oneofs&&(o._subscribe="subscribe")),i.topicID!=null&&i.hasOwnProperty("topicID")&&(o.topicID=i.topicID,s.oneofs&&(o._topicID="topicID")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,yr.util.toJSONOptions)},e}(),t.Message=function(){function e(n){if(this.topicIDs=[],n)for(var i=Object.keys(n),s=0;s<i.length;++s)n[i[s]]!=null&&(this[i[s]]=n[i[s]])}e.prototype.from=null,e.prototype.data=null,e.prototype.seqno=null,e.prototype.topicIDs=G.emptyArray,e.prototype.signature=null,e.prototype.key=null;var r;return Object.defineProperty(e.prototype,"_from",{get:G.oneOfGetter(r=["from"]),set:G.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_data",{get:G.oneOfGetter(r=["data"]),set:G.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_seqno",{get:G.oneOfGetter(r=["seqno"]),set:G.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_signature",{get:G.oneOfGetter(r=["signature"]),set:G.oneOfSetter(r)}),Object.defineProperty(e.prototype,"_key",{get:G.oneOfGetter(r=["key"]),set:G.oneOfSetter(r)}),e.encode=function(i,s){if(s||(s=oa.create()),i.from!=null&&Object.hasOwnProperty.call(i,"from")&&s.uint32(10).bytes(i.from),i.data!=null&&Object.hasOwnProperty.call(i,"data")&&s.uint32(18).bytes(i.data),i.seqno!=null&&Object.hasOwnProperty.call(i,"seqno")&&s.uint32(26).bytes(i.seqno),i.topicIDs!=null&&i.topicIDs.length)for(var o=0;o<i.topicIDs.length;++o)s.uint32(34).string(i.topicIDs[o]);return i.signature!=null&&Object.hasOwnProperty.call(i,"signature")&&s.uint32(42).bytes(i.signature),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&s.uint32(50).bytes(i.key),s},e.decode=function(i,s){i instanceof xn||(i=xn.create(i));for(var o=s===void 0?i.len:i.pos+s,c=new we.RPC.Message;i.pos<o;){var f=i.uint32();switch(f>>>3){case 1:c.from=i.bytes();break;case 2:c.data=i.bytes();break;case 3:c.seqno=i.bytes();break;case 4:c.topicIDs&&c.topicIDs.length||(c.topicIDs=[]),c.topicIDs.push(i.string());break;case 5:c.signature=i.bytes();break;case 6:c.key=i.bytes();break;default:i.skipType(f&7);break}}return c},e.fromObject=function(i){if(i instanceof we.RPC.Message)return i;var s=new we.RPC.Message;if(i.from!=null&&(typeof i.from=="string"?G.base64.decode(i.from,s.from=G.newBuffer(G.base64.length(i.from)),0):i.from.length&&(s.from=i.from)),i.data!=null&&(typeof i.data=="string"?G.base64.decode(i.data,s.data=G.newBuffer(G.base64.length(i.data)),0):i.data.length&&(s.data=i.data)),i.seqno!=null&&(typeof i.seqno=="string"?G.base64.decode(i.seqno,s.seqno=G.newBuffer(G.base64.length(i.seqno)),0):i.seqno.length&&(s.seqno=i.seqno)),i.topicIDs){if(!Array.isArray(i.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");s.topicIDs=[];for(var o=0;o<i.topicIDs.length;++o)s.topicIDs[o]=String(i.topicIDs[o])}return i.signature!=null&&(typeof i.signature=="string"?G.base64.decode(i.signature,s.signature=G.newBuffer(G.base64.length(i.signature)),0):i.signature.length&&(s.signature=i.signature)),i.key!=null&&(typeof i.key=="string"?G.base64.decode(i.key,s.key=G.newBuffer(G.base64.length(i.key)),0):i.key.length&&(s.key=i.key)),s},e.toObject=function(i,s){s||(s={});var o={};if((s.arrays||s.defaults)&&(o.topicIDs=[]),i.from!=null&&i.hasOwnProperty("from")&&(o.from=s.bytes===String?G.base64.encode(i.from,0,i.from.length):s.bytes===Array?Array.prototype.slice.call(i.from):i.from,s.oneofs&&(o._from="from")),i.data!=null&&i.hasOwnProperty("data")&&(o.data=s.bytes===String?G.base64.encode(i.data,0,i.data.length):s.bytes===Array?Array.prototype.slice.call(i.data):i.data,s.oneofs&&(o._data="data")),i.seqno!=null&&i.hasOwnProperty("seqno")&&(o.seqno=s.bytes===String?G.base64.encode(i.seqno,0,i.seqno.length):s.bytes===Array?Array.prototype.slice.call(i.seqno):i.seqno,s.oneofs&&(o._seqno="seqno")),i.topicIDs&&i.topicIDs.length){o.topicIDs=[];for(var c=0;c<i.topicIDs.length;++c)o.topicIDs[c]=i.topicIDs[c]}return i.signature!=null&&i.hasOwnProperty("signature")&&(o.signature=s.bytes===String?G.base64.encode(i.signature,0,i.signature.length):s.bytes===Array?Array.prototype.slice.call(i.signature):i.signature,s.oneofs&&(o._signature="signature")),i.key!=null&&i.hasOwnProperty("key")&&(o.key=s.bytes===String?G.base64.encode(i.key,0,i.key.length):s.bytes===Array?Array.prototype.slice.call(i.key):i.key,s.oneofs&&(o._key="key")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,yr.util.toJSONOptions)},e}(),t}();Vf.exports=we});var zf=m(hs=>{"use strict";hs.byteLength=rb;hs.toByteArray=ib;hs.fromByteArray=ab;var Tt=[],rt=[],tb=typeof Uint8Array!="undefined"?Uint8Array:Array,ca="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(jr=0,jf=ca.length;jr<jf;++jr)Tt[jr]=ca[jr],rt[ca.charCodeAt(jr)]=jr;var jr,jf;rt["-".charCodeAt(0)]=62;rt["_".charCodeAt(0)]=63;function Hf(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function rb(t){var e=Hf(t),r=e[0],n=e[1];return(r+n)*3/4-n}function nb(t,e,r){return(e+r)*3/4-r}function ib(t){var e,r=Hf(t),n=r[0],i=r[1],s=new tb(nb(t,n,i)),o=0,c=i>0?n-4:n,f;for(f=0;f<c;f+=4)e=rt[t.charCodeAt(f)]<<18|rt[t.charCodeAt(f+1)]<<12|rt[t.charCodeAt(f+2)]<<6|rt[t.charCodeAt(f+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=rt[t.charCodeAt(f)]<<2|rt[t.charCodeAt(f+1)]>>4,s[o++]=e&255),i===1&&(e=rt[t.charCodeAt(f)]<<10|rt[t.charCodeAt(f+1)]<<4|rt[t.charCodeAt(f+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function sb(t){return Tt[t>>18&63]+Tt[t>>12&63]+Tt[t>>6&63]+Tt[t&63]}function ob(t,e,r){for(var n,i=[],s=e;s<r;s+=3)n=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),i.push(sb(n));return i.join("")}function ab(t){for(var e,r=t.length,n=r%3,i=[],s=16383,o=0,c=r-n;o<c;o+=s)i.push(ob(t,o,o+s>c?c:o+s));return n===1?(e=t[r-1],i.push(Tt[e>>2]+Tt[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],i.push(Tt[e>>10]+Tt[e>>4&63]+Tt[e<<2&63]+"=")),i.join("")}});var Wf=m(ua=>{ua.read=function(t,e,r,n,i){var s,o,c=i*8-n-1,f=(1<<c)-1,u=f>>1,a=-7,h=r?i-1:0,l=r?-1:1,d=t[e+h];for(h+=l,s=d&(1<<-a)-1,d>>=-a,a+=c;a>0;s=s*256+t[e+h],h+=l,a-=8);for(o=s&(1<<-a)-1,s>>=-a,a+=n;a>0;o=o*256+t[e+h],h+=l,a-=8);if(s===0)s=1-u;else{if(s===f)return o?NaN:(d?-1:1)*(1/0);o=o+Math.pow(2,n),s=s-u}return(d?-1:1)*o*Math.pow(2,s-n)};ua.write=function(t,e,r,n,i,s){var o,c,f,u=s*8-i-1,a=(1<<u)-1,h=a>>1,l=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:s-1,p=n?1:-1,y=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(c=isNaN(e)?1:0,o=a):(o=Math.floor(Math.log(e)/Math.LN2),e*(f=Math.pow(2,-o))<1&&(o--,f*=2),o+h>=1?e+=l/f:e+=l*Math.pow(2,1-h),e*f>=2&&(o++,f/=2),o+h>=a?(c=0,o=a):o+h>=1?(c=(e*f-1)*Math.pow(2,i),o=o+h):(c=e*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;t[r+d]=c&255,d+=p,c/=256,i-=8);for(o=o<<i|c,u+=i;u>0;t[r+d]=o&255,d+=p,o/=256,u-=8);t[r+d-p]|=y*128}});var zr=m(Sn=>{"use strict";var fa=zf(),wn=Wf(),$f=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Sn.Buffer=E;Sn.SlowBuffer=pb;Sn.INSPECT_MAX_BYTES=50;var ls=2147483647;Sn.kMaxLength=ls;E.TYPED_ARRAY_SUPPORT=cb();!E.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function cb(){try{let t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),t.foo()===42}catch(t){return!1}}Object.defineProperty(E.prototype,"parent",{enumerable:!0,get:function(){if(!!E.isBuffer(this))return this.buffer}});Object.defineProperty(E.prototype,"offset",{enumerable:!0,get:function(){if(!!E.isBuffer(this))return this.byteOffset}});function Qt(t){if(t>ls)throw new RangeError('The value "'+t+'" is invalid for option "size"');let e=new Uint8Array(t);return Object.setPrototypeOf(e,E.prototype),e}function E(t,e,r){if(typeof t=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return ha(t)}return Yf(t,e,r)}E.poolSize=8192;function Yf(t,e,r){if(typeof t=="string")return fb(t,e);if(ArrayBuffer.isView(t))return hb(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Rt(t,ArrayBuffer)||t&&Rt(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(Rt(t,SharedArrayBuffer)||t&&Rt(t.buffer,SharedArrayBuffer)))return pa(t,e,r);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let n=t.valueOf&&t.valueOf();if(n!=null&&n!==t)return E.from(n,e,r);let i=lb(t);if(i)return i;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return E.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}E.from=function(t,e,r){return Yf(t,e,r)};Object.setPrototypeOf(E.prototype,Uint8Array.prototype);Object.setPrototypeOf(E,Uint8Array);function Qf(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function ub(t,e,r){return Qf(t),t<=0?Qt(t):e!==void 0?typeof r=="string"?Qt(t).fill(e,r):Qt(t).fill(e):Qt(t)}E.alloc=function(t,e,r){return ub(t,e,r)};function ha(t){return Qf(t),Qt(t<0?0:da(t)|0)}E.allocUnsafe=function(t){return ha(t)};E.allocUnsafeSlow=function(t){return ha(t)};function fb(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!E.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let r=Jf(t,e)|0,n=Qt(r),i=n.write(t,e);return i!==r&&(n=n.slice(0,i)),n}function la(t){let e=t.length<0?0:da(t.length)|0,r=Qt(e);for(let n=0;n<e;n+=1)r[n]=t[n]&255;return r}function hb(t){if(Rt(t,Uint8Array)){let e=new Uint8Array(t);return pa(e.buffer,e.byteOffset,e.byteLength)}return la(t)}function pa(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return e===void 0&&r===void 0?n=new Uint8Array(t):r===void 0?n=new Uint8Array(t,e):n=new Uint8Array(t,e,r),Object.setPrototypeOf(n,E.prototype),n}function lb(t){if(E.isBuffer(t)){let e=da(t.length)|0,r=Qt(e);return r.length===0||t.copy(r,0,0,e),r}if(t.length!==void 0)return typeof t.length!="number"||ba(t.length)?Qt(0):la(t);if(t.type==="Buffer"&&Array.isArray(t.data))return la(t.data)}function da(t){if(t>=ls)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ls.toString(16)+" bytes");return t|0}function pb(t){return+t!=t&&(t=0),E.alloc(+t)}E.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==E.prototype};E.compare=function(e,r){if(Rt(e,Uint8Array)&&(e=E.from(e,e.offset,e.byteLength)),Rt(r,Uint8Array)&&(r=E.from(r,r.offset,r.byteLength)),!E.isBuffer(e)||!E.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;let n=e.length,i=r.length;for(let s=0,o=Math.min(n,i);s<o;++s)if(e[s]!==r[s]){n=e[s],i=r[s];break}return n<i?-1:i<n?1:0};E.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};E.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return E.alloc(0);let n;if(r===void 0)for(r=0,n=0;n<e.length;++n)r+=e[n].length;let i=E.allocUnsafe(r),s=0;for(n=0;n<e.length;++n){let o=e[n];if(Rt(o,Uint8Array))s+o.length>i.length?(E.isBuffer(o)||(o=E.from(o)),o.copy(i,s)):Uint8Array.prototype.set.call(i,o,s);else if(E.isBuffer(o))o.copy(i,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return i};function Jf(t,e){if(E.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Rt(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let r=t.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&r===0)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return ga(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return u0(t).length;default:if(i)return n?-1:ga(t).length;e=(""+e).toLowerCase(),i=!0}}E.byteLength=Jf;function db(t,e,r){let n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return Sb(this,e,r);case"utf8":case"utf-8":return e0(this,e,r);case"ascii":return Eb(this,e,r);case"latin1":case"binary":return _b(this,e,r);case"base64":return xb(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ib(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}E.prototype._isBuffer=!0;function Hr(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}E.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<e;r+=2)Hr(this,r,r+1);return this};E.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<e;r+=4)Hr(this,r,r+3),Hr(this,r+1,r+2);return this};E.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<e;r+=8)Hr(this,r,r+7),Hr(this,r+1,r+6),Hr(this,r+2,r+5),Hr(this,r+3,r+4);return this};E.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?e0(this,0,e):db.apply(this,arguments)};E.prototype.toLocaleString=E.prototype.toString;E.prototype.equals=function(e){if(!E.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:E.compare(this,e)===0};E.prototype.inspect=function(){let e="",r=Sn.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"};$f&&(E.prototype[$f]=E.prototype.inspect);E.prototype.compare=function(e,r,n,i,s){if(Rt(e,Uint8Array)&&(e=E.from(e,e.offset,e.byteLength)),!E.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===void 0&&(r=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),s===void 0&&(s=this.length),r<0||n>e.length||i<0||s>this.length)throw new RangeError("out of range index");if(i>=s&&r>=n)return 0;if(i>=s)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,s>>>=0,this===e)return 0;let o=s-i,c=n-r,f=Math.min(o,c),u=this.slice(i,s),a=e.slice(r,n);for(let h=0;h<f;++h)if(u[h]!==a[h]){o=u[h],c=a[h];break}return o<c?-1:c<o?1:0};function Zf(t,e,r,n,i){if(t.length===0)return-1;if(typeof r=="string"?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,ba(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0)if(i)r=0;else return-1;if(typeof e=="string"&&(e=E.from(e,n)),E.isBuffer(e))return e.length===0?-1:Xf(t,e,r,n,i);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):Xf(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function Xf(t,e,r,n,i){let s=1,o=t.length,c=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(t.length<2||e.length<2)return-1;s=2,o/=2,c/=2,r/=2}function f(a,h){return s===1?a[h]:a.readUInt16BE(h*s)}let u;if(i){let a=-1;for(u=r;u<o;u++)if(f(t,u)===f(e,a===-1?0:u-a)){if(a===-1&&(a=u),u-a+1===c)return a*s}else a!==-1&&(u-=u-a),a=-1}else for(r+c>o&&(r=o-c),u=r;u>=0;u--){let a=!0;for(let h=0;h<c;h++)if(f(t,u+h)!==f(e,h)){a=!1;break}if(a)return u}return-1}E.prototype.includes=function(e,r,n){return this.indexOf(e,r,n)!==-1};E.prototype.indexOf=function(e,r,n){return Zf(this,e,r,n,!0)};E.prototype.lastIndexOf=function(e,r,n){return Zf(this,e,r,n,!1)};function yb(t,e,r,n){r=Number(r)||0;let i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;let s=e.length;n>s/2&&(n=s/2);let o;for(o=0;o<n;++o){let c=parseInt(e.substr(o*2,2),16);if(ba(c))return o;t[r+o]=c}return o}function gb(t,e,r,n){return ps(ga(e,t.length-r),t,r,n)}function bb(t,e,r,n){return ps(Tb(e),t,r,n)}function vb(t,e,r,n){return ps(u0(e),t,r,n)}function mb(t,e,r,n){return ps(Rb(e,t.length-r),t,r,n)}E.prototype.write=function(e,r,n,i){if(r===void 0)i="utf8",n=this.length,r=0;else if(n===void 0&&typeof r=="string")i=r,n=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-r;if((n===void 0||n>s)&&(n=s),e.length>0&&(n<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let o=!1;for(;;)switch(i){case"hex":return yb(this,e,r,n);case"utf8":case"utf-8":return gb(this,e,r,n);case"ascii":case"latin1":case"binary":return bb(this,e,r,n);case"base64":return vb(this,e,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return mb(this,e,r,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}};E.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function xb(t,e,r){return e===0&&r===t.length?fa.fromByteArray(t):fa.fromByteArray(t.slice(e,r))}function e0(t,e,r){r=Math.min(t.length,r);let n=[],i=e;for(;i<r;){let s=t[i],o=null,c=s>239?4:s>223?3:s>191?2:1;if(i+c<=r){let f,u,a,h;switch(c){case 1:s<128&&(o=s);break;case 2:f=t[i+1],(f&192)==128&&(h=(s&31)<<6|f&63,h>127&&(o=h));break;case 3:f=t[i+1],u=t[i+2],(f&192)==128&&(u&192)==128&&(h=(s&15)<<12|(f&63)<<6|u&63,h>2047&&(h<55296||h>57343)&&(o=h));break;case 4:f=t[i+1],u=t[i+2],a=t[i+3],(f&192)==128&&(u&192)==128&&(a&192)==128&&(h=(s&15)<<18|(f&63)<<12|(u&63)<<6|a&63,h>65535&&h<1114112&&(o=h))}}o===null?(o=65533,c=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|o&1023),n.push(o),i+=c}return wb(n)}var t0=4096;function wb(t){let e=t.length;if(e<=t0)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=t0));return r}function Eb(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]&127);return n}function _b(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function Sb(t,e,r){let n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let i="";for(let s=e;s<r;++s)i+=Pb[t[s]];return i}function Ib(t,e,r){let n=t.slice(e,r),i="";for(let s=0;s<n.length-1;s+=2)i+=String.fromCharCode(n[s]+n[s+1]*256);return i}E.prototype.slice=function(e,r){let n=this.length;e=~~e,r=r===void 0?n:~~r,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),r<e&&(r=e);let i=this.subarray(e,r);return Object.setPrototypeOf(i,E.prototype),i};function Ie(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}E.prototype.readUintLE=E.prototype.readUIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||Ie(e,r,this.length);let i=this[e],s=1,o=0;for(;++o<r&&(s*=256);)i+=this[e+o]*s;return i};E.prototype.readUintBE=E.prototype.readUIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||Ie(e,r,this.length);let i=this[e+--r],s=1;for(;r>0&&(s*=256);)i+=this[e+--r]*s;return i};E.prototype.readUint8=E.prototype.readUInt8=function(e,r){return e=e>>>0,r||Ie(e,1,this.length),this[e]};E.prototype.readUint16LE=E.prototype.readUInt16LE=function(e,r){return e=e>>>0,r||Ie(e,2,this.length),this[e]|this[e+1]<<8};E.prototype.readUint16BE=E.prototype.readUInt16BE=function(e,r){return e=e>>>0,r||Ie(e,2,this.length),this[e]<<8|this[e+1]};E.prototype.readUint32LE=E.prototype.readUInt32LE=function(e,r){return e=e>>>0,r||Ie(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};E.prototype.readUint32BE=E.prototype.readUInt32BE=function(e,r){return e=e>>>0,r||Ie(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};E.prototype.readBigUInt64LE=gr(function(e){e=e>>>0,_n(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&ni(e,this.length-8);let i=r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+n*2**24;return BigInt(i)+(BigInt(s)<<BigInt(32))});E.prototype.readBigUInt64BE=gr(function(e){e=e>>>0,_n(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&ni(e,this.length-8);let i=r*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(s)});E.prototype.readIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||Ie(e,r,this.length);let i=this[e],s=1,o=0;for(;++o<r&&(s*=256);)i+=this[e+o]*s;return s*=128,i>=s&&(i-=Math.pow(2,8*r)),i};E.prototype.readIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||Ie(e,r,this.length);let i=r,s=1,o=this[e+--i];for(;i>0&&(s*=256);)o+=this[e+--i]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*r)),o};E.prototype.readInt8=function(e,r){return e=e>>>0,r||Ie(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};E.prototype.readInt16LE=function(e,r){e=e>>>0,r||Ie(e,2,this.length);let n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};E.prototype.readInt16BE=function(e,r){e=e>>>0,r||Ie(e,2,this.length);let n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};E.prototype.readInt32LE=function(e,r){return e=e>>>0,r||Ie(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};E.prototype.readInt32BE=function(e,r){return e=e>>>0,r||Ie(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};E.prototype.readBigInt64LE=gr(function(e){e=e>>>0,_n(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&ni(e,this.length-8);let i=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});E.prototype.readBigInt64BE=gr(function(e){e=e>>>0,_n(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&ni(e,this.length-8);let i=(r<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n)});E.prototype.readFloatLE=function(e,r){return e=e>>>0,r||Ie(e,4,this.length),wn.read(this,e,!0,23,4)};E.prototype.readFloatBE=function(e,r){return e=e>>>0,r||Ie(e,4,this.length),wn.read(this,e,!1,23,4)};E.prototype.readDoubleLE=function(e,r){return e=e>>>0,r||Ie(e,8,this.length),wn.read(this,e,!0,52,8)};E.prototype.readDoubleBE=function(e,r){return e=e>>>0,r||Ie(e,8,this.length),wn.read(this,e,!1,52,8)};function Ye(t,e,r,n,i,s){if(!E.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}E.prototype.writeUintLE=E.prototype.writeUIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){let c=Math.pow(2,8*n)-1;Ye(this,e,r,n,c,0)}let s=1,o=0;for(this[r]=e&255;++o<n&&(s*=256);)this[r+o]=e/s&255;return r+n};E.prototype.writeUintBE=E.prototype.writeUIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){let c=Math.pow(2,8*n)-1;Ye(this,e,r,n,c,0)}let s=n-1,o=1;for(this[r+s]=e&255;--s>=0&&(o*=256);)this[r+s]=e/o&255;return r+n};E.prototype.writeUint8=E.prototype.writeUInt8=function(e,r,n){return e=+e,r=r>>>0,n||Ye(this,e,r,1,255,0),this[r]=e&255,r+1};E.prototype.writeUint16LE=E.prototype.writeUInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||Ye(this,e,r,2,65535,0),this[r]=e&255,this[r+1]=e>>>8,r+2};E.prototype.writeUint16BE=E.prototype.writeUInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||Ye(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=e&255,r+2};E.prototype.writeUint32LE=E.prototype.writeUInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||Ye(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255,r+4};E.prototype.writeUint32BE=E.prototype.writeUInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||Ye(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};function r0(t,e,r,n,i){c0(e,n,i,t,r,7);let s=Number(e&BigInt(4294967295));t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,r}function n0(t,e,r,n,i){c0(e,n,i,t,r,7);let s=Number(e&BigInt(4294967295));t[r+7]=s,s=s>>8,t[r+6]=s,s=s>>8,t[r+5]=s,s=s>>8,t[r+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=o,o=o>>8,t[r+2]=o,o=o>>8,t[r+1]=o,o=o>>8,t[r]=o,r+8}E.prototype.writeBigUInt64LE=gr(function(e,r=0){return r0(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});E.prototype.writeBigUInt64BE=gr(function(e,r=0){return n0(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});E.prototype.writeIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){let f=Math.pow(2,8*n-1);Ye(this,e,r,n,f-1,-f)}let s=0,o=1,c=0;for(this[r]=e&255;++s<n&&(o*=256);)e<0&&c===0&&this[r+s-1]!==0&&(c=1),this[r+s]=(e/o>>0)-c&255;return r+n};E.prototype.writeIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){let f=Math.pow(2,8*n-1);Ye(this,e,r,n,f-1,-f)}let s=n-1,o=1,c=0;for(this[r+s]=e&255;--s>=0&&(o*=256);)e<0&&c===0&&this[r+s+1]!==0&&(c=1),this[r+s]=(e/o>>0)-c&255;return r+n};E.prototype.writeInt8=function(e,r,n){return e=+e,r=r>>>0,n||Ye(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=e&255,r+1};E.prototype.writeInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||Ye(this,e,r,2,32767,-32768),this[r]=e&255,this[r+1]=e>>>8,r+2};E.prototype.writeInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||Ye(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=e&255,r+2};E.prototype.writeInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||Ye(this,e,r,4,2147483647,-2147483648),this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4};E.prototype.writeInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||Ye(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};E.prototype.writeBigInt64LE=gr(function(e,r=0){return r0(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});E.prototype.writeBigInt64BE=gr(function(e,r=0){return n0(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function i0(t,e,r,n,i,s){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function s0(t,e,r,n,i){return e=+e,r=r>>>0,i||i0(t,e,r,4,34028234663852886e22,-34028234663852886e22),wn.write(t,e,r,n,23,4),r+4}E.prototype.writeFloatLE=function(e,r,n){return s0(this,e,r,!0,n)};E.prototype.writeFloatBE=function(e,r,n){return s0(this,e,r,!1,n)};function o0(t,e,r,n,i){return e=+e,r=r>>>0,i||i0(t,e,r,8,17976931348623157e292,-17976931348623157e292),wn.write(t,e,r,n,52,8),r+8}E.prototype.writeDoubleLE=function(e,r,n){return o0(this,e,r,!0,n)};E.prototype.writeDoubleBE=function(e,r,n){return o0(this,e,r,!1,n)};E.prototype.copy=function(e,r,n,i){if(!E.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),r>=e.length&&(r=e.length),r||(r=0),i>0&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-r<i-n&&(i=e.length-r+n);let s=i-n;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),r),s};E.prototype.fill=function(e,r,n,i){if(typeof e=="string"){if(typeof r=="string"?(i=r,r=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!E.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(e.length===1){let o=e.charCodeAt(0);(i==="utf8"&&o<128||i==="latin1")&&(e=o)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r=r>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);let s;if(typeof e=="number")for(s=r;s<n;++s)this[s]=e;else{let o=E.isBuffer(e)?e:E.from(e,i),c=o.length;if(c===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<n-r;++s)this[s+r]=o[s%c]}return this};var En={};function ya(t,e,r){En[t]=class extends r{constructor(){super();Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}ya("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);ya("ERR_INVALID_ARG_TYPE",function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`},TypeError);ya("ERR_OUT_OF_RANGE",function(t,e,r){let n=`The value of "${t}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=a0(String(r)):typeof r=="bigint"&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=a0(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n},RangeError);function a0(t){let e="",r=t.length,n=t[0]==="-"?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function Ab(t,e,r){_n(e,"offset"),(t[e]===void 0||t[e+r]===void 0)&&ni(e,t.length-(r+1))}function c0(t,e,r,n,i,s){if(t>r||t<e){let o=typeof e=="bigint"?"n":"",c;throw s>3?e===0||e===BigInt(0)?c=`>= 0${o} and < 2${o} ** ${(s+1)*8}${o}`:c=`>= -(2${o} ** ${(s+1)*8-1}${o}) and < 2 ** ${(s+1)*8-1}${o}`:c=`>= ${e}${o} and <= ${r}${o}`,new En.ERR_OUT_OF_RANGE("value",c,t)}Ab(n,i,s)}function _n(t,e){if(typeof t!="number")throw new En.ERR_INVALID_ARG_TYPE(e,"number",t)}function ni(t,e,r){throw Math.floor(t)!==t?(_n(t,r),new En.ERR_OUT_OF_RANGE(r||"offset","an integer",t)):e<0?new En.ERR_BUFFER_OUT_OF_BOUNDS:new En.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}var Cb=/[^+/0-9A-Za-z-_]/g;function Bb(t){if(t=t.split("=")[0],t=t.trim().replace(Cb,""),t.length<2)return"";for(;t.length%4!=0;)t=t+"=";return t}function ga(t,e){e=e||1/0;let r,n=t.length,i=null,s=[];for(let o=0;o<n;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===n){(e-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return s}function Tb(t){let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function Rb(t,e){let r,n,i,s=[];for(let o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),n=r>>8,i=r%256,s.push(i),s.push(n);return s}function u0(t){return fa.toByteArray(Bb(t))}function ps(t,e,r,n){let i;for(i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function Rt(t,e){return t instanceof e||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===e.name}function ba(t){return t!==t}var Pb=function(){let t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){let n=r*16;for(let i=0;i<16;++i)e[n+i]=t[r]+t[i]}return e}();function gr(t){return typeof BigInt=="undefined"?Db:t}function Db(){throw new Error("BigInt not supported")}});var va=m((iA,h0)=>{"use strict";var{Buffer:bt}=zr(),f0=Symbol.for("BufferList");function se(t){if(!(this instanceof se))return new se(t);se._init.call(this,t)}se._init=function(e){Object.defineProperty(this,f0,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};se.prototype._new=function(e){return new se(e)};se.prototype._offset=function(e){if(e===0)return[0,0];let r=0;for(let n=0;n<this._bufs.length;n++){let i=r+this._bufs[n].length;if(e<i||n===this._bufs.length-1)return[n,e-r];r=i}};se.prototype._reverseOffset=function(t){let e=t[0],r=t[1];for(let n=0;n<e;n++)r+=this._bufs[n].length;return r};se.prototype.get=function(e){if(e>this.length||e<0)return;let r=this._offset(e);return this._bufs[r[0]][r[1]]};se.prototype.slice=function(e,r){return typeof e=="number"&&e<0&&(e+=this.length),typeof r=="number"&&r<0&&(r+=this.length),this.copy(null,0,e,r)};se.prototype.copy=function(e,r,n,i){if((typeof n!="number"||n<0)&&(n=0),(typeof i!="number"||i>this.length)&&(i=this.length),n>=this.length||i<=0)return e||bt.alloc(0);let s=!!e,o=this._offset(n),c=i-n,f=c,u=s&&r||0,a=o[1];if(n===0&&i===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:bt.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,u),u+=this._bufs[h].length;return e}if(f<=this._bufs[o[0]].length-a)return s?this._bufs[o[0]].copy(e,r,a,a+f):this._bufs[o[0]].slice(a,a+f);s||(e=bt.allocUnsafe(c));for(let h=o[0];h<this._bufs.length;h++){let l=this._bufs[h].length-a;if(f>l)this._bufs[h].copy(e,u,a),u+=l;else{this._bufs[h].copy(e,u,a,a+f),u+=l;break}f-=l,a&&(a=0)}return e.length>u?e.slice(0,u):e};se.prototype.shallowSlice=function(e,r){if(e=e||0,r=typeof r!="number"?this.length:r,e<0&&(e+=this.length),r<0&&(r+=this.length),e===r)return this._new();let n=this._offset(e),i=this._offset(r),s=this._bufs.slice(n[0],i[0]+1);return i[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,i[1]),n[1]!==0&&(s[0]=s[0].slice(n[1])),this._new(s)};se.prototype.toString=function(e,r,n){return this.slice(r,n).toString(e)};se.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};se.prototype.duplicate=function(){let e=this._new();for(let r=0;r<this._bufs.length;r++)e.append(this._bufs[r]);return e};se.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(bt.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let r=0;r<e.length;r++)this.append(e[r]);else if(this._isBufferList(e))for(let r=0;r<e._bufs.length;r++)this.append(e._bufs[r]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(bt.from(e));return this};se.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};se.prototype.indexOf=function(t,e,r){if(r===void 0&&typeof e=="string"&&(r=e,e=void 0),typeof t=="function"||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof t=="number"?t=bt.from([t]):typeof t=="string"?t=bt.from(t,r):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=bt.from(t.buffer,t.byteOffset,t.byteLength):bt.isBuffer(t)||(t=bt.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let n=this._offset(e),i=n[0],s=n[1];for(;i<this._bufs.length;i++){let o=this._bufs[i];for(;s<o.length;)if(o.length-s>=t.length){let f=o.indexOf(t,s);if(f!==-1)return this._reverseOffset([i,f]);s=o.length-t.length+1}else{let f=this._reverseOffset([i,s]);if(this._match(f,t))return f;s++}s=0}return-1};se.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let r=0;r<e.length;r++)if(this.get(t+r)!==e[r])return!1;return!0};(function(){let t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in t)(function(r){t[r]===null?se.prototype[r]=function(n,i){return this.slice(n,n+i)[r](0,i)}:se.prototype[r]=function(n=0){return this.slice(n,n+t[r])[r](0)}})(e)})();se.prototype._isBufferList=function(e){return e instanceof se||se.isBufferList(e)};se.isBufferList=function(e){return e!=null&&e[f0]};h0.exports=se});var d0=m((sA,p0)=>{p0.exports=ma;var l0=128,Ob=127,kb=~Ob,Nb=Math.pow(2,31);function ma(t,e,r){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw ma.bytes=0,new RangeError("Could not encode varint");e=e||[],r=r||0;for(var n=r;t>=Nb;)e[r++]=t&255|l0,t/=128;for(;t&kb;)e[r++]=t&255|l0,t>>>=7;return e[r]=t|0,ma.bytes=r-n+1,e}});var b0=m((oA,g0)=>{g0.exports=xa;var Lb=128,y0=127;function xa(t,e){var r=0,e=e||0,n=0,i=e,s,o=t.length;do{if(i>=o||n>49)throw xa.bytes=0,new RangeError("Could not decode varint");s=t[i++],r+=n<28?(s&y0)<<n:(s&y0)*Math.pow(2,n),n+=7}while(s>=Lb);return xa.bytes=i-e,r}});var m0=m((aA,v0)=>{var Kb=Math.pow(2,7),Mb=Math.pow(2,14),qb=Math.pow(2,21),Fb=Math.pow(2,28),Ub=Math.pow(2,35),Gb=Math.pow(2,42),Vb=Math.pow(2,49),jb=Math.pow(2,56),Hb=Math.pow(2,63);v0.exports=function(t){return t<Kb?1:t<Mb?2:t<qb?3:t<Fb?4:t<Ub?5:t<Gb?6:t<Vb?7:t<jb?8:t<Hb?9:10}});var ds=m((cA,x0)=>{x0.exports={encode:d0(),decode:b0(),encodingLength:m0()}});var wa=m((uA,_0)=>{"use strict";var w0=ds(),{Buffer:zb}=zr(),E0=(t,e,r)=>{let n=w0.encode(t,e,r);return E0.bytes=w0.encode.bytes,e||zb.from(n)};_0.exports=E0});var T0=m((fA,ys)=>{"use strict";var{Buffer:S0}=zr(),I0=va(),A0=wa(),Ea=8,C0=10*1024;function B0(t){t=t||{};let e=Math.max(t.poolSize||C0,t.minPoolSize||Ea),r=t.lengthEncoder||A0;return async function*(i){let s=S0.alloc(e),o=0;for await(let c of i){r(c.length,s,o);let f=s.slice(o,o+r.bytes);o+=r.bytes,s.length-o<Ea&&(s=S0.alloc(e),o=0),yield new I0().append(f).append(c)}}}B0.single=(t,e)=>{e=e||{};let r=e.lengthEncoder||A0;return new I0([r(t.length),t.slice()])};ys.exports=B0;ys.exports.MIN_POOL_SIZE=Ea;ys.exports.DEFAULT_POOL_SIZE=C0});var _a=m((hA,D0)=>{"use strict";var R0=ds(),{Buffer:Wb}=zr(),$b=t=>new Proxy({},{get:(e,r)=>r[0]==="l"?t[r]:t.get(parseInt(r))}),P0=t=>{let e=R0.decode(Wb.isBuffer(t)?t:$b(t));return P0.bytes=R0.decode.bytes,e};D0.exports=P0});var L0=m((lA,gs)=>{"use strict";var{Buffer:Yb}=zr(),Sa=va(),Qb=_a(),O0=8,k0=1024*1024*4,N0=Yb.alloc(0),br={LENGTH:"readLength",DATA:"readData"},Jb={[br.LENGTH]:(t,e,r,n)=>{e=e.append(t);let i;try{i=n.lengthDecoder(e)}catch(s){if(e.length>n.maxLengthLength)throw Object.assign(s,{message:"message length too long",code:"ERR_MSG_LENGTH_TOO_LONG"});if(s instanceof RangeError)return{mode:br.LENGTH,buffer:e,chunk:void 0,state:void 0,data:void 0};throw s}if(i>n.maxDataLength)throw Object.assign(new Error("message data too long"),{code:"ERR_MSG_DATA_TOO_LONG"});return t=e.shallowSlice(n.lengthDecoder.bytes),e=new Sa,n.onLength&&n.onLength(i),i<=0?(n.onData&&n.onData(N0),{mode:br.LENGTH,chunk:t,buffer:e,data:N0}):{mode:br.DATA,chunk:t,buffer:e,state:{dataLength:i},data:void 0}},[br.DATA]:(t,e,r,n)=>{if(e=e.append(t),!r)throw new Error("state is required");if(e.length<r.dataLength)return{mode:br.DATA,buffer:e,state:r,chunk:void 0,data:void 0};let{dataLength:i}=r,s=e.shallowSlice(0,i),o=e.length>i?e.shallowSlice(i):void 0;return e=new Sa,n.onData&&n.onData(s),{mode:br.LENGTH,chunk:o,buffer:e,state:void 0,data:s}}};function Ia(t){t=t||{};let e={lengthDecoder:t.lengthDecoder||Qb,maxLengthLength:t.maxLengthLength||O0,maxDataLength:t.maxDataLength||k0,onLength:t.onLength,onData:t.onData};return async function*(n){let i=new Sa,s=br.LENGTH,o;for await(let c of n){let f=c;for(;f;){let u=Jb[s](f,i,o,e);s=u.mode,f=u.chunk,i=u.buffer,o=u.state,u.data&&(yield u.data)}}if(i.length)throw Object.assign(new Error("unexpected end of input"),{code:"ERR_UNEXPECTED_EOF"})}}Ia.fromReader=(t,e)=>{let r=1,n={[Symbol.asyncIterator](){return this},next:async()=>{try{return await t.next(r)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{r=1}}};return Ia({...e||{},onLength:s=>{r=s}})(n)};gs.exports=Ia;gs.exports.MAX_LENGTH_LENGTH=O0;gs.exports.MAX_DATA_LENGTH=k0});var q0=m((pA,M0)=>{"use strict";var{Buffer:Zb}=zr(),K0=(t,e,r)=>(e=e||Zb.allocUnsafe(4),e.writeInt32BE(t,r),e);K0.bytes=4;M0.exports=K0});var G0=m((dA,U0)=>{"use strict";var F0=t=>{if(t.length<4)throw RangeError("Could not decode int32BE");return t.readInt32BE(0)};F0.bytes=4;U0.exports=F0});var V0=m(Wr=>{"use strict";Wr.encode=T0();Wr.decode=L0();Wr.varintEncode=wa();Wr.varintDecode=_a();Wr.int32BEEncode=q0();Wr.int32BEDecode=G0()});var H0=m((bA,j0)=>{j0.exports=class{constructor(e){if(!(e>0)||(e-1&e)!=0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}}});var $0=m((mA,W0)=>{var z0=H0();W0.exports=class{constructor(e){this.hwm=e||16,this.head=new z0(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let r=this.head;this.head=r.next=new z0(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return e}isEmpty(){return this.head.isEmpty()}}});var Q0=m((xA,Y0)=>{var Aa=$0();Y0.exports=t=>{t=t||{};let e;typeof t=="function"?(e=t,t={}):e=t.onEnd;let r=new Aa,n,i,s,o=()=>{if(!r.isEmpty()){if(t.writev){let y,v=[];for(;!r.isEmpty();){if(y=r.shift(),y.error)throw y.error;v.push(y.value)}return{done:y.done,value:v}}let p=r.shift();if(p.error)throw p.error;return p}return s?{done:!0}:new Promise((p,y)=>{i=v=>(i=null,v.error?y(v.error):t.writev&&!v.done?p({done:v.done,value:[v.value]}):p(v),n)})},c=p=>i?i(p):(r.push(p),n),f=p=>(r=new Aa,i?i({error:p}):(r.push({error:p}),n)),u=p=>s?n:c({done:!1,value:p}),a=p=>s?n:(s=!0,p?f(p):c({done:!0})),h=()=>(r=new Aa,a(),{done:!0}),l=p=>(a(p),{done:!0});if(n={[Symbol.asyncIterator](){return this},next:o,return:h,throw:l,push:u,end:a},!e)return n;let d=n;return n={[Symbol.asyncIterator](){return this},next(){return d.next()},throw(p){return d.throw(p),e&&(e(p),e=null),{done:!0}},return(){return d.return(),e&&(e(),e=null),{done:!0}},push:u,end(p){return d.end(p),e&&(e(p),e=null),n}},n}});var Z0=m((wA,J0)=>{J0.exports=function(e){if(e){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}});var eh=m((_A,X0)=>{X0.exports=class extends Error{constructor(e,r){super(e||"The operation was aborted");this.type="aborted",this.code=r||"ABORT_ERR"}}});var ih=m((SA,$r)=>{var Xb=Z0(),Ca=eh(),th=(t,e,r)=>Ba(t,Array.isArray(e)?e:[{signal:e,options:r}]),Ba=(t,e)=>{t=Xb(t),e=e.map(({signal:n,options:i})=>({signal:n,options:i||{}}));async function*r(){let n,i=()=>{n&&n()};for(let{signal:s}of e)s.addEventListener("abort",i);for(;;){let s;try{for(let{signal:c,options:f}of e)if(c.aborted){let{abortMessage:u,abortCode:a}=f;throw new Ca(u,a)}let o=new Promise((c,f)=>{n=()=>{let{options:u}=e.find(({signal:l})=>l.aborted),{abortMessage:a,abortCode:h}=u;f(new Ca(a,h))}});s=await Promise.race([o,t.next()]),n=null}catch(o){for(let{signal:u}of e)u.removeEventListener("abort",i);let c=e.find(({signal:u})=>u.aborted),f=o.type==="aborted"&&c;if(f&&c.options.onAbort&&await c.options.onAbort(t),typeof t.return=="function"&&await t.return(),f&&c.options.returnOnAbort)return;throw o}if(s.done)break;yield s.value}for(let{signal:s}of e)s.removeEventListener("abort",i)}return r()},rh=(t,e,r)=>nh(t,Array.isArray(e)?e:[{signal:e,options:r}]),nh=(t,e)=>r=>t(Ba(r,e)),ev=(t,e,r)=>tv(t,Array.isArray(e)?e:[{signal:e,options:r}]),tv=(t,e)=>({sink:nh(t.sink,e),source:Ba(t.source,e)});$r.exports=th;$r.exports.AbortError=Ca;$r.exports.source=th;$r.exports.sink=rh;$r.exports.transform=rh;$r.exports.duplex=ev});var oh=m((IA,bs)=>{"use strict";var{AbortController:sh,AbortSignal:rv}=typeof self!="undefined"?self:typeof window!="undefined"?window:void 0;bs.exports=sh;bs.exports.AbortSignal=rv;bs.exports.default=sh});var lh=m((AA,hh)=>{"use strict";var ah=Xi(),nv=Object.assign(ah("libp2p-pubsub:peer-streams"),{error:ah("libp2p-pubsub:peer-streams:err")}),{EventEmitter:iv}=qo(),ch=V0(),sv=Q0(),{pipe:uh}=Uo(),{source:ov}=ih(),av=oh().default,fh=class extends iv{constructor({id:e,protocol:r}){super();this.id=e,this.protocol=r,this._rawOutboundStream=null,this._rawInboundStream=null,this._inboundAbortController=new av,this.outboundStream=null,this.inboundStream=null}get isReadable(){return Boolean(this.inboundStream)}get isWritable(){return Boolean(this.outboundStream)}write(e){if(!this.outboundStream){let r=this.id.toB58String();throw new Error("No writable connection to "+r)}this.outboundStream.push(e)}attachInboundStream(e){return this._rawInboundStream=e,this.inboundStream=ov(uh(this._rawInboundStream,ch.decode()),this._inboundAbortController.signal,{returnOnAbort:!0}),this.emit("stream:inbound"),this.inboundStream}async attachOutboundStream(e){let r=this.outboundStream;this.outboundStream&&await this.outboundStream.end(),this._rawOutboundStream=e,this.outboundStream=sv({onEnd:n=>{this._rawOutboundStream&&this._rawOutboundStream.reset&&this._rawOutboundStream.reset(),this._rawOutboundStream=null,this.outboundStream=null,n&&this.emit("close")}}),uh(this.outboundStream,ch.encode(),this._rawOutboundStream).catch(n=>{nv.error(n)}),r||this.emit("stream:outbound")}close(){this.outboundStream&&this.outboundStream.end(),this.inboundStream&&this._inboundAbortController.abort(),this._rawOutboundStream=null,this.outboundStream=null,this._rawInboundStream=null,this.inboundStream=null,this.emit("close")}};hh.exports=fh});var dh=m(ph=>{"use strict";var cv={StrictSign:"StrictSign",StrictNoSign:"StrictNoSign"};ph.SignaturePolicy=cv});var ms=m((BA,yh)=>{"use strict";var vs=65536;function uv(t){let e=new Uint8Array(t),r=0;if(t>0)if(t>vs)for(;r<t;)r+vs>t?(crypto.getRandomValues(e.subarray(r,r+(t-r))),r+=t-r):(crypto.getRandomValues(e.subarray(r,r+vs)),r+=vs);else crypto.getRandomValues(e);return e}yh.exports=uv});var bh=m((TA,gh)=>{"use strict";var fv=ms(),hv=ce();gh.exports=function(t){if(isNaN(t)||t<=0)throw hv(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return fv(t)}});function lv(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var c=t.length,f=t.charAt(0),u=Math.log(c)/Math.log(256),a=Math.log(256)/Math.log(c);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var y=0,v=0,b=0,w=p.length;b!==w&&p[b]===0;)b++,y++;for(var I=(w-b)*a+1>>>0,P=new Uint8Array(I);b!==w;){for(var T=p[b],S=0,K=I-1;(T!==0||S<v)&&K!==-1;K--,S++)T+=256*P[K]>>>0,P[K]=T%c>>>0,T=T/c>>>0;if(T!==0)throw new Error("Non-zero carry");v=S,b++}for(var U=I-v;U!==I&&P[U]===0;)U++;for(var ye=f.repeat(y);U<I;++U)ye+=t.charAt(P[U]);return ye}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var y=0;if(p[y]!==" "){for(var v=0,b=0;p[y]===f;)v++,y++;for(var w=(p.length-y)*u+1>>>0,I=new Uint8Array(w);p[y];){var P=r[p.charCodeAt(y)];if(P===255)return;for(var T=0,S=w-1;(P!==0||T<b)&&S!==-1;S--,T++)P+=c*I[S]>>>0,I[S]=P%256>>>0,P=P/256>>>0;if(P!==0)throw new Error("Non-zero carry");b=T,y++}if(p[y]!==" "){for(var K=w-b;K!==w&&I[K]===0;)K++;for(var U=new Uint8Array(v+(w-K)),ye=v;K!==w;)U[ye++]=I[K++];return U}}}function d(p){var y=l(p);if(y)return y;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var pv,dv,vh,mh=ee(()=>{pv=lv,dv=pv,vh=dv});var PA,xh,Jt,wh,Eh,vr=ee(()=>{PA=new Uint8Array(0),xh=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Jt=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},wh=t=>new TextEncoder().encode(t),Eh=t=>new TextDecoder().decode(t)});var Sh,Ih,Ah,Ch,Bh,xs,mr,yv,gv,ge,Pt=ee(()=>{mh();vr();Sh=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Ih=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseDecode=n}decode(e){if(typeof e=="string")switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(e){return Ch(this,e)}},Ah=class{constructor(e){this.decoders=e}or(e){return Ch(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Ch=(t,e)=>new Ah({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),Bh=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Sh(e,r,n),this.decoder=new Ih(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},xs=({name:t,prefix:e,encode:r,decode:n})=>new Bh(t,e,r,n),mr=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=vh(r,e);return xs({prefix:t,name:e,encode:n,decode:s=>Jt(i(s))})},yv=(t,e,r,n)=>{let i={};for(let a=0;a<e.length;++a)i[e[a]]=a;let s=t.length;for(;t[s-1]==="=";)--s;let o=new Uint8Array(s*r/8|0),c=0,f=0,u=0;for(let a=0;a<s;++a){let h=i[t[a]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,c+=r,c>=8&&(c-=8,o[u++]=255&f>>c)}if(c>=r||255&f<<8-c)throw new SyntaxError("Unexpected end of data");return o},gv=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,s="",o=0,c=0;for(let f=0;f<t.length;++f)for(c=c<<8|t[f],o+=8;o>r;)o-=r,s+=e[i&c>>o];if(o&&(s+=e[i&c<<r-o]),n)for(;s.length*r&7;)s+="=";return s},ge=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>xs({prefix:e,name:t,encode(i){return gv(i,n,r)},decode(i){return yv(i,n,r,t)}})});var Ta={};Re(Ta,{identity:()=>bv});var bv,Th=ee(()=>{Pt();vr();bv=xs({prefix:"\0",name:"identity",encode:t=>Eh(t),decode:t=>wh(t)})});var Ra={};Re(Ra,{base2:()=>vv});var vv,Rh=ee(()=>{Pt();vv=ge({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var Pa={};Re(Pa,{base8:()=>mv});var mv,Ph=ee(()=>{Pt();mv=ge({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var Da={};Re(Da,{base10:()=>xv});var xv,Dh=ee(()=>{Pt();xv=mr({prefix:"9",name:"base10",alphabet:"0123456789"})});var ws={};Re(ws,{base16:()=>wv,base16upper:()=>Ev});var wv,Ev,Oa=ee(()=>{Pt();wv=ge({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ev=ge({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var ii={};Re(ii,{base32:()=>In,base32hex:()=>Av,base32hexpad:()=>Bv,base32hexpadupper:()=>Tv,base32hexupper:()=>Cv,base32pad:()=>Sv,base32padupper:()=>Iv,base32upper:()=>_v,base32z:()=>Rv});var In,_v,Sv,Iv,Av,Cv,Bv,Tv,Rv,si=ee(()=>{Pt();In=ge({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),_v=ge({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Sv=ge({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Iv=ge({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Av=ge({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Cv=ge({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Bv=ge({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Tv=ge({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Rv=ge({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var Es={};Re(Es,{base36:()=>Pv,base36upper:()=>Dv});var Pv,Dv,ka=ee(()=>{Pt();Pv=mr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Dv=mr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var Yr={};Re(Yr,{base58btc:()=>Dt,base58flickr:()=>Ov});var Dt,Ov,Qr=ee(()=>{Pt();Dt=mr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ov=mr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var xr={};Re(xr,{base64:()=>kv,base64pad:()=>Nv,base64url:()=>Lv,base64urlpad:()=>Kv});var kv,Nv,Lv,Kv,Jr=ee(()=>{Pt();kv=ge({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Nv=ge({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Lv=ge({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Kv=ge({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});function kh(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Uv;)e[r++]=t&255|Oh,t/=128;for(;t&Fv;)e[r++]=t&255|Oh,t>>>=7;return e[r]=t|0,kh.bytes=r-n+1,e}function Na(t,e){var r=0,e=e||0,n=0,i=e,s,o=t.length;do{if(i>=o)throw Na.bytes=0,new RangeError("Could not decode varint");s=t[i++],r+=n<28?(s&Nh)<<n:(s&Nh)*Math.pow(2,n),n+=7}while(s>=Vv);return Na.bytes=i-e,r}var Mv,Oh,qv,Fv,Uv,Gv,Vv,Nh,jv,Hv,zv,Wv,$v,Yv,Qv,Jv,Zv,Xv,e2,t2,oi,Lh=ee(()=>{Mv=kh,Oh=128,qv=127,Fv=~qv,Uv=Math.pow(2,31);Gv=Na,Vv=128,Nh=127;jv=Math.pow(2,7),Hv=Math.pow(2,14),zv=Math.pow(2,21),Wv=Math.pow(2,28),$v=Math.pow(2,35),Yv=Math.pow(2,42),Qv=Math.pow(2,49),Jv=Math.pow(2,56),Zv=Math.pow(2,63),Xv=function(t){return t<jv?1:t<Hv?2:t<zv?3:t<Wv?4:t<$v?5:t<Yv?6:t<Qv?7:t<Jv?8:t<Zv?9:10},e2={encode:Mv,decode:Gv,encodingLength:Xv},t2=e2,oi=t2});var ai,An,Cn,_s=ee(()=>{Lh();ai=t=>[oi.decode(t),oi.decode.bytes],An=(t,e,r=0)=>(oi.encode(t,e,r),e),Cn=t=>oi.encodingLength(t)});var Ss={};Re(Ss,{Digest:()=>Bn,create:()=>ci,decode:()=>La,equals:()=>Ka});var ci,La,Ka,Bn,ui=ee(()=>{vr();_s();ci=(t,e)=>{let r=e.byteLength,n=Cn(t),i=n+Cn(r),s=new Uint8Array(i+r);return An(t,s,0),An(r,s,n),s.set(e,i),new Bn(t,r,e,s)},La=t=>{let e=Jt(t),[r,n]=ai(e),[i,s]=ai(e.subarray(n)),o=e.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new Bn(r,i,o,e)},Ka=(t,e)=>t===e?!0:t.code===e.code&&t.size===e.size&&xh(t.bytes,e.bytes),Bn=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}});var fi,Mh,Is=ee(()=>{ui();fi=({name:t,code:e,encode:r})=>new Mh(t,e,r),Mh=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}async digest(e){if(e instanceof Uint8Array){let r=await this.encode(e);return ci(this.code,r)}else throw Error("Unknown type, must be binary type")}}});var nt={};Re(nt,{sha256:()=>r2,sha512:()=>n2});var Fh,r2,n2,vt=ee(()=>{Is();Fh=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),r2=fi({name:"sha2-256",code:18,encode:Fh("SHA-256")}),n2=fi({name:"sha2-512",code:19,encode:Fh("SHA-512")})});var Tn={};Re(Tn,{identity:()=>i2});var i2,hi=ee(()=>{Is();vr();i2=fi({name:"identity",code:0,encode:t=>Jt(t)})});var Uh=ee(()=>{vr()});var e8,t8,Gh=ee(()=>{e8=new TextEncoder,t8=new TextDecoder});var Hh={};Re(Hh,{CID:()=>Ee});var Ee,a2,c2,u2,li,f2,Vh,jh,As,Cs,h2,l2,p2,Ma=ee(()=>{_s();ui();Qr();si();vr();Ee=class{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this.byteOffset=i.byteOffset,this.byteLength=i.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:Cs,byteLength:Cs,code:As,version:As,multihash:As,bytes:As,_baseCache:Cs,asCID:Cs})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:r}=this;if(e!==li)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==f2)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Ee.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=ci(e,r);return Ee.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&Ka(this.multihash,e.multihash)}toString(e){let{bytes:r,version:n,_baseCache:i}=this;switch(n){case 0:return c2(r,i,e||Dt.encoder);default:return u2(r,i,e||In.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return l2(/^0\.0/,p2),!!(e&&(e[jh]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof Ee)return e;if(e!=null&&e.asCID===e){let{version:r,code:n,multihash:i,bytes:s}=e;return new Ee(r,n,i,s||Vh(r,n,i.bytes))}else if(e!=null&&e[jh]===!0){let{version:r,multihash:n,code:i}=e,s=La(n);return Ee.create(r,i,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(r!==li)throw new Error(`Version 0 CID must use dag-pb (code: ${li}) block encoding`);return new Ee(e,r,n,n.bytes)}case 1:{let i=Vh(e,r,n.bytes);return new Ee(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return Ee.create(0,li,e)}static createV1(e,r){return Ee.create(1,e,r)}static decode(e){let[r,n]=Ee.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=Ee.inspectBytes(e),n=r.size-r.multihashSize,i=Jt(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=i.subarray(r.multihashSize-r.digestSize),o=new Bn(r.multihashCode,r.digestSize,s,i);return[r.version===0?Ee.createV0(o):Ee.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=ai(e.subarray(r));return r+=l,h},i=n(),s=li;if(i===18?(i=0,r=0):i===1&&(s=n()),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let o=r,c=n(),f=n(),u=r+f,a=u-o;return{version:i,codec:s,multihashCode:c,digestSize:f,multihashSize:a,size:u}}static parse(e,r){let[n,i]=a2(e,r),s=Ee.decode(i);return s._baseCache.set(n,e),s}},a2=(t,e)=>{switch(t[0]){case"Q":{let r=e||Dt;return[Dt.prefix,r.decode(`${Dt.prefix}${t}`)]}case Dt.prefix:{let r=e||Dt;return[Dt.prefix,r.decode(t)]}case In.prefix:{let r=e||In;return[In.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},c2=(t,e,r)=>{let{prefix:n}=r;if(n!==Dt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return i},u2=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let s=r.encode(t);return e.set(n,s),s}else return i},li=112,f2=18,Vh=(t,e,r)=>{let n=Cn(t),i=n+Cn(e),s=new Uint8Array(i+r.byteLength);return An(t,s,0),An(e,s,n),s.set(r,i),s},jh=Symbol.for("@ipld/js-cid/CID"),As={writable:!1,configurable:!1,enumerable:!0},Cs={writable:!1,enumerable:!1,configurable:!1},h2="0.0.0-dev",l2=(t,e)=>{if(t.test(h2))console.warn(e);else throw new Error(e)},p2=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});var zh=ee(()=>{Ma();_s();vr();Is();ui()});var qa,f8,Wh=ee(()=>{Th();Rh();Ph();Dh();Oa();si();ka();Qr();Jr();vt();hi();Uh();Gh();zh();qa={...Ta,...Ra,...Pa,...Da,...ws,...ii,...Es,...Yr,...xr},f8={...nt,...Tn}});function $h(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var Yh,Fa,d2,Bs,Ua=ee(()=>{Wh();Yh=$h("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),Fa=$h("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),d2={utf8:Yh,"utf-8":Yh,hex:qa.base16,latin1:Fa,ascii:Fa,binary:Fa,...qa},Bs=d2});var ke={};Re(ke,{toString:()=>y2});function y2(t,e="utf8"){let r=Bs[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.encoder.encode(t).substring(1)}var Ne=ee(()=>{Ua()});var Pe={};Re(Pe,{fromString:()=>g2});function g2(t,e="utf8"){let r=Bs[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.decoder.decode(`${r.prefix}${t}`)}var De=ee(()=>{Ua()});var Rs=m((g8,Jh)=>{"use strict";var Zr=Vr(),Ts=Zr.Reader,Qh=Zr.Writer,Le=Zr.util,it=Zr.roots["libp2p-crypto-keys"]||(Zr.roots["libp2p-crypto-keys"]={});it.KeyType=function(){var t={},e=Object.create(t);return e[t[0]="RSA"]=0,e[t[1]="Ed25519"]=1,e[t[2]="Secp256k1"]=2,e}();it.PublicKey=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.Type=0,t.prototype.Data=Le.newBuffer([]),t.encode=function(r,n){return n||(n=Qh.create()),n.uint32(8).int32(r.Type),n.uint32(18).bytes(r.Data),n},t.decode=function(r,n){r instanceof Ts||(r=Ts.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new it.PublicKey;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw Le.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw Le.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof it.PublicKey)return r;var n=new it.PublicKey;switch(r.Type){case"RSA":case 0:n.Type=0;break;case"Ed25519":case 1:n.Type=1;break;case"Secp256k1":case 2:n.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?Le.base64.decode(r.Data,n.Data=Le.newBuffer(Le.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.Type=n.enums===String?"RSA":0,n.bytes===String?i.Data="":(i.Data=[],n.bytes!==Array&&(i.Data=Le.newBuffer(i.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(i.Type=n.enums===String?it.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(i.Data=n.bytes===String?Le.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Zr.util.toJSONOptions)},t}();it.PrivateKey=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.Type=0,t.prototype.Data=Le.newBuffer([]),t.encode=function(r,n){return n||(n=Qh.create()),n.uint32(8).int32(r.Type),n.uint32(18).bytes(r.Data),n},t.decode=function(r,n){r instanceof Ts||(r=Ts.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new it.PrivateKey;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw Le.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw Le.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof it.PrivateKey)return r;var n=new it.PrivateKey;switch(r.Type){case"RSA":case 0:n.Type=0;break;case"Ed25519":case 1:n.Type=1;break;case"Secp256k1":case 2:n.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?Le.base64.decode(r.Data,n.Data=Le.newBuffer(Le.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.Type=n.enums===String?"RSA":0,n.bytes===String?i.Data="":(i.Data=[],n.bytes!==Array&&(i.Data=Le.newBuffer(i.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(i.Type=n.enums===String?it.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(i.Data=n.bytes===String?Le.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Zr.util.toJSONOptions)},t}();Jh.exports=it});var W=m((b8,Zh)=>{Zh.exports={options:{usePureJavaScript:!1}}});var tl=m((v8,el)=>{var Ga={};el.exports=Ga;var Xh={};Ga.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=b2(t,e);else{var i=0,s=e.length,o=e.charAt(0),c=[0];for(i=0;i<t.length;++i){for(var f=0,u=t[i];f<c.length;++f)u+=c[f]<<8,c[f]=u%s,u=u/s|0;for(;u>0;)c.push(u%s),u=u/s|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=o;for(i=c.length-1;i>=0;--i)n+=e[c[i]]}if(r){var a=new RegExp(".{1,"+r+"}","g");n=n.match(a).join(`\r
`)}return n};Ga.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=Xh[e];if(!r){r=Xh[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,s=e.charAt(0),o=[0],n=0;n<t.length;n++){var c=r[t.charCodeAt(n)];if(c===void 0)return;for(var f=0,u=c;f<o.length;++f)u+=o[f]*i,o[f]=u&255,u>>=8;for(;u>0;)o.push(u&255),u>>=8}for(var a=0;t[a]===s&&a<t.length-1;++a)o.push(0);return typeof Buffer!="undefined"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function b2(t,e){var r=0,n=e.length,i=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var o=0,c=t.at(r);o<s.length;++o)c+=s[o]<<8,s[o]=c%n,c=c/n|0;for(;c>0;)s.push(c%n),c=c/n|0}var f="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)f+=i;for(r=s.length-1;r>=0;--r)f+=e[s[r]];return f}});var me=m((m8,sl)=>{var rl=W(),nl=tl(),g=sl.exports=rl.util=rl.util||{};(function(){if(typeof process!="undefined"&&process.nextTick&&!process.browser){g.nextTick=process.nextTick,typeof setImmediate=="function"?g.setImmediate=setImmediate:g.setImmediate=g.nextTick;return}if(typeof setImmediate=="function"){g.setImmediate=function(){return setImmediate.apply(void 0,arguments)},g.nextTick=function(c){return setImmediate(c)};return}if(g.setImmediate=function(c){setTimeout(c,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){let c=function(f){if(f.source===window&&f.data===t){f.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(a){a()})}};var o=c,t="forge.setImmediate",e=[];g.setImmediate=function(f){e.push(f),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",c,!0)}if(typeof MutationObserver!="undefined"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var f=e.slice();e.length=0,f.forEach(function(u){u()})}).observe(i,{attributes:!0});var s=g.setImmediate;g.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),s(f)):(e.push(f),e.length===1&&i.setAttribute("a",n=!n))}}g.nextTick=g.setImmediate})();g.isNodejs=typeof process!="undefined"&&process.versions&&process.versions.node;g.globalScope=function(){return g.isNodejs?globalThis:typeof self=="undefined"?window:self}();g.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};g.isArrayBuffer=function(t){return typeof ArrayBuffer!="undefined"&&t instanceof ArrayBuffer};g.isArrayBufferView=function(t){return t&&g.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function pi(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}g.ByteBuffer=Va;function Va(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(g.isArrayBuffer(t)||g.isArrayBufferView(t))if(typeof Buffer!="undefined"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch(n){for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof Va||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}g.ByteStringBuffer=Va;var v2=4096;g.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>v2&&(this.data.substr(0,1),this._constructedStringLength=0)};g.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};g.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};g.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};g.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};g.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};g.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(g.encodeUtf8(t))};g.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};g.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};g.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};g.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};g.ByteStringBuffer.prototype.putInt=function(t,e){pi(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};g.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};g.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};g.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};g.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};g.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};g.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};g.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};g.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};g.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};g.ByteStringBuffer.prototype.getInt=function(t){pi(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};g.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};g.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};g.ByteStringBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};g.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};g.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};g.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};g.ByteStringBuffer.prototype.copy=function(){var t=g.createBuffer(this.data);return t.read=this.read,t};g.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};g.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};g.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};g.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};g.ByteStringBuffer.prototype.toString=function(){return g.decodeUtf8(this.bytes())};function m2(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=g.isArrayBuffer(t),n=g.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}g.DataBuffer=m2;g.DataBuffer.prototype.length=function(){return this.write-this.read};g.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};g.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};g.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};g.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};g.DataBuffer.prototype.putBytes=function(t,e){if(g.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(g.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof g.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&g.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof g.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=g.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=g.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};g.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};g.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};g.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};g.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};g.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};g.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};g.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};g.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};g.DataBuffer.prototype.putInt=function(t,e){pi(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};g.DataBuffer.prototype.putSignedInt=function(t,e){return pi(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};g.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};g.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};g.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};g.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};g.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};g.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};g.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};g.DataBuffer.prototype.getInt=function(t){pi(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};g.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};g.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};g.DataBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};g.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};g.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};g.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};g.DataBuffer.prototype.copy=function(){return new g.DataBuffer(this)};g.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};g.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};g.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};g.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};g.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return g.binary.raw.encode(e);if(t==="hex")return g.binary.hex.encode(e);if(t==="base64")return g.binary.base64.encode(e);if(t==="utf8")return g.text.utf8.decode(e);if(t==="utf16")return g.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};g.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=g.encodeUtf8(t)),new g.ByteBuffer(t)};g.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};g.xorBytes=function(t,e,r){for(var n="",i="",s="",o=0,c=0;r>0;--r,++o)i=t.charCodeAt(o)^e.charCodeAt(o),c>=10&&(n+=s,s="",c=0),s+=String.fromCharCode(i),++c;return n+=s,n};g.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};g.bytesToHex=function(t){return g.createBuffer(t).toHex()};g.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var wr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Er=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],il="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";g.encode64=function(t,e){for(var r="",n="",i,s,o,c=0;c<t.length;)i=t.charCodeAt(c++),s=t.charCodeAt(c++),o=t.charCodeAt(c++),r+=wr.charAt(i>>2),r+=wr.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=wr.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":wr.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};g.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,s,o=0;o<t.length;)r=Er[t.charCodeAt(o++)-43],n=Er[t.charCodeAt(o++)-43],i=Er[t.charCodeAt(o++)-43],s=Er[t.charCodeAt(o++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(e+=String.fromCharCode((i&3)<<6|s)));return e};g.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};g.decodeUtf8=function(t){return decodeURIComponent(escape(t))};g.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:nl.encode,decode:nl.decode}};g.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};g.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};g.binary.hex.encode=g.bytesToHex;g.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,s=r;for(t.length&1&&(i=1,n[s++]=parseInt(t[0],16));i<t.length;i+=2)n[s++]=parseInt(t.substr(i,2),16);return e?s-r:n};g.binary.base64.encode=function(t,e){for(var r="",n="",i,s,o,c=0;c<t.byteLength;)i=t[c++],s=t[c++],o=t[c++],r+=wr.charAt(i>>2),r+=wr.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=wr.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":wr.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};g.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,o,c,f=0,u=r;f<t.length;)i=Er[t.charCodeAt(f++)-43],s=Er[t.charCodeAt(f++)-43],o=Er[t.charCodeAt(f++)-43],c=Er[t.charCodeAt(f++)-43],n[u++]=i<<2|s>>4,o!==64&&(n[u++]=(s&15)<<4|o>>2,c!==64&&(n[u++]=(o&3)<<6|c));return e?u-r:n.subarray(0,u)};g.binary.base58.encode=function(t,e){return g.binary.baseN.encode(t,il,e)};g.binary.base58.decode=function(t,e){return g.binary.baseN.decode(t,il,e)};g.text={utf8:{},utf16:{}};g.text.utf8.encode=function(t,e,r){t=g.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};g.text.utf8.decode=function(t){return g.decodeUtf8(String.fromCharCode.apply(null,t))};g.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,o=r,c=0;c<t.length;++c)i[o++]=t.charCodeAt(c),s+=2;return e?s-r:n};g.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};g.deflate=function(t,e,r){if(e=g.decode64(t.deflate(g.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};g.inflate=function(t,e,r){var n=t.inflate(g.encode64(e)).rval;return n===null?null:g.decode64(n)};var ja=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=g.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n!="undefined"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},Ha=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(g.decode64(r))),r},x2=function(t,e,r,n){var i=Ha(t,e);i===null&&(i={}),i[r]=n,ja(t,e,i)},w2=function(t,e,r){var n=Ha(t,e);return n!==null&&(n=r in n?n[r]:null),n},E2=function(t,e,r){var n=Ha(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),ja(t,e,n)}},_2=function(t,e){ja(t,e,null)},Ps=function(t,e,r){var n=null;typeof r=="undefined"&&(r=["web","flash"]);var i,s=!1,o=null;for(var c in r){i=r[c];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),s=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),s=!0)}catch(f){o=f}if(s)break}if(!s)throw o;return n};g.setItem=function(t,e,r,n,i){Ps(x2,arguments,i)};g.getItem=function(t,e,r,n){return Ps(w2,arguments,n)};g.removeItem=function(t,e,r,n){Ps(E2,arguments,n)};g.clearItems=function(t,e,r){Ps(_2,arguments,r)};g.parseUrl=function(t){var e=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;e.lastIndex=0;var r=e.exec(t),n=r===null?null:{full:t,scheme:r[1],host:r[2],port:r[3],path:r[4]};return n&&(n.fullHost=n.host,n.port?(n.port!==80&&n.scheme==="http"||n.port!==443&&n.scheme==="https")&&(n.fullHost+=":"+n.port):n.scheme==="http"?n.port=80:n.scheme==="https"&&(n.port=443),n.full=n.scheme+"://"+n.fullHost),n};var Ds=null;g.getQueryVariables=function(t){var e=function(n){for(var i={},s=n.split("&"),o=0;o<s.length;o++){var c=s[o].indexOf("="),f,u;c>0?(f=s[o].substring(0,c),u=s[o].substring(c+1)):(f=s[o],u=null),f in i||(i[f]=[]),!(f in Object.prototype)&&u!==null&&i[f].push(unescape(u))}return i},r;return typeof t=="undefined"?(Ds===null&&(typeof window!="undefined"&&window.location&&window.location.search?Ds=e(window.location.search.substring(1)):Ds={}),r=Ds):r=e(t),r};g.parseFragment=function(t){var e=t,r="",n=t.indexOf("?");n>0&&(e=t.substring(0,n),r=t.substring(n+1));var i=e.split("/");i.length>0&&i[0]===""&&i.shift();var s=r===""?{}:g.getQueryVariables(r);return{pathString:e,queryString:r,path:i,query:s}};g.makeRequest=function(t){var e=g.parseFragment(t),r={path:e.pathString,query:e.queryString,getPath:function(n){return typeof n=="undefined"?e.path:e.path[n]},getQuery:function(n,i){var s;return typeof n=="undefined"?s=e.query:(s=e.query[n],s&&typeof i!="undefined"&&(s=s[i])),s},getQueryLast:function(n,i){var s,o=r.getQuery(n);return o?s=o[o.length-1]:s=i,s}};return r};g.makeLink=function(t,e,r){t=jQuery.isArray(t)?t.join("/"):t;var n=jQuery.param(e||{});return r=r||"",t+(n.length>0?"?"+n:"")+(r.length>0?"#"+r:"")};g.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};g.format=function(t){for(var e=/%./g,r,n,i=0,s=[],o=0;r=e.exec(t);){n=t.substring(o,e.lastIndex-2),n.length>0&&s.push(n),o=e.lastIndex;var c=r[0][1];switch(c){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+c+"?>")}}return s.push(t.substring(o)),s.join("")};g.formatNumber=function(t,e,r,n){var i=t,s=isNaN(e=Math.abs(e))?2:e,o=r===void 0?",":r,c=n===void 0?".":n,f=i<0?"-":"",u=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",a=u.length>3?u.length%3:0;return f+(a?u.substr(0,a)+c:"")+u.substr(a).replace(/(\d{3})(?=\d)/g,"$1"+c)+(s?o+Math.abs(i-u).toFixed(s).slice(2):"")};g.formatSize=function(t){return t>=1073741824?t=g.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=g.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=g.formatNumber(t/1024,0)+" KiB":t=g.formatNumber(t,0)+" bytes",t};g.bytesFromIP=function(t){return t.indexOf(".")!==-1?g.bytesFromIPv4(t):t.indexOf(":")!==-1?g.bytesFromIPv6(t):null};g.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=g.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};g.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(o){return o.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=g.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=g.hexToBytes(t[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};g.bytesToIP=function(t){return t.length===4?g.bytesToIPv4(t):t.length===16?g.bytesToIPv6(t):null};g.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};g.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var s=g.bytesToHex(t[i]+t[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=r[r.length-1],c=e.length;!o||c!==o.end+1?r.push({start:c,end:c}):(o.end=c,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(s)}if(r.length>0){var f=r[n];f.end-f.start>0&&(e.splice(f.start,f.end-f.start+1,""),f.start===0&&e.unshift(""),f.end===7&&e.push(""))}return e.join(":")};g.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in g&&!t.update)return e(null,g.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return g.cores=navigator.hardwareConcurrency,e(null,g.cores);if(typeof Worker=="undefined")return g.cores=1,e(null,g.cores);if(typeof Blob=="undefined")return g.cores=2,e(null,g.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var c=Date.now(),f=c+4;Date.now()<f;);self.postMessage({st:c,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(o,c,f){if(c===0){var u=Math.floor(o.reduce(function(a,h){return a+h},0)/o.length);return g.cores=Math.max(1,u),URL.revokeObjectURL(r),e(null,g.cores)}i(f,function(a,h){o.push(s(f,h)),n(o,c-1,f)})}function i(o,c){for(var f=[],u=[],a=0;a<o;++a){var h=new Worker(r);h.addEventListener("message",function(l){if(u.push(l.data),u.length===o){for(var d=0;d<o;++d)f[d].terminate();c(null,u)}}),f.push(h)}for(var a=0;a<o;++a)f[a].postMessage(a)}function s(o,c){for(var f=[],u=0;u<o;++u)for(var a=c[u],h=f[u]=[],l=0;l<o;++l)if(u!==l){var d=c[l];(a.st>d.st&&a.st<d.et||d.st>a.st&&d.st<a.et)&&h.push(l)}return f.reduce(function(p,y){return Math.max(p,y.length)},0)}}});var Os=m((x8,ol)=>{var di=W();di.pki=di.pki||{};var za=ol.exports=di.pki.oids=di.oids=di.oids||{};function B(t,e){za[t]=e,za[e]=t}function J(t,e){za[t]=e}B("1.2.840.113549.1.1.1","rsaEncryption");B("1.2.840.113549.1.1.4","md5WithRSAEncryption");B("1.2.840.113549.1.1.5","sha1WithRSAEncryption");B("1.2.840.113549.1.1.7","RSAES-OAEP");B("1.2.840.113549.1.1.8","mgf1");B("1.2.840.113549.1.1.9","pSpecified");B("1.2.840.113549.1.1.10","RSASSA-PSS");B("1.2.840.113549.1.1.11","sha256WithRSAEncryption");B("1.2.840.113549.1.1.12","sha384WithRSAEncryption");B("1.2.840.113549.1.1.13","sha512WithRSAEncryption");B("1.3.101.112","EdDSA25519");B("1.2.840.10040.4.3","dsa-with-sha1");B("1.3.14.3.2.7","desCBC");B("1.3.14.3.2.26","sha1");B("2.16.840.1.101.3.4.2.1","sha256");B("2.16.840.1.101.3.4.2.2","sha384");B("2.16.840.1.101.3.4.2.3","sha512");B("1.2.840.113549.2.5","md5");B("1.2.840.113549.1.7.1","data");B("1.2.840.113549.1.7.2","signedData");B("1.2.840.113549.1.7.3","envelopedData");B("1.2.840.113549.1.7.4","signedAndEnvelopedData");B("1.2.840.113549.1.7.5","digestedData");B("1.2.840.113549.1.7.6","encryptedData");B("1.2.840.113549.1.9.1","emailAddress");B("1.2.840.113549.1.9.2","unstructuredName");B("1.2.840.113549.1.9.3","contentType");B("1.2.840.113549.1.9.4","messageDigest");B("1.2.840.113549.1.9.5","signingTime");B("1.2.840.113549.1.9.6","counterSignature");B("1.2.840.113549.1.9.7","challengePassword");B("1.2.840.113549.1.9.8","unstructuredAddress");B("1.2.840.113549.1.9.14","extensionRequest");B("1.2.840.113549.1.9.20","friendlyName");B("1.2.840.113549.1.9.21","localKeyId");B("1.2.840.113549.1.9.22.1","x509Certificate");B("1.2.840.113549.1.12.10.1.1","keyBag");B("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");B("1.2.840.113549.1.12.10.1.3","certBag");B("1.2.840.113549.1.12.10.1.4","crlBag");B("1.2.840.113549.1.12.10.1.5","secretBag");B("1.2.840.113549.1.12.10.1.6","safeContentsBag");B("1.2.840.113549.1.5.13","pkcs5PBES2");B("1.2.840.113549.1.5.12","pkcs5PBKDF2");B("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");B("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");B("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");B("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");B("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");B("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");B("1.2.840.113549.2.7","hmacWithSHA1");B("1.2.840.113549.2.8","hmacWithSHA224");B("1.2.840.113549.2.9","hmacWithSHA256");B("1.2.840.113549.2.10","hmacWithSHA384");B("1.2.840.113549.2.11","hmacWithSHA512");B("1.2.840.113549.3.7","des-EDE3-CBC");B("2.16.840.1.101.3.4.1.2","aes128-CBC");B("2.16.840.1.101.3.4.1.22","aes192-CBC");B("2.16.840.1.101.3.4.1.42","aes256-CBC");B("2.5.4.3","commonName");B("2.5.4.5","serialName");B("2.5.4.6","countryName");B("2.5.4.7","localityName");B("2.5.4.8","stateOrProvinceName");B("2.5.4.9","streetAddress");B("2.5.4.10","organizationName");B("2.5.4.11","organizationalUnitName");B("2.5.4.13","description");B("2.5.4.15","businessCategory");B("2.5.4.17","postalCode");B("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");B("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");B("2.16.840.1.113730.1.1","nsCertType");B("2.16.840.1.113730.1.13","nsComment");J("2.5.29.1","authorityKeyIdentifier");J("2.5.29.2","keyAttributes");J("2.5.29.3","certificatePolicies");J("2.5.29.4","keyUsageRestriction");J("2.5.29.5","policyMapping");J("2.5.29.6","subtreesConstraint");J("2.5.29.7","subjectAltName");J("2.5.29.8","issuerAltName");J("2.5.29.9","subjectDirectoryAttributes");J("2.5.29.10","basicConstraints");J("2.5.29.11","nameConstraints");J("2.5.29.12","policyConstraints");J("2.5.29.13","basicConstraints");B("2.5.29.14","subjectKeyIdentifier");B("2.5.29.15","keyUsage");J("2.5.29.16","privateKeyUsagePeriod");B("2.5.29.17","subjectAltName");B("2.5.29.18","issuerAltName");B("2.5.29.19","basicConstraints");J("2.5.29.20","cRLNumber");J("2.5.29.21","cRLReason");J("2.5.29.22","expirationDate");J("2.5.29.23","instructionCode");J("2.5.29.24","invalidityDate");J("2.5.29.25","cRLDistributionPoints");J("2.5.29.26","issuingDistributionPoint");J("2.5.29.27","deltaCRLIndicator");J("2.5.29.28","issuingDistributionPoint");J("2.5.29.29","certificateIssuer");J("2.5.29.30","nameConstraints");B("2.5.29.31","cRLDistributionPoints");B("2.5.29.32","certificatePolicies");J("2.5.29.33","policyMappings");J("2.5.29.34","policyConstraints");B("2.5.29.35","authorityKeyIdentifier");J("2.5.29.36","policyConstraints");B("2.5.29.37","extKeyUsage");J("2.5.29.46","freshestCRL");J("2.5.29.54","inhibitAnyPolicy");B("1.3.6.1.4.1.11129.2.4.2","timestampList");B("1.3.6.1.5.5.7.1.1","authorityInfoAccess");B("1.3.6.1.5.5.7.3.1","serverAuth");B("1.3.6.1.5.5.7.3.2","clientAuth");B("1.3.6.1.5.5.7.3.3","codeSigning");B("1.3.6.1.5.5.7.3.4","emailProtection");B("1.3.6.1.5.5.7.3.8","timeStamping")});var Xr=m((w8,cl)=>{var ue=W();me();Os();var D=cl.exports=ue.asn1=ue.asn1||{};D.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};D.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};D.create=function(t,e,r,n,i){if(ue.util.isArray(n)){for(var s=[],o=0;o<n.length;++o)n[o]!==void 0&&s.push(n[o]);n=s}var c={tagClass:t,type:e,constructed:r,composed:r||ue.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(c.bitStringContents=i.bitStringContents,c.original=D.copy(c)),c};D.copy=function(t,e){var r;if(ue.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(D.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:D.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};D.equals=function(t,e,r){if(ue.util.isArray(t)){if(!ue.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!D.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&D.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};D.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function yi(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var S2=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;yi(t,e,s),n=t.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};D.fromDer=function(t,e){return e===void 0&&(e={strict:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=ue.util.createBuffer(t)),ks(t,t.length(),0,e)};function ks(t,e,r,n){var i;yi(t,e,2);var s=t.getByte();e--;var o=s&192,c=s&31;i=t.length();var f=S2(t,e);if(e-=i-t.length(),f!==void 0&&f>e){if(n.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=t.length(),u.remaining=e,u.requested=f,u}f=e}var a,h,l=(s&32)==32;if(l)if(a=[],f===void 0)for(;;){if(yi(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),a.push(ks(t,e,r+1,n)),e-=i-t.length()}else for(;f>0;)i=t.length(),a.push(ks(t,f,r+1,n)),e-=i-t.length(),f-=i-t.length();if(a===void 0&&o===D.Class.UNIVERSAL&&c===D.Type.BITSTRING&&(h=t.bytes(f)),a===void 0&&n.decodeBitStrings&&o===D.Class.UNIVERSAL&&c===D.Type.BITSTRING&&f>1){var d=t.read,p=e,y=0;if(c===D.Type.BITSTRING&&(yi(t,e,1),y=t.getByte(),e--),y===0)try{i=t.length();var v={verbose:n.verbose,strict:!0,decodeBitStrings:!0},b=ks(t,e,r+1,v),w=i-t.length();e-=w,c==D.Type.BITSTRING&&w++;var I=b.tagClass;w===f&&(I===D.Class.UNIVERSAL||I===D.Class.CONTEXT_SPECIFIC)&&(a=[b])}catch(T){}a===void 0&&(t.read=d,e=p)}if(a===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=e}if(c===D.Type.BMPSTRING)for(a="";f>0;f-=2)yi(t,e,2),a+=String.fromCharCode(t.getInt16()),e-=2;else a=t.getBytes(f)}var P=h===void 0?null:{bitStringContents:h};return D.create(o,c,l,a,P)}D.toDer=function(t){var e=ue.util.createBuffer(),r=t.tagClass|t.type,n=ue.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=D.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&n.putBuffer(D.toDer(t.value[s]))}else if(t.type===D.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)n.putInt16(t.value.charCodeAt(s));else t.type===D.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&(t.value.charCodeAt(1)&128)==0||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)==128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var o=n.length(),c="";do c+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(c.length|128);for(var s=c.length-1;s>=0;--s)e.putByte(c.charCodeAt(s))}return e.putBuffer(n),e};D.oidToDer=function(t){var e=t.split("."),r=ue.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,s,o,c=2;c<e.length;++c){n=!0,i=[],s=parseInt(e[c],10);do o=s&127,s=s>>>7,n||(o|=128),i.push(o),n=!1;while(s>0);for(var f=i.length-1;f>=0;--f)r.putByte(i[f])}return r};D.derToOid=function(t){var e;typeof t=="string"&&(t=ue.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};D.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),c=0;if(t.length>11){var f=t.charAt(10),u=10;f!=="+"&&f!=="-"&&(c=parseInt(t.substr(10,2),10),u+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(s,o,c,0),u&&(f=t.charAt(u),f==="+"||f==="-")){var a=parseInt(t.substr(u+1,2),10),h=parseInt(t.substr(u+4,2),10),l=a*60+h;l*=6e4,f==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};D.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=parseInt(t.substr(10,2),10),c=parseInt(t.substr(12,2),10),f=0,u=0,a=!1;t.charAt(t.length-1)==="Z"&&(a=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var d=parseInt(t.substr(h+1,2),10),p=parseInt(t.substr(h+4,2),10);u=d*60+p,u*=6e4,l==="+"&&(u*=-1),a=!0}return t.charAt(14)==="."&&(f=parseFloat(t.substr(14),10)*1e3),a?(e.setUTCFullYear(r,n,i),e.setUTCHours(s,o,c,f),e.setTime(+e+u)):(e.setFullYear(r,n,i),e.setHours(s,o,c,f)),e};D.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};D.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};D.integerToDer=function(t){var e=ue.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};D.derToInteger=function(t){typeof t=="string"&&(t=ue.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};D.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass=="undefined")&&(t.type===e.type||typeof e.type=="undefined"))if(t.constructed===e.constructed||typeof e.constructed=="undefined"){if(i=!0,e.value&&ue.util.isArray(e.value))for(var s=0,o=0;i&&o<e.value.length;++o)i=e.value[o].optional||!1,t.value[s]&&(i=D.validate(t.value[s],e.value[o],r,n),i?++s:e.value[o].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var c;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var f=t.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var al=/[^\\u0000-\\u00ff]/;D.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",s=0;s<e*r;++s)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case D.Class.UNIVERSAL:n+="Universal:";break;case D.Class.APPLICATION:n+="Application:";break;case D.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case D.Class.PRIVATE:n+="Private:";break}if(t.tagClass===D.Class.UNIVERSAL)switch(n+=t.type,t.type){case D.Type.NONE:n+=" (None)";break;case D.Type.BOOLEAN:n+=" (Boolean)";break;case D.Type.INTEGER:n+=" (Integer)";break;case D.Type.BITSTRING:n+=" (Bit string)";break;case D.Type.OCTETSTRING:n+=" (Octet string)";break;case D.Type.NULL:n+=" (Null)";break;case D.Type.OID:n+=" (Object Identifier)";break;case D.Type.ODESC:n+=" (Object Descriptor)";break;case D.Type.EXTERNAL:n+=" (External or Instance of)";break;case D.Type.REAL:n+=" (Real)";break;case D.Type.ENUMERATED:n+=" (Enumerated)";break;case D.Type.EMBEDDED:n+=" (Embedded PDV)";break;case D.Type.UTF8:n+=" (UTF8)";break;case D.Type.ROID:n+=" (Relative Object Identifier)";break;case D.Type.SEQUENCE:n+=" (Sequence)";break;case D.Type.SET:n+=" (Set)";break;case D.Type.PRINTABLESTRING:n+=" (Printable String)";break;case D.Type.IA5String:n+=" (IA5String (ASCII))";break;case D.Type.UTCTIME:n+=" (UTC time)";break;case D.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case D.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var o=0,c="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(o+=1,c+=D.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(c+=","));n+=i+"Sub values: "+o+c}else{if(n+=i+"Value: ",t.type===D.Type.OID){var f=D.derToOid(t.value);n+=f,ue.pki&&ue.pki.oids&&f in ue.pki.oids&&(n+=" ("+ue.pki.oids[f]+") ")}if(t.type===D.Type.INTEGER)try{n+=D.derToInteger(t.value)}catch(a){n+="0x"+ue.util.bytesToHex(t.value)}else if(t.type===D.Type.BITSTRING){if(t.value.length>1?n+="0x"+ue.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var u=t.value.charCodeAt(0);u==1?n+=" (1 unused bit shown)":u>1&&(n+=" ("+u+" unused bits shown)")}}else t.type===D.Type.OCTETSTRING?(al.test(t.value)||(n+="("+t.value+") "),n+="0x"+ue.util.bytesToHex(t.value)):t.type===D.Type.UTF8?n+=ue.util.decodeUtf8(t.value):t.type===D.Type.PRINTABLESTRING||t.type===D.Type.IA5String?n+=t.value:al.test(t.value)?n+="0x"+ue.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var $a=m((E8,ul)=>{var Ae=W();me();ul.exports=Ae.cipher=Ae.cipher||{};Ae.cipher.algorithms=Ae.cipher.algorithms||{};Ae.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Ae.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Ae.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};Ae.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Ae.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Ae.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};Ae.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),Ae.cipher.algorithms[t]=e};Ae.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in Ae.cipher.algorithms?Ae.cipher.algorithms[t]:null};var Wa=Ae.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};Wa.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=Ae.util.createBuffer(),this.output=t.output||Ae.util.createBuffer(),this.mode.start(e)};Wa.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Wa.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Qa=m((_8,fl)=>{var Ce=W();me();Ce.cipher=Ce.cipher||{};var V=fl.exports=Ce.cipher.modes=Ce.cipher.modes||{};V.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};V.ecb.prototype.start=function(t){};V.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};V.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};V.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};V.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};V.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};V.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=Ns(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};V.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};V.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};V.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};V.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};V.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Ce.util.createBuffer(),this._partialBytes=0};V.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Ns(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};V.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};V.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};V.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Ce.util.createBuffer(),this._partialBytes=0};V.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Ns(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};V.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};V.ofb.prototype.decrypt=V.ofb.prototype.encrypt;V.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Ce.util.createBuffer(),this._partialBytes=0};V.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Ns(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};V.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}Ls(this._inBlock)};V.ctr.prototype.decrypt=V.ctr.prototype.encrypt;V.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Ce.util.createBuffer(),this._partialBytes=0,this._R=3774873600};V.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=Ce.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=Ce.util.createBuffer(t.additionalData):r=Ce.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=Ce.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Ya(n*8)))}this._inBlock=this._j0.slice(0),Ls(this._inBlock),this._partialBytes=0,r=Ce.util.createBuffer(r),this._aDataLength=Ya(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};V.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Ls(this._inBlock)};V.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Ls(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};V.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=Ce.util.createBuffer();var n=this._aDataLength.concat(Ya(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};V.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var s=t[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};V.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};V.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,s=this._m[r][i];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};V.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};V.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,s=new Array(i),o=0;o<i;++o){var c=[0,0,0,0],f=o/n|0,u=(n-1-o%n)*e;c[f]=1<<e-1<<u,s[o]=this.generateSubHashTable(this.multiply(c,t),e)}return s};V.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var o=1;o<s;++o){var c=i[s],f=i[o];i[s+o]=[c[0]^f[0],c[1]^f[1],c[2]^f[2],c[3]^f[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var u=i[s^n];i[s]=[t[0]^u[0],t[1]^u[1],t[2]^u[2],t[3]^u[3]]}return i};function Ns(t,e){if(typeof t=="string"&&(t=Ce.util.createBuffer(t)),Ce.util.isArray(t)&&t.length>4){var r=t;t=Ce.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!Ce.util.isArray(t)){for(var i=[],s=e/4,n=0;n<s;++n)i.push(t.getInt32());t=i}return t}function Ls(t){t[t.length-1]=t[t.length-1]+1&4294967295}function Ya(t){return[t/4294967296|0,t&4294967295]}});var ec=m((S8,dl)=>{var oe=W();$a();Qa();me();dl.exports=oe.aes=oe.aes||{};oe.aes.startEncrypting=function(t,e,r,n){var i=Ks({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};oe.aes.createEncryptionCipher=function(t,e){return Ks({key:t,output:null,decrypt:!1,mode:e})};oe.aes.startDecrypting=function(t,e,r,n){var i=Ks({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};oe.aes.createDecryptionCipher=function(t,e){return Ks({key:t,output:null,decrypt:!0,mode:e})};oe.aes.Algorithm=function(t,e){Ja||ll();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return Xa(r._w,n,i,!1)},decrypt:function(n,i){return Xa(r._w,n,i,!0)}}}),r._init=!1};oe.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=oe.util.createBuffer(e);else if(oe.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=oe.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!oe.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!oe.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=pl(e,t.decrypt&&!o),this._init=!0}};oe.aes._expandKey=function(t,e){return Ja||ll(),pl(t,e)};oe.aes._updateBlock=Xa;Rn("AES-ECB",oe.cipher.modes.ecb);Rn("AES-CBC",oe.cipher.modes.cbc);Rn("AES-CFB",oe.cipher.modes.cfb);Rn("AES-OFB",oe.cipher.modes.ofb);Rn("AES-CTR",oe.cipher.modes.ctr);Rn("AES-GCM",oe.cipher.modes.gcm);function Rn(t,e){var r=function(){return new oe.aes.Algorithm(t,e)};oe.cipher.registerAlgorithm(t,r)}var Ja=!1,Pn=4,je,Za,hl,en,mt;function ll(){Ja=!0,hl=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;je=new Array(256),Za=new Array(256),en=new Array(4),mt=new Array(4);for(var e=0;e<4;++e)en[e]=new Array(256),mt[e]=new Array(256);for(var r=0,n=0,i,s,o,c,f,u,a,e=0;e<256;++e){c=n^n<<1^n<<2^n<<3^n<<4,c=c>>8^c&255^99,je[r]=c,Za[c]=r,f=t[c],i=t[r],s=t[i],o=t[s],u=f<<24^c<<16^c<<8^(c^f),a=(i^s^o)<<24^(r^o)<<16^(r^s^o)<<8^(r^i^o);for(var h=0;h<4;++h)en[h][r]=u,mt[h][c]=a,u=u<<24|u>>>8,a=a<<24|a>>>8;r===0?r=n=1:(r=i^t[t[t[i^o]]],n^=t[t[n]])}}function pl(t,e){for(var r=t.slice(0),n,i=1,s=r.length,o=s+6+1,c=Pn*o,f=s;f<c;++f)n=r[f-1],f%s==0?(n=je[n>>>16&255]<<24^je[n>>>8&255]<<16^je[n&255]<<8^je[n>>>24]^hl[i]<<24,i++):s>6&&f%s==4&&(n=je[n>>>24]<<24^je[n>>>16&255]<<16^je[n>>>8&255]<<8^je[n&255]),r[f]=r[f-s]^n;if(e){var u,a=mt[0],h=mt[1],l=mt[2],d=mt[3],p=r.slice(0);c=r.length;for(var f=0,y=c-Pn;f<c;f+=Pn,y-=Pn)if(f===0||f===c-Pn)p[f]=r[y],p[f+1]=r[y+3],p[f+2]=r[y+2],p[f+3]=r[y+1];else for(var v=0;v<Pn;++v)u=r[y+v],p[f+(3&-v)]=a[je[u>>>24]]^h[je[u>>>16&255]]^l[je[u>>>8&255]]^d[je[u&255]];r=p}return r}function Xa(t,e,r,n){var i=t.length/4-1,s,o,c,f,u;n?(s=mt[0],o=mt[1],c=mt[2],f=mt[3],u=Za):(s=en[0],o=en[1],c=en[2],f=en[3],u=je);var a,h,l,d,p,y,v;a=e[0]^t[0],h=e[n?3:1]^t[1],l=e[2]^t[2],d=e[n?1:3]^t[3];for(var b=3,w=1;w<i;++w)p=s[a>>>24]^o[h>>>16&255]^c[l>>>8&255]^f[d&255]^t[++b],y=s[h>>>24]^o[l>>>16&255]^c[d>>>8&255]^f[a&255]^t[++b],v=s[l>>>24]^o[d>>>16&255]^c[a>>>8&255]^f[h&255]^t[++b],d=s[d>>>24]^o[a>>>16&255]^c[h>>>8&255]^f[l&255]^t[++b],a=p,h=y,l=v;r[0]=u[a>>>24]<<24^u[h>>>16&255]<<16^u[l>>>8&255]<<8^u[d&255]^t[++b],r[n?3:1]=u[h>>>24]<<24^u[l>>>16&255]<<16^u[d>>>8&255]<<8^u[a&255]^t[++b],r[2]=u[l>>>24]<<24^u[d>>>16&255]<<16^u[a>>>8&255]<<8^u[h&255]^t[++b],r[n?1:3]=u[d>>>24]<<24^u[a>>>16&255]<<16^u[h>>>8&255]<<8^u[l&255]^t[++b]}function Ks(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=oe.cipher.createDecipher(r,t.key):n=oe.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,o){var c=null;o instanceof oe.util.ByteBuffer&&(c=o,o={}),o=o||{},o.output=c,o.iv=s,i.call(n,o)},n}});var bl=m((I8,gl)=>{var fe=W();$a();Qa();me();gl.exports=fe.des=fe.des||{};fe.des.startEncrypting=function(t,e,r,n){var i=Ms({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};fe.des.createEncryptionCipher=function(t,e){return Ms({key:t,output:null,decrypt:!1,mode:e})};fe.des.startDecrypting=function(t,e,r,n){var i=Ms({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};fe.des.createDecryptionCipher=function(t,e){return Ms({key:t,output:null,decrypt:!0,mode:e})};fe.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return yl(r._keys,n,i,!1)},decrypt:function(n,i){return yl(r._keys,n,i,!0)}}}),r._init=!1};fe.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=fe.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=O2(e),this._init=!0}};Ot("DES-ECB",fe.cipher.modes.ecb);Ot("DES-CBC",fe.cipher.modes.cbc);Ot("DES-CFB",fe.cipher.modes.cfb);Ot("DES-OFB",fe.cipher.modes.ofb);Ot("DES-CTR",fe.cipher.modes.ctr);Ot("3DES-ECB",fe.cipher.modes.ecb);Ot("3DES-CBC",fe.cipher.modes.cbc);Ot("3DES-CFB",fe.cipher.modes.cfb);Ot("3DES-OFB",fe.cipher.modes.ofb);Ot("3DES-CTR",fe.cipher.modes.ctr);function Ot(t,e){var r=function(){return new fe.des.Algorithm(t,e)};fe.cipher.registerAlgorithm(t,r)}var I2=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],A2=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],C2=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],B2=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],T2=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],R2=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],P2=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],D2=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function O2(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],c=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],a=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],y=t.length()>8?3:1,v=[],b=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],w=0,I,P=0;P<y;P++){var T=t.getInt32(),S=t.getInt32();I=(T>>>4^S)&252645135,S^=I,T^=I<<4,I=(S>>>-16^T)&65535,T^=I,S^=I<<-16,I=(T>>>2^S)&858993459,S^=I,T^=I<<2,I=(S>>>-16^T)&65535,T^=I,S^=I<<-16,I=(T>>>1^S)&1431655765,S^=I,T^=I<<1,I=(S>>>8^T)&16711935,T^=I,S^=I<<8,I=(T>>>1^S)&1431655765,S^=I,T^=I<<1,I=T<<8|S>>>20&240,T=S<<24|S<<8&16711680|S>>>8&65280|S>>>24&240,S=I;for(var K=0;K<b.length;++K){b[K]?(T=T<<2|T>>>26,S=S<<2|S>>>26):(T=T<<1|T>>>27,S=S<<1|S>>>27),T&=-15,S&=-15;var U=e[T>>>28]|r[T>>>24&15]|n[T>>>20&15]|i[T>>>16&15]|s[T>>>12&15]|o[T>>>8&15]|c[T>>>4&15],ye=f[S>>>28]|u[S>>>24&15]|a[S>>>20&15]|h[S>>>16&15]|l[S>>>12&15]|d[S>>>8&15]|p[S>>>4&15];I=(ye>>>16^U)&65535,v[w++]=U^I,v[w++]=ye^I<<16}}return v}function yl(t,e,r,n){var i=t.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,c=e[0],f=e[1];o=(c>>>4^f)&252645135,f^=o,c^=o<<4,o=(c>>>16^f)&65535,f^=o,c^=o<<16,o=(f>>>2^c)&858993459,c^=o,f^=o<<2,o=(f>>>8^c)&16711935,c^=o,f^=o<<8,o=(c>>>1^f)&1431655765,f^=o,c^=o<<1,c=c<<1|c>>>31,f=f<<1|f>>>31;for(var u=0;u<i;u+=3){for(var a=s[u+1],h=s[u+2],l=s[u];l!=a;l+=h){var d=f^t[l],p=(f>>>4|f<<28)^t[l+1];o=c,c=f,f=o^(A2[d>>>24&63]|B2[d>>>16&63]|R2[d>>>8&63]|D2[d&63]|I2[p>>>24&63]|C2[p>>>16&63]|T2[p>>>8&63]|P2[p&63])}o=c,c=f,f=o}c=c>>>1|c<<31,f=f>>>1|f<<31,o=(c>>>1^f)&1431655765,f^=o,c^=o<<1,o=(f>>>8^c)&16711935,c^=o,f^=o<<8,o=(f>>>2^c)&858993459,c^=o,f^=o<<2,o=(c>>>16^f)&65535,f^=o,c^=o<<16,o=(c>>>4^f)&252645135,f^=o,c^=o<<4,r[0]=c,r[1]=f}function Ms(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=fe.cipher.createDecipher(r,t.key):n=fe.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,o){var c=null;o instanceof fe.util.ByteBuffer&&(c=o,o={}),o=o||{},o.output=c,o.iv=s,i.call(n,o)},n}});var tn=m((A8,vl)=>{var qs=W();vl.exports=qs.md=qs.md||{};qs.md.algorithms=qs.md.algorithms||{}});var xl=m((C8,ml)=>{var Zt=W();tn();me();var k2=ml.exports=Zt.hmac=Zt.hmac||{};k2.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Zt.md.algorithms)e=Zt.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(o===null)o=t;else{if(typeof o=="string")o=Zt.util.createBuffer(o);else if(Zt.util.isArray(o)){var c=o;o=Zt.util.createBuffer();for(var f=0;f<c.length;++f)o.putByte(c[f])}var u=o.length();u>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),r=Zt.util.createBuffer(),n=Zt.util.createBuffer(),u=o.length();for(var f=0;f<u;++f){var c=o.at(f);r.putByte(54^c),n.putByte(92^c)}if(u<e.blockLength)for(var c=e.blockLength-u,f=0;f<c;++f)r.putByte(54),n.putByte(92);t=o,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(s){e.update(s)},i.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(n),e.update(s),e.digest()},i.digest=i.getMac,i}});var Dn=m(()=>{});var El=m((R8,wl)=>{var He=W();xl();tn();me();var N2=He.pkcs5=He.pkcs5||{},Xt;He.util.isNodejs&&!He.options.usePureJavaScript&&(Xt=Dn());wl.exports=He.pbkdf2=N2.pbkdf2=function(t,e,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),He.util.isNodejs&&!He.options.usePureJavaScript&&Xt.pbkdf2&&(i===null||typeof i!="object")&&(Xt.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?Xt.pbkdf2Sync.length===4?Xt.pbkdf2(t,e,r,n,function(I,P){if(I)return s(I);s(null,P.toString("binary"))}):Xt.pbkdf2(t,e,r,n,i,function(I,P){if(I)return s(I);s(null,P.toString("binary"))}):Xt.pbkdf2Sync.length===4?Xt.pbkdf2Sync(t,e,r,n).toString("binary"):Xt.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i=="undefined"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in He.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=He.md[i].create()}var o=i.digestLength;if(n>4294967295*o){var c=new Error("Derived key is too long.");if(s)return s(c);throw c}var f=Math.ceil(n/o),u=n-(f-1)*o,a=He.hmac.create();a.start(i,t);var h="",l,d,p;if(!s){for(var y=1;y<=f;++y){a.start(null,null),a.update(e),a.update(He.util.int32ToBytes(y)),l=p=a.digest().getBytes();for(var v=2;v<=r;++v)a.start(null,null),a.update(p),d=a.digest().getBytes(),l=He.util.xorBytes(l,d,o),p=d;h+=y<f?l:l.substr(0,u)}return h}var y=1,v;function b(){if(y>f)return s(null,h);a.start(null,null),a.update(e),a.update(He.util.int32ToBytes(y)),l=p=a.digest().getBytes(),v=2,w()}function w(){if(v<=r)return a.start(null,null),a.update(p),d=a.digest().getBytes(),l=He.util.xorBytes(l,d,o),p=d,++v,He.util.setImmediate(w);h+=y<f?l:l.substr(0,u),++y,b()}b()}});var Il=m((P8,Sl)=>{var Fs=W();me();var _l=Sl.exports=Fs.pem=Fs.pem||{};_l.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=Us(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=Us(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=Us(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=Us(t.headers[i]);return t.procType&&(r+=`\r
`),r+=Fs.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};_l.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(t),!!s;){var o={type:s[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:Fs.util.decode64(s[3])};if(e.push(o),!!s[2]){for(var c=s[2].split(i),f=0;s&&f<c.length;){for(var u=c[f].replace(/\s+$/,""),a=f+1;a<c.length;++a){var h=c[a];if(!/\s/.test(h[0]))break;u+=h,f=a}if(s=u.match(n),s){for(var l={name:s[1],values:[]},d=s[2].split(","),p=0;p<d.length;++p)l.values.push(L2(d[p]));if(o.procType)if(!o.contentDomain&&l.name==="Content-Domain")o.contentDomain=d[0]||"";else if(!o.dekInfo&&l.name==="DEK-Info"){if(l.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:d[0],parameters:d[1]||null}}else o.headers.push(l);else{if(l.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(l.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:d[0],type:d[1]}}}++f}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function Us(t){for(var e=t.name+": ",r=[],n=function(f,u){return" "+u},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var s=0,o=-1,i=0;i<e.length;++i,++s)if(s>65&&o!==-1){var c=e[o];c===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+c+e.substr(o+1),s=i-o-1,o=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(o=i);return e}function L2(t){return t.replace(/^\s+/,"")}});var Pl=m((D8,Rl)=>{var kt=W();tn();me();var Al=Rl.exports=kt.sha256=kt.sha256||{};kt.md.sha256=kt.md.algorithms.sha256=Al;Al.create=function(){Cl||K2();var t=null,e=kt.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=kt.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=kt.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var c=n.fullMessageLength.length-1;c>=0;--c)n.fullMessageLength[c]+=o[1],o[1]=o[0]+(n.fullMessageLength[c]/4294967296>>>0),n.fullMessageLength[c]=n.fullMessageLength[c]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),Tl(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=kt.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(tc.substr(0,n.blockLength-o));for(var c,f,u=n.fullMessageLength[0]*8,a=0;a<n.fullMessageLength.length-1;++a)c=n.fullMessageLength[a+1]*8,f=c/4294967296>>>0,u+=f,i.putInt32(u>>>0),u=c>>>0;i.putInt32(u);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};Tl(h,r,i);var l=kt.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var tc=null,Cl=!1,Bl=null;function K2(){tc=String.fromCharCode(128),tc+=kt.util.fillString(String.fromCharCode(0),64),Bl=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Cl=!0}function Tl(t,e,r){for(var n,i,s,o,c,f,u,a,h,l,d,p,y,v,b,w=r.length();w>=64;){for(u=0;u<16;++u)e[u]=r.getInt32();for(;u<64;++u)n=e[u-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[u-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[u]=n+e[u-7]+i+e[u-16]|0;for(a=t.h0,h=t.h1,l=t.h2,d=t.h3,p=t.h4,y=t.h5,v=t.h6,b=t.h7,u=0;u<64;++u)o=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),c=v^p&(y^v),s=(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10),f=a&h|l&(a^h),n=b+o+c+Bl[u]+e[u],i=s+f,b=v,v=y,y=p,p=d+n>>>0,d=l,l=h,h=a,a=n+i>>>0;t.h0=t.h0+a|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+d|0,t.h4=t.h4+p|0,t.h5=t.h5+y|0,t.h6=t.h6+v|0,t.h7=t.h7+b|0,w-=64}}});var Ol=m((O8,Dl)=>{var Nt=W();me();var Gs=null;Nt.util.isNodejs&&!Nt.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Gs=Dn());var M2=Dl.exports=Nt.prng=Nt.prng||{};M2.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(u,a){if(!a)return e.generateSync(u);var h=e.plugin.cipher,l=e.plugin.increment,d=e.plugin.formatKey,p=e.plugin.formatSeed,y=Nt.util.createBuffer();e.key=null,v();function v(b){if(b)return a(b);if(y.length()>=u)return a(null,y.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return Nt.util.nextTick(function(){s(v)});var w=h(e.key,e.seed);e.generated+=w.length,y.putBytes(w),e.key=d(h(e.key,l(e.seed))),e.seed=p(h(e.key,e.seed)),Nt.util.setImmediate(v)}},e.generateSync=function(u){var a=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,d=e.plugin.formatSeed;e.key=null;for(var p=Nt.util.createBuffer();p.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&o();var y=a(e.key,e.seed);e.generated+=y.length,p.putBytes(y),e.key=l(a(e.key,h(e.seed))),e.seed=d(a(e.key,e.seed))}return p.getBytes(u)};function s(u){if(e.pools[0].messageLength>=32)return c(),u();var a=32-e.pools[0].messageLength<<5;e.seedFile(a,function(h,l){if(h)return u(h);e.collect(l),c(),u()})}function o(){if(e.pools[0].messageLength>=32)return c();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),c()}function c(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var a=1,h=0;h<32;++h)e.reseeds%a==0&&(u.update(e.pools[h].digest().getBytes()),e.pools[h].start()),a=a<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var l=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function f(u){var a=null,h=Nt.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(a=function(T){return l.getRandomValues(T)});var d=Nt.util.createBuffer();if(a)for(;d.length()<u;){var p=Math.max(1,Math.min(u-d.length(),65536)/4),y=new Uint32Array(Math.floor(p));try{a(y);for(var v=0;v<y.length;++v)d.putInt32(y[v])}catch(T){if(!(typeof QuotaExceededError!="undefined"&&T instanceof QuotaExceededError))throw T}}if(d.length()<u)for(var b,w,I,P=Math.floor(Math.random()*65536);d.length()<u;){w=16807*(P&65535),b=16807*(P>>16),w+=(b&32767)<<16,w+=b>>15,w=(w&2147483647)+(w>>31),P=w&4294967295;for(var v=0;v<3;++v)I=P>>>(v<<3),I^=Math.floor(Math.random()*256),d.putByte(String.fromCharCode(I&255))}return d.getBytes(u)}return Gs?(e.seedFile=function(u,a){Gs.randomBytes(u,function(h,l){if(h)return a(h);a(null,l.toString())})},e.seedFileSync=function(u){return Gs.randomBytes(u).toString()}):(e.seedFile=function(u,a){try{a(null,f(u))}catch(h){a(h)}},e.seedFileSync=f),e.collect=function(u){for(var a=u.length,h=0;h<a;++h)e.pools[e.pool].update(u.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,a){for(var h="",l=0;l<a;l+=8)h+=String.fromCharCode(u>>l&255);e.collect(h)},e.registerWorker=function(u){if(u===self)e.seedFile=function(h,l){function d(p){var y=p.data;y.forge&&y.forge.prng&&(self.removeEventListener("message",d),l(y.forge.prng.err,y.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:h}}})};else{var a=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(d,p){u.postMessage({forge:{prng:{err:d,bytes:p}}})})};u.addEventListener("message",a)}},e}});var gi=m((k8,rc)=>{var Be=W();ec();Pl();Ol();me();(function(){if(Be.random&&Be.random.getBytes){rc.exports=Be.random;return}(function(t){var e={},r=new Array(4),n=Be.util.createBuffer();e.formatKey=function(h){var l=Be.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),Be.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=Be.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return Be.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=Be.md.sha256;function i(){var h=Be.prng.create(e);return h.getBytes=function(l,d){return h.generate(l,d)},h.getBytesSync=function(l){return h.generate(l)},h}var s=i(),o=null,c=Be.util.globalScope,f=c.crypto||c.msCrypto;if(f&&f.getRandomValues&&(o=function(h){return f.getRandomValues(h)}),Be.options.usePureJavaScript||!Be.util.isNodejs&&!o){if(typeof window=="undefined"||window.document===void 0,s.collectInt(+new Date,32),typeof navigator!="undefined"){var u="";for(var a in navigator)try{typeof navigator[a]=="string"&&(u+=navigator[a])}catch(h){}s.collect(u),u=null}t&&(t().mousemove(function(h){s.collectInt(h.clientX,16),s.collectInt(h.clientY,16)}),t().keypress(function(h){s.collectInt(h.charCode,8)}))}if(!Be.random)Be.random=s;else for(var a in s)Be.random[a]=s[a];Be.random.createInstance=i,rc.exports=Be.random})(typeof jQuery!="undefined"?jQuery:null)})()});var Kl=m((N8,Ll)=>{var Qe=W();me();var nc=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],kl=[1,2,3,5],q2=function(t,e){return t<<e&65535|(t&65535)>>16-e},F2=function(t,e){return(t&65535)>>e|t<<16-e&65535};Ll.exports=Qe.rc2=Qe.rc2||{};Qe.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Qe.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,s=Math.ceil(i/8),o=255>>(i&7),c;for(c=n;c<128;c++)r.putByte(nc[r.at(c-1)+r.at(c-n)&255]);for(r.setAt(128-s,nc[r.at(128-s)&o]),c=127-s;c>=0;c--)r.setAt(c,nc[r.at(c+1)^r.at(c+s)]);return r};var Nl=function(t,e,r){var n=!1,i=null,s=null,o=null,c,f,u,a,h=[];for(t=Qe.rc2.expandKey(t,e),u=0;u<64;u++)h.push(t.getInt16Le());r?(c=function(p){for(u=0;u<4;u++)p[u]+=h[a]+(p[(u+3)%4]&p[(u+2)%4])+(~p[(u+3)%4]&p[(u+1)%4]),p[u]=q2(p[u],kl[u]),a++},f=function(p){for(u=0;u<4;u++)p[u]+=h[p[(u+3)%4]&63]}):(c=function(p){for(u=3;u>=0;u--)p[u]=F2(p[u],kl[u]),p[u]-=h[a]+(p[(u+3)%4]&p[(u+2)%4])+(~p[(u+3)%4]&p[(u+1)%4]),a--},f=function(p){for(u=3;u>=0;u--)p[u]-=h[p[(u+3)%4]&63]});var l=function(p){var y=[];for(u=0;u<4;u++){var v=i.getInt16Le();o!==null&&(r?v^=o.getInt16Le():o.putInt16Le(v)),y.push(v&65535)}a=r?0:63;for(var b=0;b<p.length;b++)for(var w=0;w<p[b][0];w++)p[b][1](y);for(u=0;u<4;u++)o!==null&&(r?o.putInt16Le(y[u]):y[u]^=o.getInt16Le()),s.putInt16Le(y[u])},d=null;return d={start:function(p,y){p&&typeof p=="string"&&(p=Qe.util.createBuffer(p)),n=!1,i=Qe.util.createBuffer(),s=y||new Qe.util.createBuffer,o=p,d.output=s},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,c],[1,f],[6,c],[1,f],[5,c]])},finish:function(p){var y=!0;if(r)if(p)y=p(8,i,!r);else{var v=i.length()===8?8:8-i.length();i.fillWithByte(v,v)}if(y&&(n=!0,d.update()),!r&&(y=i.length()===0,y))if(p)y=p(8,s,!r);else{var b=s.length(),w=s.at(b-1);w>b?y=!1:s.truncate(w)}return y}},d};Qe.rc2.startEncrypting=function(t,e,r){var n=Qe.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};Qe.rc2.createEncryptionCipher=function(t,e){return Nl(t,e,!0)};Qe.rc2.startDecrypting=function(t,e,r){var n=Qe.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};Qe.rc2.createDecryptionCipher=function(t,e){return Nl(t,e,!1)}});var vi=m((L8,Hl)=>{var ic=W();Hl.exports=ic.jsbn=ic.jsbn||{};var er,U2=244837814094590,Ml=(U2&16777215)==15715070;function A(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}ic.jsbn.BigInteger=A;function $(){return new A(null)}function G2(t,e,r,n,i,s){for(;--s>=0;){var o=e*this.data[t++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=o&67108863}return i}function V2(t,e,r,n,i,s){for(var o=e&32767,c=e>>15;--s>=0;){var f=this.data[t]&32767,u=this.data[t++]>>15,a=c*f+u*o;f=o*f+((a&32767)<<15)+r.data[n]+(i&1073741823),i=(f>>>30)+(a>>>15)+c*u+(i>>>30),r.data[n++]=f&1073741823}return i}function ql(t,e,r,n,i,s){for(var o=e&16383,c=e>>14;--s>=0;){var f=this.data[t]&16383,u=this.data[t++]>>14,a=c*f+u*o;f=o*f+((a&16383)<<14)+r.data[n]+i,i=(f>>28)+(a>>14)+c*u,r.data[n++]=f&268435455}return i}typeof navigator=="undefined"?(A.prototype.am=ql,er=28):Ml&&navigator.appName=="Microsoft Internet Explorer"?(A.prototype.am=V2,er=30):Ml&&navigator.appName!="Netscape"?(A.prototype.am=G2,er=26):(A.prototype.am=ql,er=28);A.prototype.DB=er;A.prototype.DM=(1<<er)-1;A.prototype.DV=1<<er;var sc=52;A.prototype.FV=Math.pow(2,sc);A.prototype.F1=sc-er;A.prototype.F2=2*er-sc;var j2="0123456789abcdefghijklmnopqrstuvwxyz",Vs=new Array,On,st;On="0".charCodeAt(0);for(st=0;st<=9;++st)Vs[On++]=st;On="a".charCodeAt(0);for(st=10;st<36;++st)Vs[On++]=st;On="A".charCodeAt(0);for(st=10;st<36;++st)Vs[On++]=st;function Fl(t){return j2.charAt(t)}function Ul(t,e){var r=Vs[t.charCodeAt(e)];return r??-1}function H2(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function z2(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function _r(t){var e=$();return e.fromInt(t),e}function W2(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,s=0;--n>=0;){var o=r==8?t[n]&255:Ul(t,n);if(o<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&(t[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&A.ZERO.subTo(this,this)}function $2(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function Y2(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,s="",o=this.t,c=this.DB-o*this.DB%e;if(o-- >0)for(c<this.DB&&(n=this.data[o]>>c)>0&&(i=!0,s=Fl(n));o>=0;)c<e?(n=(this.data[o]&(1<<c)-1)<<e-c,n|=this.data[--o]>>(c+=this.DB-e)):(n=this.data[o]>>(c-=e)&r,c<=0&&(c+=this.DB,--o)),n>0&&(i=!0),i&&(s+=Fl(n));return i?s:"0"}function Q2(){var t=$();return A.ZERO.subTo(this,t),t}function J2(){return this.s<0?this.negate():this}function Z2(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function js(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function X2(){return this.t<=0?0:this.DB*(this.t-1)+js(this.data[this.t-1]^this.s&this.DM)}function em(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function tm(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function rm(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(t/this.DB),o=this.s<<r&this.DM,c;for(c=this.t-1;c>=0;--c)e.data[c+s+1]=this.data[c]>>n|o,o=(this.data[c]&i)<<r;for(c=s-1;c>=0;--c)e.data[c]=0;e.data[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function nm(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,s=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)e.data[o-r-1]|=(this.data[o]&s)<<i,e.data[o-r]=this.data[o]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&s)<<i),e.t=this.t-r,e.clamp()}function im(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function sm(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&A.ZERO.subTo(e,e)}function om(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function am(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e!=null&&e.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=$());var s=$(),o=this.s,c=t.s,f=this.DB-js(n.data[n.t-1]);f>0?(n.lShiftTo(f,s),i.lShiftTo(f,r)):(n.copyTo(s),i.copyTo(r));var u=s.t,a=s.data[u-1];if(a!=0){var h=a*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),l=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,y=r.t,v=y-u,b=e??$();for(s.dlShiftTo(v,b),r.compareTo(b)>=0&&(r.data[r.t++]=1,r.subTo(b,r)),A.ONE.dlShiftTo(u,b),b.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--v>=0;){var w=r.data[--y]==a?this.DM:Math.floor(r.data[y]*l+(r.data[y-1]+p)*d);if((r.data[y]+=s.am(0,w,r,v,0,u))<w)for(s.dlShiftTo(v,b),r.subTo(b,r);r.data[y]<--w;)r.subTo(b,r)}e!=null&&(r.drShiftTo(u,e),o!=c&&A.ZERO.subTo(e,e)),r.t=u,r.clamp(),f>0&&r.rShiftTo(f,r),o<0&&A.ZERO.subTo(r,r)}}}function cm(t){var e=$();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(A.ZERO)>0&&t.subTo(e,e),e}function rn(t){this.m=t}function um(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function fm(t){return t}function hm(t){t.divRemTo(this.m,null,t)}function lm(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function pm(t,e){t.squareTo(e),this.reduce(e)}rn.prototype.convert=um;rn.prototype.revert=fm;rn.prototype.reduce=hm;rn.prototype.mulTo=lm;rn.prototype.sqrTo=pm;function dm(){if(this.t<1)return 0;var t=this.data[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function nn(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function ym(t){var e=$();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(A.ZERO)>0&&this.m.subTo(e,e),e}function gm(t){var e=$();return t.copyTo(e),this.reduce(e),e}function bm(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function vm(t,e){t.squareTo(e),this.reduce(e)}function mm(t,e,r){t.multiplyTo(e,r),this.reduce(r)}nn.prototype.convert=ym;nn.prototype.revert=gm;nn.prototype.reduce=bm;nn.prototype.mulTo=mm;nn.prototype.sqrTo=vm;function xm(){return(this.t>0?this.data[0]&1:this.s)==0}function wm(t,e){if(t>4294967295||t<1)return A.ONE;var r=$(),n=$(),i=e.convert(this),s=js(t)-1;for(i.copyTo(r);--s>=0;)if(e.sqrTo(r,n),(t&1<<s)>0)e.mulTo(n,i,r);else{var o=r;r=n,n=o}return e.revert(r)}function Em(t,e){var r;return t<256||e.isEven()?r=new rn(e):r=new nn(e),this.exp(t,r)}A.prototype.copyTo=H2;A.prototype.fromInt=z2;A.prototype.fromString=W2;A.prototype.clamp=$2;A.prototype.dlShiftTo=em;A.prototype.drShiftTo=tm;A.prototype.lShiftTo=rm;A.prototype.rShiftTo=nm;A.prototype.subTo=im;A.prototype.multiplyTo=sm;A.prototype.squareTo=om;A.prototype.divRemTo=am;A.prototype.invDigit=dm;A.prototype.isEven=xm;A.prototype.exp=wm;A.prototype.toString=Y2;A.prototype.negate=Q2;A.prototype.abs=J2;A.prototype.compareTo=Z2;A.prototype.bitLength=X2;A.prototype.mod=cm;A.prototype.modPowInt=Em;A.ZERO=_r(0);A.ONE=_r(1);function _m(){var t=$();return this.copyTo(t),t}function Sm(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Im(){return this.t==0?this.s:this.data[0]<<24>>24}function Am(){return this.t==0?this.s:this.data[0]<<16>>16}function Cm(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function Bm(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Tm(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=_r(r),i=$(),s=$(),o="";for(this.divRemTo(n,i,s);i.signum()>0;)o=(r+s.intValue()).toString(t).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(t)+o}function Rm(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,s=0,o=0,c=0;c<t.length;++c){var f=Ul(t,c);if(f<0){t.charAt(c)=="-"&&this.signum()==0&&(i=!0);continue}o=e*o+f,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),i&&A.ZERO.subTo(this,this)}function Pm(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(A.ONE.shiftLeft(t-1),oc,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(A.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function Dm(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),(n&128)!=0&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function Om(t){return this.compareTo(t)==0}function km(t){return this.compareTo(t)<0?this:t}function Nm(t){return this.compareTo(t)>0?this:t}function Lm(t,e,r){var n,i,s=Math.min(t.t,this.t);for(n=0;n<s;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=s;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function Km(t,e){return t&e}function Mm(t){var e=$();return this.bitwiseTo(t,Km,e),e}function oc(t,e){return t|e}function qm(t){var e=$();return this.bitwiseTo(t,oc,e),e}function Gl(t,e){return t^e}function Fm(t){var e=$();return this.bitwiseTo(t,Gl,e),e}function Vl(t,e){return t&~e}function Um(t){var e=$();return this.bitwiseTo(t,Vl,e),e}function Gm(){for(var t=$(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function Vm(t){var e=$();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function jm(t){var e=$();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function Hm(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}function zm(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+Hm(this.data[t]);return this.s<0?this.t*this.DB:-1}function Wm(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function $m(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=Wm(this.data[r]^e);return t}function Ym(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function Qm(t,e){var r=A.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function Jm(t){return this.changeBit(t,oc)}function Zm(t){return this.changeBit(t,Vl)}function Xm(t){return this.changeBit(t,Gl)}function ex(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function tx(t){var e=$();return this.addTo(t,e),e}function rx(t){var e=$();return this.subTo(t,e),e}function nx(t){var e=$();return this.multiplyTo(t,e),e}function ix(t){var e=$();return this.divRemTo(t,e,null),e}function sx(t){var e=$();return this.divRemTo(t,null,e),e}function ox(t){var e=$(),r=$();return this.divRemTo(t,e,r),new Array(e,r)}function ax(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function cx(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function bi(){}function jl(t){return t}function ux(t,e,r){t.multiplyTo(e,r)}function fx(t,e){t.squareTo(e)}bi.prototype.convert=jl;bi.prototype.revert=jl;bi.prototype.mulTo=ux;bi.prototype.sqrTo=fx;function hx(t){return this.exp(t,new bi)}function lx(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function px(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function kn(t){this.r2=$(),this.q3=$(),A.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function dx(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=$();return t.copyTo(e),this.reduce(e),e}function yx(t){return t}function gx(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function bx(t,e){t.squareTo(e),this.reduce(e)}function vx(t,e,r){t.multiplyTo(e,r),this.reduce(r)}kn.prototype.convert=dx;kn.prototype.revert=yx;kn.prototype.reduce=gx;kn.prototype.mulTo=vx;kn.prototype.sqrTo=bx;function mx(t,e){var r=t.bitLength(),n,i=_r(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new rn(e):e.isEven()?s=new kn(e):s=new nn(e);var o=new Array,c=3,f=n-1,u=(1<<n)-1;if(o[1]=s.convert(this),n>1){var a=$();for(s.sqrTo(o[1],a);c<=u;)o[c]=$(),s.mulTo(a,o[c-2],o[c]),c+=2}var h=t.t-1,l,d=!0,p=$(),y;for(r=js(t.data[h])-1;h>=0;){for(r>=f?l=t.data[h]>>r-f&u:(l=(t.data[h]&(1<<r+1)-1)<<f-r,h>0&&(l|=t.data[h-1]>>this.DB+r-f)),c=n;(l&1)==0;)l>>=1,--c;if((r-=c)<0&&(r+=this.DB,--h),d)o[l].copyTo(i),d=!1;else{for(;c>1;)s.sqrTo(i,p),s.sqrTo(p,i),c-=2;c>0?s.sqrTo(i,p):(y=i,i=p,p=y),s.mulTo(p,o[l],i)}for(;h>=0&&(t.data[h]&1<<r)==0;)s.sqrTo(i,p),y=i,i=p,p=y,--r<0&&(r=this.DB-1,--h)}return s.revert(i)}function xx(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(i<s&&(s=i),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function wx(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function Ex(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return A.ZERO;for(var r=t.clone(),n=this.clone(),i=_r(1),s=_r(0),o=_r(0),c=_r(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(t,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?((!o.isEven()||!c.isEven())&&(o.addTo(this,o),c.subTo(t,c)),o.rShiftTo(1,o)):c.isEven()||c.subTo(t,c),c.rShiftTo(1,c);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(o,i),s.subTo(c,s)):(n.subTo(r,n),e&&o.subTo(i,o),c.subTo(s,c))}if(n.compareTo(A.ONE)!=0)return A.ZERO;if(c.compareTo(t)>=0)return c.subtract(t);if(c.signum()<0)c.addTo(t,c);else return c;return c.signum()<0?c.add(t):c}var xt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],_x=(1<<26)/xt[xt.length-1];function Sx(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=xt[xt.length-1]){for(e=0;e<xt.length;++e)if(r.data[0]==xt[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<xt.length;){for(var n=xt[e],i=e+1;i<xt.length&&n<_x;)n*=xt[i++];for(n=r.modInt(n);e<i;)if(n%xt[e++]==0)return!1}return r.millerRabin(t)}function Ix(t){var e=this.subtract(A.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=Ax(),s,o=0;o<t;++o){do s=new A(this.bitLength(),i);while(s.compareTo(A.ONE)<=0||s.compareTo(e)>=0);var c=s.modPow(n,this);if(c.compareTo(A.ONE)!=0&&c.compareTo(e)!=0){for(var f=1;f++<r&&c.compareTo(e)!=0;)if(c=c.modPowInt(2,this),c.compareTo(A.ONE)==0)return!1;if(c.compareTo(e)!=0)return!1}}return!0}function Ax(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}A.prototype.chunkSize=Cm;A.prototype.toRadix=Tm;A.prototype.fromRadix=Rm;A.prototype.fromNumber=Pm;A.prototype.bitwiseTo=Lm;A.prototype.changeBit=Qm;A.prototype.addTo=ex;A.prototype.dMultiply=ax;A.prototype.dAddOffset=cx;A.prototype.multiplyLowerTo=lx;A.prototype.multiplyUpperTo=px;A.prototype.modInt=wx;A.prototype.millerRabin=Ix;A.prototype.clone=_m;A.prototype.intValue=Sm;A.prototype.byteValue=Im;A.prototype.shortValue=Am;A.prototype.signum=Bm;A.prototype.toByteArray=Dm;A.prototype.equals=Om;A.prototype.min=km;A.prototype.max=Nm;A.prototype.and=Mm;A.prototype.or=qm;A.prototype.xor=Fm;A.prototype.andNot=Um;A.prototype.not=Gm;A.prototype.shiftLeft=Vm;A.prototype.shiftRight=jm;A.prototype.getLowestSetBit=zm;A.prototype.bitCount=$m;A.prototype.testBit=Ym;A.prototype.setBit=Jm;A.prototype.clearBit=Zm;A.prototype.flipBit=Xm;A.prototype.add=tx;A.prototype.subtract=rx;A.prototype.multiply=nx;A.prototype.divide=ix;A.prototype.remainder=sx;A.prototype.divideAndRemainder=ox;A.prototype.modPow=mx;A.prototype.modInverse=Ex;A.prototype.pow=hx;A.prototype.gcd=xx;A.prototype.isProbablePrime=Sx});var Ql=m((K8,Yl)=>{var Lt=W();tn();me();var zl=Yl.exports=Lt.sha1=Lt.sha1||{};Lt.md.sha1=Lt.md.algorithms.sha1=zl;zl.create=function(){Wl||Cx();var t=null,e=Lt.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=Lt.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=Lt.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var c=n.fullMessageLength.length-1;c>=0;--c)n.fullMessageLength[c]+=o[1],o[1]=o[0]+(n.fullMessageLength[c]/4294967296>>>0),n.fullMessageLength[c]=n.fullMessageLength[c]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),$l(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=Lt.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(ac.substr(0,n.blockLength-o));for(var c,f,u=n.fullMessageLength[0]*8,a=0;a<n.fullMessageLength.length-1;++a)c=n.fullMessageLength[a+1]*8,f=c/4294967296>>>0,u+=f,i.putInt32(u>>>0),u=c>>>0;i.putInt32(u);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};$l(h,r,i);var l=Lt.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var ac=null,Wl=!1;function Cx(){ac=String.fromCharCode(128),ac+=Lt.util.fillString(String.fromCharCode(0),64),Wl=!0}function $l(t,e,r){for(var n,i,s,o,c,f,u,a,h=r.length();h>=64;){for(i=t.h0,s=t.h1,o=t.h2,c=t.h3,f=t.h4,a=0;a<16;++a)n=r.getInt32(),e[a]=n,u=c^s&(o^c),n=(i<<5|i>>>27)+u+f+1518500249+n,f=c,c=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;a<20;++a)n=e[a-3]^e[a-8]^e[a-14]^e[a-16],n=n<<1|n>>>31,e[a]=n,u=c^s&(o^c),n=(i<<5|i>>>27)+u+f+1518500249+n,f=c,c=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;a<32;++a)n=e[a-3]^e[a-8]^e[a-14]^e[a-16],n=n<<1|n>>>31,e[a]=n,u=s^o^c,n=(i<<5|i>>>27)+u+f+1859775393+n,f=c,c=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;a<40;++a)n=e[a-6]^e[a-16]^e[a-28]^e[a-32],n=n<<2|n>>>30,e[a]=n,u=s^o^c,n=(i<<5|i>>>27)+u+f+1859775393+n,f=c,c=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;a<60;++a)n=e[a-6]^e[a-16]^e[a-28]^e[a-32],n=n<<2|n>>>30,e[a]=n,u=s&o|c&(s^o),n=(i<<5|i>>>27)+u+f+2400959708+n,f=c,c=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;a<80;++a)n=e[a-6]^e[a-16]^e[a-28]^e[a-32],n=n<<2|n>>>30,e[a]=n,u=s^o^c,n=(i<<5|i>>>27)+u+f+3395469782+n,f=c,c=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+s|0,t.h2=t.h2+o|0,t.h3=t.h3+c|0,t.h4=t.h4+f|0,h-=64}}});var Xl=m((M8,Zl)=>{var Kt=W();me();gi();Ql();var Jl=Zl.exports=Kt.pkcs1=Kt.pkcs1||{};Jl.encode_rsa_oaep=function(t,e,r){var n,i,s,o;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),s?s.start():s=Kt.md.sha1.create(),o||(o=s);var c=Math.ceil(t.n.bitLength()/8),f=c-2*s.digestLength-2;if(e.length>f){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=f,u}n||(n=""),s.update(n,"raw");for(var a=s.digest(),h="",l=f-e.length,d=0;d<l;d++)h+="\0";var p=a.getBytes()+h+""+e;if(!i)i=Kt.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=i.length,u.digestLength=s.digestLength,u}var y=Hs(i,c-s.digestLength-1,o),v=Kt.util.xorBytes(p,y,p.length),b=Hs(v,s.digestLength,o),w=Kt.util.xorBytes(i,b,i.length);return"\0"+w+v};Jl.decode_rsa_oaep=function(t,e,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var v=new Error("RSAES-OAEP encoded message length is invalid.");throw v.length=e.length,v.expectedLength=o,v}if(i===void 0?i=Kt.md.sha1.create():i.start(),s||(s=i),o<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var c=i.digest().getBytes(),f=e.charAt(0),u=e.substring(1,i.digestLength+1),a=e.substring(1+i.digestLength),h=Hs(a,i.digestLength,s),l=Kt.util.xorBytes(u,h,u.length),d=Hs(l,o-i.digestLength-1,s),p=Kt.util.xorBytes(a,d,a.length),y=p.substring(0,i.digestLength),v=f!=="\0",b=0;b<i.digestLength;++b)v|=c.charAt(b)!==y.charAt(b);for(var w=1,I=i.digestLength,P=i.digestLength;P<p.length;P++){var T=p.charCodeAt(P),S=T&1^1,K=w?65534:0;v|=T&K,w=w&S,I+=w}if(v||p.charCodeAt(I)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(I+1)};function Hs(t,e,r){r||(r=Kt.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),s=0;s<i;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+o),n+=r.digest().getBytes()}return n.substring(0,e)}});var ep=m((q8,cc)=>{var Sr=W();me();vi();gi();(function(){if(Sr.prime){cc.exports=Sr.prime;return}var t=cc.exports=Sr.prime=Sr.prime||{},e=Sr.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,l){return h|l};t.generateProbablePrime=function(h,l,d){typeof l=="function"&&(d=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var y=l.prng||Sr.random,v={nextBytes:function(b){for(var w=y.getBytesSync(b.length),I=0;I<b.length;++I)b[I]=w.charCodeAt(I)}};if(p.name==="PRIMEINC")return s(h,v,p.options,d);throw new Error("Invalid prime generation algorithm: "+p.name)};function s(h,l,d,p){return"workers"in d?f(h,l,d,p):o(h,l,d,p)}function o(h,l,d,p){var y=u(h,l),v=0,b=a(y.bitLength());"millerRabinTests"in d&&(b=d.millerRabinTests);var w=10;"maxBlockTime"in d&&(w=d.maxBlockTime),c(y,h,l,v,b,w,p)}function c(h,l,d,p,y,v,b){var w=+new Date;do{if(h.bitLength()>l&&(h=u(l,d)),h.isProbablePrime(y))return b(null,h);h.dAddOffset(r[p++%8],0)}while(v<0||+new Date-w<v);Sr.util.setImmediate(function(){c(h,l,d,p,y,v,b)})}function f(h,l,d,p){if(typeof Worker=="undefined")return o(h,l,d,p);var y=u(h,l),v=d.workers,b=d.workLoad||100,w=b*30/8,I=d.workerScript||"forge/prime.worker.js";if(v===-1)return Sr.util.estimateCores(function(T,S){T&&(S=2),v=S-1,P()});P();function P(){v=Math.max(1,v);for(var T=[],S=0;S<v;++S)T[S]=new Worker(I);for(var K=v,S=0;S<v;++S)T[S].addEventListener("message",ye);var U=!1;function ye(dt){if(!U){--K;var Ze=dt.data;if(Ze.found){for(var Ge=0;Ge<T.length;++Ge)T[Ge].terminate();return U=!0,p(null,new e(Ze.prime,16))}y.bitLength()>h&&(y=u(h,l));var ln=y.toString(16);dt.target.postMessage({hex:ln,workLoad:b}),y.dAddOffset(w,0)}}}}function u(h,l){var d=new e(h,l),p=h-1;return d.testBit(p)||d.bitwiseTo(e.ONE.shiftLeft(p),i,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function a(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var Nn=m((F8,ap)=>{var M=W();Xr();vi();Os();Xl();ep();gi();me();typeof H=="undefined"&&(H=M.jsbn.BigInteger);var H,uc=M.util.isNodejs?Dn():null,x=M.asn1,ot=M.util;M.pki=M.pki||{};ap.exports=M.pki.rsa=M.rsa=M.rsa||{};var q=M.pki,Bx=[6,4,2,4,2,4,6,2],Tx={name:"PrivateKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Rx={name:"RSAPrivateKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Px={name:"RSAPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Dx=M.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Ox=function(t){var e;if(t.algorithm in q.oids)e=q.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=x.oidToDer(e).getBytes(),i=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[]),s=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[]);s.value.push(x.create(x.Class.UNIVERSAL,x.Type.OID,!1,n)),s.value.push(x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,""));var o=x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(s),i.value.push(o),x.toDer(i).getBytes()},tp=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(H.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(H.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new H(M.util.bytesToHex(M.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(H.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(s)<0;)i=i.add(e.p);var o=i.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return o=o.multiply(n.modInverse(e.n)).mod(e.n),o};q.rsa.encrypt=function(t,e,r){var n=r,i,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=rp(t,e,r)):(i=M.util.createBuffer(),i.putBytes(t));for(var o=new H(i.toHex(),16),c=tp(o,e,n),f=c.toString(16),u=M.util.createBuffer(),a=s-Math.ceil(f.length/2);a>0;)u.putByte(0),--a;return u.putBytes(M.util.hexToBytes(f)),u.getBytes()};q.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=i,s}var o=new H(M.util.createBuffer(t).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var c=tp(o,e,r),f=c.toString(16),u=M.util.createBuffer(),a=i-Math.ceil(f.length/2);a>0;)u.putByte(0),--a;return u.putBytes(M.util.hexToBytes(f)),n!==!1?zs(u.getBytes(),e,r):u.getBytes()};q.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||M.random,i={nextBytes:function(c){for(var f=n.getBytesSync(c.length),u=0;u<c.length;++u)c[u]=f.charCodeAt(u)}},s=r.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:t,rng:i,eInt:e||65537,e:new H(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};q.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new H(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},s=+new Date,o,c=0;t.keys===null&&(e<=0||c<e);){if(t.state===0){var f=t.p===null?t.pBits:t.qBits,u=f-1;t.pqState===0?(t.num=new H(f,t.rng),t.num.testBit(u)||t.num.bitwiseTo(H.ONE.shiftLeft(u),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>f?t.pqState=0:t.num.isProbablePrime(Nx(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(Bx[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(H.ONE).gcd(t.e).compareTo(H.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(H.ONE),t.q1=t.q.subtract(H.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(H.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var a=t.e.modInverse(t.phi);t.keys={privateKey:q.rsa.setPrivateKey(t.n,t.e,a,t.p,t.q,a.mod(t.p1),a.mod(t.q1),t.q.modInverse(t.p)),publicKey:q.rsa.setPublicKey(t.n,t.e)}}o=+new Date,c+=o-s,s=o}return t.keys!==null};q.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!M.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(np("generateKeyPair"))return uc.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(c,f,u){if(c)return n(c);n(null,{privateKey:q.privateKeyFromPem(u),publicKey:q.publicKeyFromPem(f)})});if(ip("generateKey")&&ip("exportKey"))return ot.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:op(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(c){return ot.globalScope.crypto.subtle.exportKey("pkcs8",c.privateKey)}).then(void 0,function(c){n(c)}).then(function(c){if(c){var f=q.privateKeyFromAsn1(x.fromDer(M.util.createBuffer(c)));n(null,{privateKey:f,publicKey:q.setRsaPublicKey(f.n,f.e)})}});if(sp("generateKey")&&sp("exportKey")){var i=ot.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:op(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(c){var f=c.target.result,u=ot.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);u.oncomplete=function(a){var h=a.target.result,l=q.privateKeyFromAsn1(x.fromDer(M.util.createBuffer(h)));n(null,{privateKey:l,publicKey:q.setRsaPublicKey(l.n,l.e)})},u.onerror=function(a){n(a)}},i.onerror=function(c){n(c)};return}}else if(np("generateKeyPairSync")){var s=uc.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:q.privateKeyFromPem(s.privateKey),publicKey:q.publicKeyFromPem(s.publicKey)}}}var o=q.rsa.createKeyPairGenerationState(t,e,r);if(!n)return q.rsa.stepKeyPairGenerationState(o,0),o.keys;kx(o,r,n)};q.setRsaPublicKey=q.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(c,f,u){return rp(c,f,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(c,f){return M.pkcs1.encode_rsa_oaep(f,c,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(c){return c}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var o=i.encode(n,r,!0);return q.rsa.encrypt(o,r,!0)},r.verify=function(n,i,s){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),s==="RSASSA-PKCS1-V1_5"?s={verify:function(c,f){f=zs(f,r,!0);var u=x.fromDer(f);return c===u.value[1].value}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(c,f){return f=zs(f,r,!0),c===f}});var o=q.rsa.decrypt(i,r,!0,!1);return s.verify(n,o,r.n.bitLength())},r};q.setRsaPrivateKey=q.rsa.setPrivateKey=function(t,e,r,n,i,s,o,c){var f={n:t,e,d:r,p:n,q:i,dP:s,dQ:o,qInv:c};return f.decrypt=function(u,a,h){typeof a=="string"?a=a.toUpperCase():a===void 0&&(a="RSAES-PKCS1-V1_5");var l=q.rsa.decrypt(u,f,!1,!1);if(a==="RSAES-PKCS1-V1_5")a={decode:zs};else if(a==="RSA-OAEP"||a==="RSAES-OAEP")a={decode:function(d,p){return M.pkcs1.decode_rsa_oaep(p,d,h)}};else if(["RAW","NONE","NULL",null].indexOf(a)!==-1)a={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+a+'".');return a.decode(l,f,!1)},f.sign=function(u,a){var h=!1;typeof a=="string"&&(a=a.toUpperCase()),a===void 0||a==="RSASSA-PKCS1-V1_5"?(a={encode:Ox},h=1):(a==="NONE"||a==="NULL"||a===null)&&(a={encode:function(){return u}},h=1);var l=a.encode(u,f.n.bitLength());return q.rsa.encrypt(l,f,h)},f};q.wrapRsaPrivateKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,x.integerToDer(0).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(q.oids.rsaEncryption).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,"")]),x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,x.toDer(t).getBytes())])};q.privateKeyFromAsn1=function(t){var e={},r=[];if(x.validate(t,Tx,e,r)&&(t=x.fromDer(M.util.createBuffer(e.privateKey))),e={},r=[],!x.validate(t,Rx,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,o,c,f,u,a,h;return i=M.util.createBuffer(e.privateKeyModulus).toHex(),s=M.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=M.util.createBuffer(e.privateKeyPrivateExponent).toHex(),c=M.util.createBuffer(e.privateKeyPrime1).toHex(),f=M.util.createBuffer(e.privateKeyPrime2).toHex(),u=M.util.createBuffer(e.privateKeyExponent1).toHex(),a=M.util.createBuffer(e.privateKeyExponent2).toHex(),h=M.util.createBuffer(e.privateKeyCoefficient).toHex(),q.setRsaPrivateKey(new H(i,16),new H(s,16),new H(o,16),new H(c,16),new H(f,16),new H(u,16),new H(a,16),new H(h,16))};q.privateKeyToAsn1=q.privateKeyToRSAPrivateKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,x.integerToDer(0).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Mt(t.n)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Mt(t.e)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Mt(t.d)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Mt(t.p)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Mt(t.q)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Mt(t.dP)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Mt(t.dQ)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Mt(t.qInv))])};q.publicKeyFromAsn1=function(t){var e={},r=[];if(x.validate(t,Dx,e,r)){var n=x.derToOid(e.publicKeyOid);if(n!==q.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!x.validate(t,Px,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=M.util.createBuffer(e.publicKeyModulus).toHex(),o=M.util.createBuffer(e.publicKeyExponent).toHex();return q.setRsaPublicKey(new H(s,16),new H(o,16))};q.publicKeyToAsn1=q.publicKeyToSubjectPublicKeyInfo=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(q.oids.rsaEncryption).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,"")]),x.create(x.Class.UNIVERSAL,x.Type.BITSTRING,!1,[q.publicKeyToRSAPublicKey(t)])])};q.publicKeyToRSAPublicKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Mt(t.n)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Mt(t.e))])};function rp(t,e,r){var n=M.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var o=i-3-t.length,c;if(r===0||r===1){c=r===0?0:255;for(var f=0;f<o;++f)n.putByte(c)}else for(;o>0;){for(var u=0,a=M.random.getBytes(o),f=0;f<o;++f)c=a.charCodeAt(f),c===0?++u:n.putByte(c);o=u}return n.putByte(0),n.putBytes(t),n}function zs(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),s=M.util.createBuffer(t),o=s.getByte(),c=s.getByte();if(o!==0||r&&c!==0&&c!==1||!r&&c!=2||r&&c===0&&typeof n=="undefined")throw new Error("Encryption block is invalid.");var f=0;if(c===0){f=i-3-n;for(var u=0;u<f;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(c===1)for(f=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++f}else if(c===2)for(f=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++f}var a=s.getByte();if(a!==0||f!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function kx(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){s(t.pBits,function(c,f){if(c)return r(c);if(t.p=f,t.q!==null)return o(c,t.q);s(t.qBits,o)})}function s(c,f){M.prime.generateProbablePrime(c,n,f)}function o(c,f){if(c)return r(c);if(t.q=f,t.p.compareTo(t.q)<0){var u=t.p;t.p=t.q,t.q=u}if(t.p.subtract(H.ONE).gcd(t.e).compareTo(H.ONE)!==0){t.p=null,i();return}if(t.q.subtract(H.ONE).gcd(t.e).compareTo(H.ONE)!==0){t.q=null,s(t.qBits,o);return}if(t.p1=t.p.subtract(H.ONE),t.q1=t.q.subtract(H.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(H.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,o);return}var a=t.e.modInverse(t.phi);t.keys={privateKey:q.rsa.setPrivateKey(t.n,t.e,a,t.p,t.q,a.mod(t.p1),a.mod(t.q1),t.q.modInverse(t.p)),publicKey:q.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function Mt(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=M.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)==0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)==128)?r.substr(1):r}function Nx(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function np(t){return M.util.isNodejs&&typeof uc[t]=="function"}function ip(t){return typeof ot.globalScope!="undefined"&&typeof ot.globalScope.crypto=="object"&&typeof ot.globalScope.crypto.subtle=="object"&&typeof ot.globalScope.crypto.subtle[t]=="function"}function sp(t){return typeof ot.globalScope!="undefined"&&typeof ot.globalScope.msCrypto=="object"&&typeof ot.globalScope.msCrypto.subtle=="object"&&typeof ot.globalScope.msCrypto.subtle[t]=="function"}function op(t){for(var e=M.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var fc=m((U8,lp)=>{var O=W();ec();Xr();bl();tn();Os();El();Il();gi();Kl();Nn();me();typeof cp=="undefined"&&(cp=O.jsbn.BigInteger);var cp,_=O.asn1,F=O.pki=O.pki||{};lp.exports=F.pbe=O.pbe=O.pbe||{};var sn=F.oids,Lx={name:"EncryptedPrivateKeyInfo",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:_.Class.UNIVERSAL,type:_.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Kx={name:"PBES2Algorithms",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:_.Class.UNIVERSAL,type:_.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:_.Class.UNIVERSAL,type:_.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Mx={name:"pkcs-12PbeParams",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:_.Class.UNIVERSAL,type:_.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"iterations"}]};F.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=O.random.getBytesSync(r.saltSize),i=r.count,s=_.integerToDer(i),o,c,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,a,h;switch(r.algorithm){case"aes128":o=16,u=16,a=sn["aes128-CBC"],h=O.aes.createEncryptionCipher;break;case"aes192":o=24,u=16,a=sn["aes192-CBC"],h=O.aes.createEncryptionCipher;break;case"aes256":o=32,u=16,a=sn["aes256-CBC"],h=O.aes.createEncryptionCipher;break;case"des":o=8,u=8,a=sn.desCBC,h=O.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),p=hp(d),y=O.pkcs5.pbkdf2(e,n,i,o,p),v=O.random.getBytesSync(u),b=h(y);b.start(v),b.update(_.toDer(t)),b.finish(),f=b.output.getBytes();var w=qx(n,s,o,d);c=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(sn.pkcs5PBES2).getBytes()),_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(sn.pkcs5PBKDF2).getBytes()),w]),_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(a).getBytes()),_.create(_.Class.UNIVERSAL,_.Type.OCTETSTRING,!1,v)])])])}else if(r.algorithm==="3des"){o=24;var I=new O.util.ByteBuffer(n),y=F.pbe.generatePkcs12Key(e,I,1,i,o),v=F.pbe.generatePkcs12Key(e,I,2,i,o),b=O.des.createEncryptionCipher(y);b.start(v),b.update(_.toDer(t)),b.finish(),f=b.output.getBytes(),c=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(sn["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OCTETSTRING,!1,n),_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,s.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var P=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[c,_.create(_.Class.UNIVERSAL,_.Type.OCTETSTRING,!1,f)]);return P};F.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!_.validate(t,Lx,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=_.derToOid(n.encryptionOid),c=F.pbe.getCipher(o,n.encryptionParams,e),f=O.util.createBuffer(n.encryptedData);return c.update(f),c.finish()&&(r=_.fromDer(c.output)),r};F.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:_.toDer(t).getBytes()};return O.pem.encode(r,{maxline:e})};F.encryptedPrivateKeyFromPem=function(t){var e=O.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return _.fromDer(e.body)};F.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=F.wrapRsaPrivateKey(F.privateKeyToAsn1(t));return n=F.encryptPrivateKeyInfo(n,e,r),F.encryptedPrivateKeyToPem(n)}var i,s,o,c;switch(r.algorithm){case"aes128":i="AES-128-CBC",o=16,s=O.random.getBytesSync(16),c=O.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",o=24,s=O.random.getBytesSync(16),c=O.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",o=32,s=O.random.getBytesSync(16),c=O.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",o=24,s=O.random.getBytesSync(8),c=O.des.createEncryptionCipher;break;case"des":i="DES-CBC",o=8,s=O.random.getBytesSync(8),c=O.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var u=O.pbe.opensslDeriveBytes(e,s.substr(0,8),o),a=c(u);a.start(s),a.update(_.toDer(F.privateKeyToAsn1(t))),a.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:O.util.bytesToHex(s).toUpperCase()},body:a.output.getBytes()};return O.pem.encode(h)};F.decryptRsaPrivateKey=function(t,e){var r=null,n=O.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,o;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,o=O.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=O.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=O.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=O.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=O.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(h){return O.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":s=8,o=function(h){return O.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":s=16,o=function(h){return O.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var c=O.util.hexToBytes(n.dekInfo.parameters),f=O.pbe.opensslDeriveBytes(e,c.substr(0,8),s),u=o(f);if(u.start(c),u.update(O.util.createBuffer(n.body)),u.finish())r=u.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=F.decryptPrivateKeyInfo(_.fromDer(r),e):r=_.fromDer(r),r!==null&&(r=F.privateKeyFromAsn1(r)),r};F.pbe.generatePkcs12Key=function(t,e,r,n,i,s){var o,c;if(typeof s=="undefined"||s===null){if(!("sha1"in O.md))throw new Error('"sha1" hash algorithm unavailable.');s=O.md.sha1.create()}var f=s.digestLength,u=s.blockLength,a=new O.util.ByteBuffer,h=new O.util.ByteBuffer;if(t!=null){for(c=0;c<t.length;c++)h.putInt16(t.charCodeAt(c));h.putInt16(0)}var l=h.length(),d=e.length(),p=new O.util.ByteBuffer;p.fillWithByte(r,u);var y=u*Math.ceil(d/u),v=new O.util.ByteBuffer;for(c=0;c<y;c++)v.putByte(e.at(c%d));var b=u*Math.ceil(l/u),w=new O.util.ByteBuffer;for(c=0;c<b;c++)w.putByte(h.at(c%l));var I=v;I.putBuffer(w);for(var P=Math.ceil(i/f),T=1;T<=P;T++){var S=new O.util.ByteBuffer;S.putBytes(p.bytes()),S.putBytes(I.bytes());for(var K=0;K<n;K++)s.start(),s.update(S.getBytes()),S=s.digest();var U=new O.util.ByteBuffer;for(c=0;c<u;c++)U.putByte(S.at(c%f));var ye=Math.ceil(d/u)+Math.ceil(l/u),dt=new O.util.ByteBuffer;for(o=0;o<ye;o++){var Ze=new O.util.ByteBuffer(I.getBytes(u)),Ge=511;for(c=U.length()-1;c>=0;c--)Ge=Ge>>8,Ge+=U.at(c)+Ze.at(c),Ze.setAt(c,Ge&255);dt.putBuffer(Ze)}I=dt,a.putBuffer(S)}return a.truncate(a.length()-i),a};F.pbe.getCipher=function(t,e,r){switch(t){case F.oids.pkcs5PBES2:return F.pbe.getCipherForPBES2(t,e,r);case F.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case F.oids["pbewithSHAAnd40BitRC2-CBC"]:return F.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};F.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!_.validate(e,Kx,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(t=_.derToOid(n.kdfOid),t!==F.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=_.derToOid(n.encOid),t!==F.oids["aes128-CBC"]&&t!==F.oids["aes192-CBC"]&&t!==F.oids["aes256-CBC"]&&t!==F.oids["des-EDE3-CBC"]&&t!==F.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=n.kdfSalt,c=O.util.createBuffer(n.kdfIterationCount);c=c.getInt(c.length()<<3);var f,u;switch(F.oids[t]){case"aes128-CBC":f=16,u=O.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,u=O.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,u=O.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,u=O.des.createDecryptionCipher;break;case"desCBC":f=8,u=O.des.createDecryptionCipher;break}var a=fp(n.prfOid),h=O.pkcs5.pbkdf2(r,o,c,f,a),l=n.encIv,d=u(h);return d.start(l),d};F.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!_.validate(e,Mx,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=O.util.createBuffer(n.salt),c=O.util.createBuffer(n.iterations);c=c.getInt(c.length()<<3);var f,u,a;switch(t){case F.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,u=8,a=O.des.startDecrypting;break;case F.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,u=8,a=function(y,v){var b=O.rc2.createDecryptionCipher(y,40);return b.start(v,null),b};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var h=fp(n.prfOid),l=F.pbe.generatePkcs12Key(r,o,1,c,f,h);h.start();var d=F.pbe.generatePkcs12Key(r,o,2,c,u,h);return a(l,d)};F.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n=="undefined"||n===null){if(!("md5"in O.md))throw new Error('"md5" hash algorithm unavailable.');n=O.md.md5.create()}e===null&&(e="");for(var i=[up(n,t+e)],s=16,o=1;s<r;++o,s+=16)i.push(up(n,i[o-1]+t+e));return i.join("").substr(0,r)};function up(t,e){return t.start().update(e).digest().getBytes()}function fp(t){var e;if(!t)e="hmacWithSHA1";else if(e=F.oids[_.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return hp(e)}function hp(t){var e=O.md;switch(t){case"hmacWithSHA224":e=O.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function qx(t,e,r,n){var i=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OCTETSTRING,!1,t),_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,O.util.hexToBytes(r.toString(16))),_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(F.oids[n]).getBytes()),_.create(_.Class.UNIVERSAL,_.Type.NULL,!1,"")])),i}});var wt={};Re(wt,{concat:()=>Fx});function Fx(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));let r=new Uint8Array(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return r}var Et=ee(()=>{});var mi=m(pp=>{"use strict";pp.get=(t=globalThis)=>{let e=t.crypto;if(!e||!e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}});var hc=m((V8,yp)=>{"use strict";var{concat:Ux}=(Et(),wt),{fromString:dp}=(De(),Pe),Gx=mi();function Vx({algorithm:t="AES-GCM",nonceLength:e=12,keyLength:r=16,digest:n="SHA-256",saltLength:i=16,iterations:s=32767}={}){let o=Gx.get();r*=8;async function c(u,a){let h=o.getRandomValues(new Uint8Array(i)),l=o.getRandomValues(new Uint8Array(e)),d={name:t,iv:l},p={name:"PBKDF2",salt:h,iterations:s,hash:{name:n}},y=await o.subtle.importKey("raw",dp(a),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),v=await o.subtle.deriveKey(p,y,{name:t,length:r},!0,["encrypt"]),b=await o.subtle.encrypt(d,v,u);return Ux([h,d.iv,new Uint8Array(b)])}async function f(u,a){let h=u.slice(0,i),l=u.slice(i,i+e),d=u.slice(i+e),p={name:t,iv:l},y={name:"PBKDF2",salt:h,iterations:s,hash:{name:n}},v=await o.subtle.importKey("raw",dp(a),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),b=await o.subtle.deriveKey(y,v,{name:t,length:r},!0,["decrypt"]),w=await o.subtle.decrypt(p,b,d);return new Uint8Array(w)}return{encrypt:c,decrypt:f}}yp.exports={create:Vx}});var bp=m((j8,gp)=>{"use strict";var{base64:jx}=(Jr(),xr),Hx=hc();gp.exports={import:async function(t,e){let r=jx.decode(t);return await Hx.create().decrypt(r,e)}}});var _t={};Re(_t,{equals:()=>zx});function zx(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var St=ee(()=>{});var dc=m((H8,wp)=>{var ae=W();tn();me();var xi=wp.exports=ae.sha512=ae.sha512||{};ae.md.sha512=ae.md.algorithms.sha512=xi;var vp=ae.sha384=ae.sha512.sha384=ae.sha512.sha384||{};vp.create=function(){return xi.create("SHA-384")};ae.md.sha384=ae.md.algorithms.sha384=vp;ae.sha512.sha256=ae.sha512.sha256||{create:function(){return xi.create("SHA-512/256")}};ae.md["sha512/256"]=ae.md.algorithms["sha512/256"]=ae.sha512.sha256;ae.sha512.sha224=ae.sha512.sha224||{create:function(){return xi.create("SHA-512/224")}};ae.md["sha512/224"]=ae.md.algorithms["sha512/224"]=ae.sha512.sha224;xi.create=function(t){if(mp||Wx(),typeof t=="undefined"&&(t="SHA-512"),!(t in on))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=on[t],r=null,n=ae.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var o=64;switch(t){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var c={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return c.start=function(){c.messageLength=0,c.fullMessageLength=c.messageLength128=[];for(var f=c.messageLengthSize/4,u=0;u<f;++u)c.fullMessageLength.push(0);n=ae.util.createBuffer(),r=new Array(e.length);for(var u=0;u<e.length;++u)r[u]=e[u].slice(0);return c},c.start(),c.update=function(f,u){u==="utf8"&&(f=ae.util.encodeUtf8(f));var a=f.length;c.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var h=c.fullMessageLength.length-1;h>=0;--h)c.fullMessageLength[h]+=a[1],a[1]=a[0]+(c.fullMessageLength[h]/4294967296>>>0),c.fullMessageLength[h]=c.fullMessageLength[h]>>>0,a[0]=a[1]/4294967296>>>0;return n.putBytes(f),xp(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),c},c.digest=function(){var f=ae.util.createBuffer();f.putBytes(n.bytes());var u=c.fullMessageLength[c.fullMessageLength.length-1]+c.messageLengthSize,a=u&c.blockLength-1;f.putBytes(lc.substr(0,c.blockLength-a));for(var h,l,d=c.fullMessageLength[0]*8,p=0;p<c.fullMessageLength.length-1;++p)h=c.fullMessageLength[p+1]*8,l=h/4294967296>>>0,d+=l,f.putInt32(d>>>0),d=h>>>0;f.putInt32(d);for(var y=new Array(r.length),p=0;p<r.length;++p)y[p]=r[p].slice(0);xp(y,i,f);var v=ae.util.createBuffer(),b;t==="SHA-512"?b=y.length:t==="SHA-384"?b=y.length-2:b=y.length-4;for(var p=0;p<b;++p)v.putInt32(y[p][0]),(p!==b-1||t!=="SHA-512/224")&&v.putInt32(y[p][1]);return v},c};var lc=null,mp=!1,pc=null,on=null;function Wx(){lc=String.fromCharCode(128),lc+=ae.util.fillString(String.fromCharCode(0),128),pc=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],on={},on["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],on["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],on["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],on["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],mp=!0}function xp(t,e,r){for(var n,i,s,o,c,f,u,a,h,l,d,p,y,v,b,w,I,P,T,S,K,U,ye,dt,Ze,Ge,ln,Qi,xe,We,L,ko,No,Lo,Ko,iu=r.length();iu>=128;){for(xe=0;xe<16;++xe)e[xe][0]=r.getInt32()>>>0,e[xe][1]=r.getInt32()>>>0;for(;xe<80;++xe)ko=e[xe-2],We=ko[0],L=ko[1],n=((We>>>19|L<<13)^(L>>>29|We<<3)^We>>>6)>>>0,i=((We<<13|L>>>19)^(L<<3|We>>>29)^(We<<26|L>>>6))>>>0,Lo=e[xe-15],We=Lo[0],L=Lo[1],s=((We>>>1|L<<31)^(We>>>8|L<<24)^We>>>7)>>>0,o=((We<<31|L>>>1)^(We<<24|L>>>8)^(We<<25|L>>>7))>>>0,No=e[xe-7],Ko=e[xe-16],L=i+No[1]+o+Ko[1],e[xe][0]=n+No[0]+s+Ko[0]+(L/4294967296>>>0)>>>0,e[xe][1]=L>>>0;for(y=t[0][0],v=t[0][1],b=t[1][0],w=t[1][1],I=t[2][0],P=t[2][1],T=t[3][0],S=t[3][1],K=t[4][0],U=t[4][1],ye=t[5][0],dt=t[5][1],Ze=t[6][0],Ge=t[6][1],ln=t[7][0],Qi=t[7][1],xe=0;xe<80;++xe)u=((K>>>14|U<<18)^(K>>>18|U<<14)^(U>>>9|K<<23))>>>0,a=((K<<18|U>>>14)^(K<<14|U>>>18)^(U<<23|K>>>9))>>>0,h=(Ze^K&(ye^Ze))>>>0,l=(Ge^U&(dt^Ge))>>>0,c=((y>>>28|v<<4)^(v>>>2|y<<30)^(v>>>7|y<<25))>>>0,f=((y<<4|v>>>28)^(v<<30|y>>>2)^(v<<25|y>>>7))>>>0,d=(y&b|I&(y^b))>>>0,p=(v&w|P&(v^w))>>>0,L=Qi+a+l+pc[xe][1]+e[xe][1],n=ln+u+h+pc[xe][0]+e[xe][0]+(L/4294967296>>>0)>>>0,i=L>>>0,L=f+p,s=c+d+(L/4294967296>>>0)>>>0,o=L>>>0,ln=Ze,Qi=Ge,Ze=ye,Ge=dt,ye=K,dt=U,L=S+i,K=T+n+(L/4294967296>>>0)>>>0,U=L>>>0,T=I,S=P,I=b,P=w,b=y,w=v,L=i+o,y=n+s+(L/4294967296>>>0)>>>0,v=L>>>0;L=t[0][1]+v,t[0][0]=t[0][0]+y+(L/4294967296>>>0)>>>0,t[0][1]=L>>>0,L=t[1][1]+w,t[1][0]=t[1][0]+b+(L/4294967296>>>0)>>>0,t[1][1]=L>>>0,L=t[2][1]+P,t[2][0]=t[2][0]+I+(L/4294967296>>>0)>>>0,t[2][1]=L>>>0,L=t[3][1]+S,t[3][0]=t[3][0]+T+(L/4294967296>>>0)>>>0,t[3][1]=L>>>0,L=t[4][1]+U,t[4][0]=t[4][0]+K+(L/4294967296>>>0)>>>0,t[4][1]=L>>>0,L=t[5][1]+dt,t[5][0]=t[5][0]+ye+(L/4294967296>>>0)>>>0,t[5][1]=L>>>0,L=t[6][1]+Ge,t[6][0]=t[6][0]+Ze+(L/4294967296>>>0)>>>0,t[6][1]=L>>>0,L=t[7][1]+Qi,t[7][0]=t[7][0]+ln+(L/4294967296>>>0)>>>0,t[7][1]=L>>>0,iu-=128}}});var yc=m((z8,Ep)=>{"use strict";var $x=ms(),Yx=ce();Ep.exports=function(t){if(isNaN(t)||t<=0)throw Yx(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return $x(t)}});var Ws=m(wi=>{"use strict";me();vi();var Qx=W(),{fromString:Jx}=(De(),Pe),{toString:_p}=(Ne(),ke),{concat:Sp}=(Et(),wt);wi.bigIntegerToUintBase64url=(t,e)=>{let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Sp([new Uint8Array(e-r.length),r])}return _p(r,"base64url")};wi.base64urlToBigInteger=t=>{let e=wi.base64urlToBuffer(t);return new Qx.jsbn.BigInteger(_p(e,"base16"),16)};wi.base64urlToBuffer=(t,e)=>{let r=Jx(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Sp([new Uint8Array(e-r.length),r])}return r}});var Cp=m(Ei=>{"use strict";Xr();Nn();var Ir=W(),{bigIntegerToUintBase64url:qt,base64urlToBigInteger:Ft}=Ws(),{fromString:Ip}=(De(),Pe),{toString:Ap}=(Ne(),ke);Ei.pkcs1ToJwk=function(t){let e=Ir.asn1.fromDer(Ap(t,"ascii")),r=Ir.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:qt(r.n),e:qt(r.e),d:qt(r.d),p:qt(r.p),q:qt(r.q),dp:qt(r.dP),dq:qt(r.dQ),qi:qt(r.qInv),alg:"RS256",kid:"2011-04-29"}};Ei.jwkToPkcs1=function(t){let e=Ir.pki.privateKeyToAsn1({n:Ft(t.n),e:Ft(t.e),d:Ft(t.d),p:Ft(t.p),q:Ft(t.q),dP:Ft(t.dp),dQ:Ft(t.dq),qInv:Ft(t.qi)});return Ip(Ir.asn1.toDer(e).getBytes(),"ascii")};Ei.pkixToJwk=function(t){let e=Ir.asn1.fromDer(Ap(t,"ascii")),r=Ir.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:qt(r.n),e:qt(r.e),alg:"RS256",kid:"2011-04-29"}};Ei.jwkToPkix=function(t){let e=Ir.pki.publicKeyToAsn1({n:Ft(t.n),e:Ft(t.e)});return Ip(Ir.asn1.toDer(e).getBytes(),"ascii")}});var Pp=m((Y8,Rp)=>{"use strict";Nn();var Bp=W(),{base64urlToBigInteger:Zx}=Ws();function Tp(t,e){return e.map(r=>Zx(t[r]))}function Xx(t){return Bp.pki.setRsaPrivateKey(...Tp(t,["n","e","d","p","q","dp","dq","qi"]))}function ew(t){return Bp.pki.setRsaPublicKey(...Tp(t,["n","e"]))}Rp.exports={jwk2pub:ew,jwk2priv:Xx}});var kp=m(rr=>{"use strict";var tr=mi(),tw=yc(),{toString:rw}=(Ne(),ke),{fromString:nw}=(De(),Pe);rr.utils=Cp();rr.generateKey=async function(t){let e=await tr.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Dp(e);return{privateKey:r[0],publicKey:r[1]}};rr.unmarshalPrivateKey=async function(t){let r=[await tr.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await iw(t)],n=await Dp({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}};rr.getRandomValues=tw;rr.hashAndSign=async function(t,e){let r=await tr.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await tr.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,n.byteOffset,n.byteLength)};rr.hashAndVerify=async function(t,e,r){let n=await tr.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return tr.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)};function Dp(t){return Promise.all([tr.get().subtle.exportKey("jwk",t.privateKey),tr.get().subtle.exportKey("jwk",t.publicKey)])}function iw(t){return tr.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:sw,jwk2priv:ow}=Pp();function Op(t,e,r,n){let i=e?sw(t):ow(t),s=rw(Uint8Array.from(r),"ascii"),o=n(s,i);return nw(o,"ascii")}rr.encrypt=function(t,e){return Op(t,!0,e,(r,n)=>n.encrypt(r))};rr.decrypt=function(t,e){return Op(t,!1,e,(r,n)=>n.decrypt(r))}});var $s=m((J8,Np)=>{"use strict";var{base64:aw}=(Jr(),xr),cw=hc();Np.exports={export:async function(t,e){let n=await cw.create().encrypt(t,e);return aw.encode(n)}}});var Fp=m((Z8,qp)=>{"use strict";var{sha256:Lp}=(vt(),nt),Kp=ce(),{equals:Mp}=(St(),_t),{toString:uw}=(Ne(),ke);dc();var Ys=W(),at=kp(),Qs=Rs(),fw=$s(),Js=class{constructor(e){this._key=e}async verify(e,r){return at.hashAndVerify(this._key,r,e)}marshal(){return at.utils.jwkToPkix(this._key)}get bytes(){return Qs.PublicKey.encode({Type:Qs.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(e){return at.encrypt(this._key,e)}equals(e){return Mp(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Lp.digest(this.bytes);return e}},_i=class{constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return at.getRandomValues(16)}async sign(e){return at.hashAndSign(this._key,e)}get public(){if(!this._publicKey)throw Kp(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new Js(this._publicKey)}decrypt(e){return at.decrypt(this._key,e)}marshal(){return at.utils.jwkToPkcs1(this._key)}get bytes(){return Qs.PrivateKey.encode({Type:Qs.KeyType.RSA,Data:this.marshal()}).finish()}equals(e){return Mp(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Lp.digest(this.bytes);return e}async id(){let e=await this.public.hash();return uw(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new Ys.util.ByteBuffer(this.marshal()),i=Ys.asn1.fromDer(n),s=Ys.pki.privateKeyFromAsn1(i),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Ys.pki.encryptRsaPrivateKey(s,e,o)}else{if(r==="libp2p-key")return fw.export(this.bytes,e);throw Kp(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function hw(t){let e=at.utils.pkcs1ToJwk(t),r=await at.unmarshalPrivateKey(e);return new _i(r.privateKey,r.publicKey)}function lw(t){let e=at.utils.pkixToJwk(t);return new Js(e)}async function pw(t){let e=await at.unmarshalPrivateKey(t);return new _i(e.privateKey,e.publicKey)}async function dw(t){let e=await at.generateKey(t);return new _i(e.privateKey,e.publicKey)}qp.exports={RsaPublicKey:Js,RsaPrivateKey:_i,unmarshalRsaPublicKey:lw,unmarshalRsaPrivateKey:hw,generateKeyPair:dw,fromJwk:pw}});var _c=m((le,Wp)=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0});le.utils=le.verify=le.sign=le.getPublicKey=le.SignResult=le.Signature=le.Point=le.ExtendedPoint=le.CURVE=void 0;var de={a:-1n,d:37095705934669439343138083508754565189542113879843219016388785533085940283555n,P:2n**255n-19n,n:2n**252n+27742317777372353535851937790883648493n,h:8n,Gx:15112221349535400772501151409588531511454012693041857206046113283949847762202n,Gy:46316835694926478169428394003475163141307993866256225615783033603165251855960n};le.CURVE=de;var ze=32,Si=19681161376707505956807079304988542015446066515923890162744021073123829784752n,yw=25063068953384623474111414158702152701244531502492656460079210482610430750235n,gw=54469307008909316920995813868745141605393597292927456921205312896311721017578n,bw=1159843021668779879193775521855586647937357759715417654439879720876111806838n,vw=40440834346308536858101042469323190826248399146238708352240133220865137265952n,re=class{constructor(e,r,n,i){this.x=e,this.y=r,this.z=n,this.t=i}static fromAffine(e){if(!(e instanceof he))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(he.ZERO)?re.ZERO:new re(e.x,e.y,1n,C(e.x*e.y))}static toAffineBatch(e){let r=xw(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}static fromRistrettoHash(e){let r=vc(e.slice(0,ze)),n=this.calcElligatorRistrettoMap(r),i=vc(e.slice(ze,ze*2)),s=this.calcElligatorRistrettoMap(i);return n.add(s)}static calcElligatorRistrettoMap(e){let{d:r}=de,n=C(Si*e*e),i=C((n+1n)*bw),s=-1n,o=C((s-r*n)*C(n+r)),{isValid:c,value:f}=xc(i,o),u=C(f*e);Cr(u)||(u=C(-u)),c||(f=u),c||(s=n);let a=C(s*(n-1n)*vw-o),h=f*f,l=C((f+f)*o),d=C(a*yw),p=C(1n-h),y=C(1n+h);return new re(C(l*y),C(p*d),C(d*y),C(l*p))}static fromRistrettoBytes(e){let{a:r,d:n}=de,i="ExtendedPoint.fromRistrettoBytes: Cannot convert bytes to Ristretto Point",s=vc(e);if(!_w(Gp(s,ze),e)||Cr(s))throw new Error(i);let o=C(s*s),c=C(1n+r*o),f=C(1n-r*o),u=C(c*c),a=C(f*f),h=C(r*n*u-a),{isValid:l,value:d}=jp(C(h*a)),p=C(d*f),y=C(d*p*h),v=C((s+s)*p);Cr(v)&&(v=C(-v));let b=C(c*y),w=C(v*b);if(!l||Cr(w)||b===0n)throw new Error(i);return new re(v,b,1n,w)}toRistrettoBytes(){let{x:e,y:r,z:n,t:i}=this,s=C((n+r)*(n-r)),o=C(e*r),{value:c}=jp(C(s*o**2n)),f=C(c*s),u=C(c*o),a=C(f*u*i),h;Cr(i*a)?([e,r]=[C(r*Si),C(e*Si)],h=C(f*gw)):h=u,Cr(e*a)&&(r=C(-r));let l=C((n-r)*h);return Cr(l)&&(l=C(-l)),Gp(l,ze)}equals(e){let r=this,n=e,[i,s,o,c]=[r.t,n.t,r.z,n.z];return C(i*c)===C(s*o)}negate(){return new re(C(-this.x),this.y,this.z,C(-this.t))}double(){let e=this.x,r=this.y,n=this.z,{a:i}=de,s=C(e**2n),o=C(r**2n),c=C(2n*n**2n),f=C(i*s),u=C((e+r)**2n-s-o),a=C(f+o),h=C(a-c),l=C(f-o),d=C(u*h),p=C(a*l),y=C(u*l),v=C(h*a);return new re(d,p,v,y)}add(e){let r=this.x,n=this.y,i=this.z,s=this.t,o=e.x,c=e.y,f=e.z,u=e.t,a=C((n-r)*(c+o)),h=C((n+r)*(c-o)),l=C(h-a);if(l===0n)return this.double();let d=C(i*2n*u),p=C(s*2n*f),y=C(p+d),v=C(h+a),b=C(p-d),w=C(y*l),I=C(v*b),P=C(y*b),T=C(l*v);return new re(w,I,T,P)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){if(!Vp(e))throw new TypeError("Point#multiply: expected number or bigint");let r=C(BigInt(e),de.n);if(r===1n)return this;let n=re.ZERO,i=this;for(;r>0n;)r&1n&&(n=n.add(i)),i=i.double(),r>>=1n;return n}precomputeWindow(e){let r=256/e+1,n=[],i=this,s=i;for(let o=0;o<r;o++){s=i,n.push(s);for(let c=1;c<2**(e-1);c++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(e,r){!r&&this.equals(re.BASE)&&(r=he.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&gc.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=re.normalizeZ(i),gc.set(r,i)));let s=re.ZERO,o=re.ZERO,c=256/n+1,f=2**(n-1),u=BigInt(2**n-1),a=2**n,h=BigInt(n);for(let l=0;l<c;l++){let d=l*f,p=Number(e&u);if(e>>=h,p>f&&(p-=a,e+=1n),p===0)o=o.add(l%2?i[d].negate():i[d]);else{let y=i[d+Math.abs(p)-1];s=s.add(p<0?y.negate():y)}}return[s,o]}multiply(e,r){if(!Vp(e))throw new TypeError("Point#multiply: expected number or bigint");let n=C(BigInt(e),de.n);return re.normalizeZ(this.wNAF(n,r))[0]}toAffine(e=mc(this.z)){let r=C(this.x*e),n=C(this.y*e);return new he(r,n)}};le.ExtendedPoint=re;re.BASE=new re(de.Gx,de.Gy,1n,C(de.Gx*de.Gy));re.ZERO=new re(0n,1n,1n,0n);var gc=new WeakMap,he=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,gc.delete(this)}static fromHex(e){let{d:r,P:n}=de,i=e instanceof Uint8Array?e:Ii(e);if(i.length!==32)throw new Error("Point.fromHex: expected 32 bytes");let s=i[31],o=s&~128,c=(s&128)!=0,f=Uint8Array.from(Array.from(i.slice(0,31)).concat(o)),u=Ln(f);if(u>=n)throw new Error("Point.fromHex expects hex <= Fp");let a=C(u*u),h=C(a-1n),l=C(r*a+1n),{isValid:d,value:p}=xc(h,l);if(!d)throw new Error("Point.fromHex: invalid y coordinate");let y=(p&1n)===1n;return c!==y&&(p=C(-p)),new he(p,u)}static async fromPrivateKey(e){let r=await le.utils.sha512(zp(e));return he.BASE.multiply(Hp(r))}toRawBytes(){let e=bc(this.y),r=new Uint8Array(ze);for(let i=e.length-2,s=0;s<ze&&i>=0;i-=2,s++)r[s]=Number.parseInt(e[i]+e[i+1],16);let n=this.x&1n?128:0;return r[ze-1]|=n,r}toHex(){return Up(this.toRawBytes())}toX25519(){return C((1n+this.y)*mc(1n-this.y))}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new he(C(-this.x),this.y)}add(e){return re.fromAffine(this).add(re.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return re.fromAffine(this).multiply(e,this).toAffine()}};le.Point=he;he.BASE=new he(de.Gx,de.Gy);he.ZERO=new he(0n,1n);var Ar=class{constructor(e,r){this.r=e,this.s=r}static fromHex(e){e=Ec(e);let r=he.fromHex(e.slice(0,32)),n=Ln(e.slice(32));if(!Sw(n))throw new Error("Signature.fromHex expects s <= CURVE.n");return new Ar(r,n)}toRawBytes(){let e=Ii(bc(this.s)).reverse(),r=new Uint8Array(ze);r.set(e);let n=new Uint8Array(ze*2);return n.set(this.r.toRawBytes()),n.set(r,32),n}toHex(){return Up(this.toRawBytes())}};le.Signature=Ar;le.SignResult=Ar;function mw(...t){if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}function Up(t){let e="";for(let r=0;r<t.length;r++)e+=t[r].toString(16).padStart(2,"0");return e}function Ii(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2;e[r]=Number.parseInt(t.slice(n,n+2),16)}return e}function bc(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function Gp(t,e=ze){let r=bc(t).padStart(e*2,"0");return Ii(r).reverse()}function Cr(t){return(C(t)&1n)===1n}function Vp(t){return!!(typeof t=="bigint"&&t>0n||typeof t=="number"&&t>0&&Number.isSafeInteger(t))}function Ln(t){let e=0n;for(let r=0;r<t.length;r++)e+=BigInt(t[r])<<8n*BigInt(r);return e}function vc(t){return C(Ln(t)&2n**255n-1n)}function C(t,e=de.P){let r=t%e;return r>=0n?r:e+r}function mc(t,e=de.P){if(t===0n||e<=0n)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=C(t,e),n=e,[i,s,o,c]=[0n,1n,1n,0n];for(;r!==0n;){let u=n/r,a=n%r,h=i-o*u,l=s-c*u;[n,r]=[r,a],[i,s]=[o,c],[o,c]=[h,l]}if(n!==1n)throw new Error("invert: does not exist");return C(i,e)}function xw(t,e=de.P){let r=t.length,n=new Array(r),i=1n;for(let s=0;s<r;s++)t[s]!==0n&&(n[s]=i,i=C(i*t[s],e));i=mc(i,e);for(let s=r-1;s>=0;s--){if(t[s]===0n)continue;let o=C(i*t[s],e);t[s]=C(i*n[s],e),i=o}return t}function Ut(t,e){let{P:r}=de,n=t;for(;e-- >0n;)n*=n,n%=r;return n}function ww(t){let{P:e}=de,n=t*t%e*t%e,i=Ut(n,2n)*n%e,s=Ut(i,1n)*t%e,o=Ut(s,5n)*s%e,c=Ut(o,10n)*o%e,f=Ut(c,20n)*c%e,u=Ut(f,40n)*f%e,a=Ut(u,80n)*u%e,h=Ut(a,80n)*u%e,l=Ut(h,10n)*o%e;return Ut(l,2n)*t%e}function xc(t,e){let r=C(e*e*e),n=C(r*r*e),i=C(t*r*ww(t*n)),s=C(e*i*i),o=i,c=C(i*Si),f=s===t,u=s===C(-t),a=s===C(-t*Si);return f&&(i=o),(u||a)&&(i=c),Cr(i)&&(i=C(-i)),{isValid:f||u,value:i}}function jp(t){return xc(1n,t)}async function wc(...t){let e=mw(...t),r=await le.utils.sha512(e),n=Ln(r);return C(n,de.n)}function Ew(t){return t.slice(ze)}function Hp(t){let e=ze-1,r=t.slice(0,ze);return r[0]&=248,r[e]&=127,r[e]|=64,C(Ln(r),de.n)}function _w(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Ec(t){return t instanceof Uint8Array?t:Ii(t)}function Sw(t){return 0<t&&t<de.n}function zp(t){let e;if(typeof t=="bigint"||typeof t=="number"&&Number.isSafeInteger(t)){if(e=BigInt(t),e<0n||e>2n**256n)throw new Error("Expected 32 bytes of private key");t=e.toString(16).padStart(ze*2,"0")}if(typeof t=="string"){if(t.length!==64)throw new Error("Expected 32 bytes of private key");return Ii(t)}else if(t instanceof Uint8Array){if(t.length!==32)throw new Error("Expected 32 bytes of private key");return t}else throw new TypeError("Expected valid private key")}async function Iw(t){let e=await he.fromPrivateKey(t);return typeof t=="string"?e.toHex():e.toRawBytes()}le.getPublicKey=Iw;async function Aw(t,e){let r=await le.utils.sha512(zp(e)),n=Hp(r),i=he.BASE.multiply(n),s=Ec(t),o=await wc(Ew(r),s),c=he.BASE.multiply(o),f=await wc(c.toRawBytes(),i.toRawBytes(),s),u=C(o+f*n,de.n),a=new Ar(c,u);return typeof t=="string"?a.toHex():a.toRawBytes()}le.sign=Aw;async function Cw(t,e,r){e=Ec(e),r instanceof he||(r=he.fromHex(r)),t instanceof Ar||(t=Ar.fromHex(t));let n=await wc(t.r.toRawBytes(),r.toRawBytes(),e),i=re.fromAffine(r).multiplyUnsafe(n),s=re.BASE.multiply(t.s);return re.fromAffine(t.r).add(i).subtract(s).multiplyUnsafe(8n).equals(re.ZERO)}le.verify=Cw;he.BASE._setWindowSize(8);var Br=(()=>{let t=typeof self=="object"&&"crypto"in self?self.crypto:void 0;return{node:typeof Wp!="undefined"&&typeof pn=="function"&&!t?Dn():void 0,web:t}})();le.utils={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],randomBytes:(t=32)=>{if(Br.web)return Br.web.getRandomValues(new Uint8Array(t));if(Br.node){let{randomBytes:e}=Br.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>{let t=1024;for(;t--;){let e=le.utils.randomBytes(32),r=Ln(e);if(r>1n&&r<de.n)return e}throw new Error("Valid private key was not found in 1024 iterations. PRNG is broken")},sha512:async t=>{if(Br.web){let e=await Br.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(e)}else{if(Br.node)return Uint8Array.from(Br.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(t=8,e=he.BASE){let r=e.equals(he.BASE)?e:new he(e.x,e.y);return r._setWindowSize(t),r.multiply(1n),r}}});var Yp=m(Tr=>{"use strict";var Ai=_c(),Bw=32,Tw=64,Zs=32;Tr.publicKeyLength=Bw;Tr.privateKeyLength=Tw;Tr.generateKey=async function(){let t=Ai.utils.randomPrivateKey(),e=await Ai.getPublicKey(t);return{privateKey:$p(t,e),publicKey:e}};Tr.generateKeyFromSeed=async function(t){if(t.length!==Zs)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await Ai.getPublicKey(e);return{privateKey:$p(e,r),publicKey:r}};Tr.hashAndSign=function(t,e){let r=t.slice(0,Zs);return Ai.sign(e,r)};Tr.hashAndVerify=function(t,e,r){return Ai.verify(e,r,t)};function $p(t,e){let r=new Uint8Array(Tr.privateKeyLength);for(let n=0;n<Zs;n++)r[n]=t[n],r[Zs+n]=e[n];return r}});var ed=m((e4,Xp)=>{"use strict";var Qp=ce(),{equals:Jp}=(St(),_t),{sha256:Zp}=(vt(),nt),{base58btc:Rw}=(Qr(),Yr),{identity:Pw}=(hi(),Tn),Ke=Yp(),Xs=Rs(),Dw=$s(),eo=class{constructor(e){this._key=Mn(e,Ke.publicKeyLength)}async verify(e,r){return Ke.hashAndVerify(this._key,r,e)}marshal(){return this._key}get bytes(){return Xs.PublicKey.encode({Type:Xs.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return Jp(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Zp.digest(this.bytes);return e}},Kn=class{constructor(e,r){this._key=Mn(e,Ke.privateKeyLength),this._publicKey=Mn(r,Ke.publicKeyLength)}async sign(e){return Ke.hashAndSign(this._key,e)}get public(){return new eo(this._publicKey)}marshal(){return this._key}get bytes(){return Xs.PrivateKey.encode({Type:Xs.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return Jp(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Zp.digest(this.bytes);return e}async id(){let e=await Pw.digest(this.public.bytes);return Rw.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return Dw.export(this.bytes,e);throw Qp(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function Ow(t){if(t.length>Ke.privateKeyLength){t=Mn(t,Ke.privateKeyLength+Ke.publicKeyLength);let n=t.slice(0,Ke.privateKeyLength),i=t.slice(Ke.privateKeyLength,t.length);return new Kn(n,i)}t=Mn(t,Ke.privateKeyLength);let e=t.slice(0,Ke.privateKeyLength),r=t.slice(Ke.publicKeyLength);return new Kn(e,r)}function kw(t){return t=Mn(t,Ke.publicKeyLength),new eo(t)}async function Nw(){let{privateKey:t,publicKey:e}=await Ke.generateKey();return new Kn(t,e)}async function Lw(t){let{privateKey:e,publicKey:r}=await Ke.generateKeyFromSeed(t);return new Kn(e,r)}function Mn(t,e){if(t=Uint8Array.from(t||[]),t.length!==e)throw Qp(new Error(`Key must be a Uint8Array of length ${e}, got ${t.length}`),"ERR_INVALID_KEY_TYPE");return t}Xp.exports={Ed25519PublicKey:eo,Ed25519PrivateKey:Kn,unmarshalEd25519PrivateKey:Ow,unmarshalEd25519PublicKey:kw,generateKeyPair:Nw,generateKeyPairFromSeed:Lw}});var Bc=m((Q,dd)=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});Q.utils=Q.schnorr=Q.verify=Q.signSync=Q.sign=Q.getSharedSecret=Q.recoverPublicKey=Q.getPublicKey=Q.SignResult=Q.Signature=Q.Point=Q.CURVE=void 0;var Z={a:0n,b:7n,P:2n**256n-2n**32n-977n,n:2n**256n-432420386565659656852420866394968145599n,h:1n,Gx:55066263022277343669578718895168534326250603453777594175500187360389116729240n,Gy:32670510020758816978083085130507043184471273380659243275938904335757337482424n,beta:0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501een};Q.CURVE=Z;function td(t){let{a:e,b:r}=Z;return k(t**3n+e*t+r)}var to=Z.a===0n,Y=class{constructor(e,r,n){this.x=e,this.y=r,this.z=n}static fromAffine(e){if(!(e instanceof X))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new Y(e.x,e.y,1n)}static toAffineBatch(e){let r=Mw(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return Y.toAffineBatch(e).map(Y.fromAffine)}equals(e){let r=this,n=e,i=k(r.z*r.z),s=k(r.z*i),o=k(n.z*n.z),c=k(n.z*o);return k(r.x*o)===k(i*n.x)&&k(r.y*c)===k(s*n.y)}negate(){return new Y(this.x,k(-this.y),this.z)}double(){let e=this.x,r=this.y,n=this.z,i=k(e**2n),s=k(r**2n),o=k(s**2n),c=k(2n*(k(k((e+s)**2n))-i-o)),f=k(3n*i),u=k(f**2n),a=k(u-2n*c),h=k(f*(c-a)-8n*o),l=k(2n*r*n);return new Y(a,h,l)}add(e){if(!(e instanceof Y))throw new TypeError("JacobianPoint#add: expected JacobianPoint");let r=this.x,n=this.y,i=this.z,s=e.x,o=e.y,c=e.z;if(s===0n||o===0n)return this;if(r===0n||n===0n)return e;let f=k(i**2n),u=k(c**2n),a=k(r*u),h=k(s*f),l=k(n*c*u),d=k(k(o*i)*f),p=k(h-a),y=k(d-l);if(p===0n)return y===0n?this.double():Y.ZERO;let v=k(p**2n),b=k(p*v),w=k(a*v),I=k(y**2n-b-2n*w),P=k(y*(w-I)-l*b),T=k(i*c*p);return new Y(I,P,T)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){if(!id(e))throw new TypeError("Point#multiply: expected valid scalar");let r=k(BigInt(e),Z.n);if(!to){let a=Y.ZERO,h=this;for(;r>0n;)r&1n&&(a=a.add(h)),h=h.double(),r>>=1n;return a}let[n,i,s,o]=od(r),c=Y.ZERO,f=Y.ZERO,u=this;for(;i>0n||o>0n;)i&1n&&(c=c.add(u)),o&1n&&(f=f.add(u)),u=u.double(),i>>=1n,o>>=1n;return n&&(c=c.negate()),s&&(f=f.negate()),f=new Y(k(f.x*Z.beta),f.y,f.z),c.add(f)}precomputeWindow(e){let r=to?128/e+1:256/e+1,n=[],i=this,s=i;for(let o=0;o<r;o++){s=i,n.push(s);for(let c=1;c<2**(e-1);c++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(e,r){!r&&this.equals(Y.BASE)&&(r=X.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Sc.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=Y.normalizeZ(i),Sc.set(r,i)));let s=Y.ZERO,o=Y.ZERO,c=to?128/n+1:256/n+1,f=2**(n-1),u=BigInt(2**n-1),a=2**n,h=BigInt(n);for(let l=0;l<c;l++){let d=l*f,p=Number(e&u);if(e>>=h,p>f&&(p-=a,e+=1n),p===0)o=o.add(l%2?i[d].negate():i[d]);else{let y=i[d+Math.abs(p)-1];s=s.add(p<0?y.negate():y)}}return[s,o]}multiply(e,r){if(!id(e))throw new TypeError("Point#multiply: expected valid scalar");let n=k(BigInt(e),Z.n),i,s;if(to){let[o,c,f,u]=od(n),a,h,l,d;[a,l]=this.wNAF(c,r),[h,d]=this.wNAF(u,r),o&&(a=a.negate()),f&&(h=h.negate()),h=new Y(k(h.x*Z.beta),h.y,h.z),[i,s]=[a.add(h),l.add(d)]}else[i,s]=this.wNAF(n,r);return Y.normalizeZ([i,s])[0]}toAffine(e=Ti(this.z)){let r=e**2n,n=k(this.x*r),i=k(this.y*r*e);return new X(n,i)}};Y.BASE=new Y(Z.Gx,Z.Gy,1n);Y.ZERO=new Y(0n,1n,0n);var Sc=new WeakMap,X=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,Sc.delete(this)}static fromCompressedHex(e){let r=e.length===32,n=ct(r?e:e.slice(1)),i=td(n),s=Kw(i),o=(s&1n)===1n;r?o&&(s=k(-s)):(e[0]&1)==1!==o&&(s=k(-s));let c=new X(n,s);return c.assertValidity(),c}static fromUncompressedHex(e){let r=ct(e.slice(1,33)),n=ct(e.slice(33)),i=new X(r,n);return i.assertValidity(),i}static fromHex(e){let r=io(e),n=r[0];if(r.length===32||r.length===33&&(n===2||n===3))return this.fromCompressedHex(r);if(r.length===65&&n===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${r.length}`)}static fromPrivateKey(e){return X.BASE.multiply(qn(e))}static fromSignature(e,r,n){let i=e instanceof Uint8Array?ct(e):ir(e),s=ud(r),{r:o,s:c}=s;if(n!==0&&n!==1)throw new Error("Cannot recover signature: invalid yParity bit");let f=2+(n&1),u=X.fromHex(`0${f}${Rr(o)}`),a=Y.fromAffine(u).multiplyUnsafe(c),h=Y.BASE.multiply(i),l=Ti(o,Z.n),p=a.subtract(h).multiplyUnsafe(l).toAffine();return p.assertValidity(),p}toRawBytes(e=!1){return Pr(this.toHex(e))}toHex(e=!1){let r=Rr(this.x);return e?`${this.y&1n?"03":"02"}${r}`:`04${r}${Rr(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{P:r}=Z,{x:n,y:i}=this;if(n===0n||i===0n||n>=r||i>=r)throw new Error(e);let s=k(i*i),o=td(n);if((s-o)%r!==0n)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new X(this.x,k(-this.y))}double(){return Y.fromAffine(this).double().toAffine()}add(e){return Y.fromAffine(this).add(Y.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Y.fromAffine(this).multiply(e,this).toAffine()}};Q.Point=X;X.BASE=new X(Z.Gx,Z.Gy);X.ZERO=new X(0n,0n);function rd(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}var nr=class{constructor(e,r){this.r=e,this.s=r}static fromCompact(e){if(typeof e!="string"&&!(e instanceof Uint8Array))throw new TypeError("Signature.fromCompact: Expected string or Uint8Array");let r=e instanceof Uint8Array?ro(e):e;if(r.length!==128)throw new Error("Signature.fromCompact: Expected 64-byte hex");let n=new nr(ir(r.slice(0,64)),ir(r.slice(64,128)));return n.assertValidity(),n}static fromDER(e){let r="Signature.fromDER";if(typeof e!="string"&&!(e instanceof Uint8Array))throw new TypeError(`${r}: Expected string or Uint8Array`);let n=e instanceof Uint8Array?ro(e):e,i=Bi(n.slice(2,4));if(n.slice(0,2)!=="30"||i!==n.length-4||n.slice(4,6)!=="02")throw new Error(`${r}: Invalid signature ${n}`);let s=Bi(n.slice(6,8)),o=8+s,c=n.slice(8,o);if(c.startsWith("00")&&Bi(c.slice(2,4))<=127)throw new Error(`${r}: Invalid r with trailing length`);let f=ir(c);if(n.slice(o,o+2)!=="02")throw new Error(`${r}: Invalid r-s separator`);let a=Bi(n.slice(o+2,o+4)),h=i-a-s-10;if(h>0||h===-4)throw new Error(`${r}: Invalid total length`);if(a>i-s-4)throw new Error(`${r}: Invalid s`);let l=o+4,d=n.slice(l,l+a);if(d.startsWith("00")&&Bi(d.slice(2,4))<=127)throw new Error(`${r}: Invalid s with trailing length`);let p=ir(d),y=new nr(f,p);return y.assertValidity(),y}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!Ri(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Ri(r))throw new Error("Invalid Signature: s must be 0 < s < n")}toDERRawBytes(e=!1){return Pr(this.toDERHex(e))}toDERHex(e=!1){let r=rd(Ci(this.s));if(e)return r;let n=rd(Ci(this.r)),i=Ci(n.length/2),s=Ci(r.length/2);return`30${Ci(n.length/2+r.length/2+4)}02${i}${n}02${s}${r}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return Pr(this.toCompactHex())}toCompactHex(){return Rr(this.r)+Rr(this.s)}};Q.Signature=nr;Q.SignResult=nr;function nd(...t){if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}function ro(t){let e="";for(let r=0;r<t.length;r++)e+=t[r].toString(16).padStart(2,"0");return e}function Rr(t){return t.toString(16).padStart(64,"0")}function no(t){return Pr(Rr(t))}function Ci(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function ir(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function Pr(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2;e[r]=Number.parseInt(t.slice(n,n+2),16)}return e}function io(t){return t instanceof Uint8Array?t:Pr(t)}function ct(t){return ir(ro(t))}function Bi(t){return Number.parseInt(t,16)*2}function id(t){return!!(typeof t=="bigint"&&t>0n||typeof t=="number"&&t>0&&Number.isSafeInteger(t))}function k(t,e=Z.P){let r=t%e;return r>=0?r:e+r}function ut(t,e){let{P:r}=Z,n=t;for(;e-- >0n;)n*=n,n%=r;return n}function Kw(t){let{P:e}=Z,r=t*t*t%e,n=r*r*t%e,i=ut(n,3n)*n%e,s=ut(i,3n)*n%e,o=ut(s,2n)*r%e,c=ut(o,11n)*o%e,f=ut(c,22n)*c%e,u=ut(f,44n)*f%e,a=ut(u,88n)*u%e,h=ut(a,44n)*f%e,l=ut(h,3n)*n%e,d=ut(l,23n)*c%e,p=ut(d,6n)*r%e;return ut(p,2n)}function Ti(t,e=Z.P){if(t===0n||e<=0n)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=k(t,e),n=e,[i,s,o,c]=[0n,1n,1n,0n];for(;r!==0n;){let u=n/r,a=n%r,h=i-o*u,l=s-c*u;[n,r]=[r,a],[i,s]=[o,c],[o,c]=[h,l]}if(n!==1n)throw new Error("invert: does not exist");return k(i,e)}function Mw(t,e=Z.P){let r=t.length,n=new Array(r),i=1n;for(let s=0;s<r;s++)t[s]!==0n&&(n[s]=i,i=k(i*t[s],e));i=Ti(i,e);for(let s=r-1;s>=0;s--){if(t[s]===0n)continue;let o=k(i*t[s],e);t[s]=k(i*n[s],e),i=o}return t}var sd=(t,e)=>(t+e/2n)/e,so=2n**128n;function od(t){let{n:e}=Z,r=0x3086d221a7d46bcde86c90e49284eb15n,n=-0xe4437ed6010e88286f547fa90abfe4c3n,i=0x114ca50f7a8e2f3f657c1108d9d44cfd8n,s=r,o=sd(s*t,e),c=sd(-n*t,e),f=k(t-o*r-c*i,e),u=k(-o*n-c*s,e),a=f>so,h=u>so;if(a&&(f=e-f),h&&(u=e-u),f>so||u>so)throw new Error("splitScalarEndo: Endomorphism failed");return[a,f,h,u]}function qw(t){typeof t!="string"&&(t=ro(t));let e=ir(t||"0"),n=t.length/2*8-256;return n>0&&(e=e>>BigInt(n)),e>=Z.n&&(e-=Z.n),e}function ad(t,e){if(t==null)throw new Error(`sign: expected valid msgHash, not "${t}"`);let r=typeof t=="string"?ir(t):ct(t),n=no(r),i=ct(n),s=no(e),o=new Uint8Array(32).fill(1),c=new Uint8Array(32).fill(0),f=Uint8Array.from([0]),u=Uint8Array.from([1]);return[n,i,s,o,c,f,u]}async function Fw(t,e){let r=qn(e),[n,i,s,o,c,f,u]=ad(t,r),a=Q.utils.hmacSha256;c=await a(c,o,f,s,n),o=await a(c,o),c=await a(c,o,u,s,n),o=await a(c,o);for(let h=0;h<1e3;h++){o=await a(c,o);let l=cd(o,i,r);if(l)return l;c=await a(c,o,f),o=await a(c,o)}throw new TypeError("secp256k1: Tried 1,000 k values for sign(), all were invalid")}function Uw(t,e){let r=qn(e),[n,i,s,o,c,f,u]=ad(t,r),a=Q.utils.hmacSha256Sync;if(!a)throw new Error("utils.hmacSha256Sync is undefined, you need to set it");if(c=a(c,o,f,s,n),c instanceof Promise)throw new Error("To use sync sign(), ensure utils.hmacSha256 is sync");o=a(c,o),c=a(c,o,u,s,n),o=a(c,o);for(let h=0;h<1e3;h++){o=a(c,o);let l=cd(o,i,r);if(l)return l;c=a(c,o,f),o=a(c,o)}throw new TypeError("secp256k1: Tried 1,000 k values for sign(), all were invalid")}function Ri(t){return 0<t&&t<Z.n}function cd(t,e,r){let n=ct(t);if(!Ri(n))return;let i=Z.n,s=X.BASE.multiply(n),o=k(s.x,i),c=k(Ti(n,i)*(e+o*r),i);if(!(o===0n||c===0n))return[s,o,c]}function qn(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==64)throw new Error("Expected 32 bytes of private key");e=ir(t)}else if(t instanceof Uint8Array){if(t.length!==32)throw new Error("Expected 32 bytes of private key");e=ct(t)}else throw new TypeError("Expected valid private key");if(!Ri(e))throw new Error("Expected private key: 0 < key < n");return e}function Ic(t){return t instanceof X?(t.assertValidity(),t):X.fromHex(t)}function ud(t){return t instanceof nr?(t.assertValidity(),t):nr.fromDER(t)}function Gw(t,e=!1){let r=X.fromPrivateKey(t);return typeof t=="string"?r.toHex(e):r.toRawBytes(e)}Q.getPublicKey=Gw;function Vw(t,e,r){let n=X.fromSignature(t,e,r);return typeof t=="string"?n.toHex():n.toRawBytes()}Q.recoverPublicKey=Vw;function fd(t){let e=t instanceof Uint8Array,r=typeof t=="string",n=(e||r)&&t.length;return e?n===33||n===65:r?n===66||n===130:t instanceof X}function jw(t,e,r=!1){if(fd(t))throw new TypeError("getSharedSecret: first arg must be private key");if(!fd(e))throw new TypeError("getSharedSecret: second arg must be public key");let n=Ic(e);n.assertValidity();let i=n.multiply(qn(t));return typeof t=="string"?i.toHex(r):i.toRawBytes(r)}Q.getSharedSecret=jw;function hd(t,e,r=!1){let[n,i,s]=t,{canonical:o,der:c,recovered:f}=e,u=(n.x===i?0:2)|Number(n.y&1n),a=s,h=Z.n>>1n;s>h&&o&&(a=Z.n-s,u^=1);let l=new nr(i,a);l.assertValidity();let d=c===!1?l.toCompactHex():l.toDERHex(),p=r?d:Pr(d);return f?[p,u]:p}async function Hw(t,e,r={}){return hd(await Fw(t,e),r,typeof t=="string")}Q.sign=Hw;function zw(t,e,r={}){return hd(Uw(t,e),r,typeof t=="string")}Q.signSync=zw;function Ww(t,e,r){let{n}=Z,i;try{i=ud(t)}catch(v){return!1}let{r:s,s:o}=i,c=qw(e);if(c===0n)return!1;let f=Y.fromAffine(Ic(r)),u=Ti(o,n),a=k(c*u,n),h=k(s*u,n),l=Y.BASE.multiply(a),d=f.multiplyUnsafe(h),p=l.add(d).toAffine();return k(p.x,n)===s}Q.verify=Ww;async function Ac(t,...e){let r=new Uint8Array(t.split("").map(s=>s.charCodeAt(0))),n=await Q.utils.sha256(r),i=await Q.utils.sha256(nd(n,n,...e));return ct(i)}async function ld(t,e,r){let n=no(t),i=await Ac("BIP0340/challenge",n,e.toRawX(),r);return k(i,Z.n)}function Cc(t){return k(t.y,2n)===0n}var an=class{constructor(e,r){if(this.r=e,this.s=r,e<=0n||r<=0n||e>=Z.P||r>=Z.n)throw new Error("Invalid signature")}static fromHex(e){let r=io(e);if(r.length!==64)throw new TypeError(`SchnorrSignature.fromHex: expected 64 bytes, not ${r.length}`);let n=ct(r.slice(0,32)),i=ct(r.slice(32));return new an(n,i)}toHex(){return Rr(this.r)+Rr(this.s)}toRawBytes(){return Pr(this.toHex())}};function $w(t){let e=X.fromPrivateKey(t);return typeof t=="string"?e.toHexX():e.toRawX()}async function Yw(t,e,r=Q.utils.randomBytes()){if(t==null)throw new TypeError(`sign: Expected valid message, not "${t}"`);e||(e=0n);let{n}=Z,i=io(t),s=qn(e),o=io(r);if(o.length!==32)throw new TypeError("sign: Expected 32 bytes of aux randomness");let c=X.fromPrivateKey(s),f=Cc(c)?s:n-s,u=await Ac("BIP0340/aux",o),a=f^u,h=await Ac("BIP0340/nonce",no(a),c.toRawX(),i),l=k(h,n);if(l===0n)throw new Error("sign: Creation of signature failed. k is zero");let d=X.fromPrivateKey(l),p=Cc(d)?l:n-l,y=await ld(d.x,c,i),v=new an(d.x,k(p+y*f,n));if(!await pd(v.toRawBytes(),i,c.toRawX()))throw new Error("sign: Invalid signature produced");return typeof t=="string"?v.toHex():v.toRawBytes()}async function pd(t,e,r){let n=t instanceof an?t:an.fromHex(t),i=typeof e=="string"?Pr(e):e,s=Ic(r),o=await ld(n.r,s,i),c=X.fromPrivateKey(n.s),f=s.multiply(o),u=c.subtract(f);return!(u.equals(X.BASE)||!Cc(u)||u.x!==n.r)}Q.schnorr={Signature:an,getPublicKey:$w,sign:Yw,verify:pd};X.BASE._setWindowSize(8);var et=(()=>{let t=typeof self=="object"&&"crypto"in self?self.crypto:void 0;return{node:typeof dd!="undefined"&&typeof pn=="function"&&!t?Dn():void 0,web:t}})();Q.utils={isValidPrivateKey(t){try{return qn(t),!0}catch(e){return!1}},randomBytes:(t=32)=>{if(et.web)return et.web.getRandomValues(new Uint8Array(t));if(et.node){let{randomBytes:e}=et.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>{let t=8;for(;t--;){let e=Q.utils.randomBytes(32),r=ct(e);if(Ri(r)&&r!==1n)return e}throw new Error("Valid private key was not found in 8 iterations. PRNG is broken")},sha256:async t=>{if(et.web){let e=await et.web.subtle.digest("SHA-256",t.buffer);return new Uint8Array(e)}else if(et.node){let{createHash:e}=et.node;return Uint8Array.from(e("sha256").update(t).digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(et.web){let r=await et.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=nd(...e),i=await et.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(et.node){let{createHmac:r}=et.node,n=r("sha256",t);for(let i of e)n.update(i);return Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,precompute(t=8,e=X.BASE){let r=e===X.BASE?e:new X(e.x,e.y);return r._setWindowSize(t),r.multiply(3n),r}}});var bd=m((t4,gd)=>{"use strict";var Pi=ce(),Dr=Bc(),{sha256:yd}=(vt(),nt);gd.exports=()=>{let t=32;function e(){return Dr.utils.randomPrivateKey()}async function r(u,a){let{digest:h}=await yd.digest(a);try{return await Dr.sign(h,u)}catch(l){throw Pi(l,"ERR_INVALID_INPUT")}}async function n(u,a,h){try{let{digest:l}=await yd.digest(h);return Dr.verify(a,l,u)}catch(l){throw Pi(l,"ERR_INVALID_INPUT")}}function i(u){return Dr.Point.fromHex(u).toRawBytes(!0)}function s(u){return Dr.Point.fromHex(u).toRawBytes(!1)}function o(u){try{Dr.getPublicKey(u,!0)}catch(a){throw Pi(a,"ERR_INVALID_PRIVATE_KEY")}}function c(u){try{Dr.Point.fromHex(u)}catch(a){throw Pi(a,"ERR_INVALID_PUBLIC_KEY")}}function f(u){try{return Dr.getPublicKey(u,!0)}catch(a){throw Pi(a,"ERR_INVALID_PRIVATE_KEY")}}return{generateKey:e,privateKeyLength:t,hashAndSign:r,hashAndVerify:n,compressPublicKey:i,decompressPublicKey:s,validatePrivateKey:o,validatePublicKey:c,computePublicKey:f}}});var wd=m((r4,xd)=>{"use strict";var{sha256:vd}=(vt(),nt),Qw=ce(),{equals:md}=(St(),_t),{toString:Jw}=(Ne(),ke),Zw=$s();xd.exports=(t,e,r)=>{r=r||bd()();class n{constructor(u){r.validatePublicKey(u),this._key=u}verify(u,a){return r.hashAndVerify(this._key,a,u)}marshal(){return r.compressPublicKey(this._key)}get bytes(){return t.PublicKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return md(this.bytes,u.bytes)}async hash(){let{bytes:u}=await vd.digest(this.bytes);return u}}class i{constructor(u,a){this._key=u,this._publicKey=a||r.computePublicKey(u),r.validatePrivateKey(this._key),r.validatePublicKey(this._publicKey)}sign(u){return r.hashAndSign(this._key,u)}get public(){return new n(this._publicKey)}marshal(){return this._key}get bytes(){return t.PrivateKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return md(this.bytes,u.bytes)}async hash(){let{bytes:u}=await vd.digest(this.bytes);return u}async id(){let u=await this.public.hash();return Jw(u,"base58btc")}async export(u,a="libp2p-key"){if(a==="libp2p-key")return Zw.export(this.bytes,u);throw Qw(new Error(`export format '${a}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function s(f){return new i(f)}function o(f){return new n(f)}async function c(){let f=await r.generateKey();return new i(f)}return{Secp256k1PublicKey:n,Secp256k1PrivateKey:i,unmarshalSecp256k1PrivateKey:s,unmarshalSecp256k1PublicKey:o,generateKeyPair:c}}});var _d=m((n4,Ed)=>{"use strict";Ed.exports={SHA1:20,SHA256:32,SHA512:64}});var Ad=m(Id=>{"use strict";var Sd=mi(),Xw=_d(),eE={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},tE=async(t,e)=>{let r=await Sd.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,r.byteOffset,r.byteLength)};Id.create=async function(t,e){let r=eE[t],n=await Sd.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(i){return tE(n,i)},length:Xw[t]}}});var Pd=m((s4,Rd)=>{"use strict";var Cd=ce(),{concat:Bd}=(Et(),wt),{fromString:rE}=(De(),Pe),nE=Ad(),Td={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};Rd.exports=async(t,e,r)=>{let n=Td[t];if(!n){let w=Object.keys(Td).join(" / ");throw Cd(new Error(`unknown cipher type '${t}'. Must be ${w}`),"ERR_INVALID_CIPHER_TYPE")}if(!e)throw Cd(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let i=n.keySize,s=n.ivSize,o=20,c=rE("key expansion"),f=2*(s+i+o),u=await nE.create(e,r),a=await u.digest(c),h=[],l=0;for(;l<f;){let w=await u.digest(Bd([a,c])),I=w.length;l+I>f&&(I=f-l),h.push(w),l+=I,a=await u.digest(a)}let d=f/2,p=Bd(h),y=p.slice(0,d),v=p.slice(d,f),b=w=>({iv:w.slice(0,s),cipherKey:w.slice(s,s+i),macKey:w.slice(s+i)});return{k1:b(y),k2:b(v)}}});var Od=m((o4,Dd)=>{"use strict";var iE=ce();Dd.exports=function(t,e){if(!t.includes(e)){let r=t.join(" / ");throw iE(new Error(`Unknown curve: ${e}. Must be ${r}`),"ERR_INVALID_CURVE")}}});var qd=m(Md=>{"use strict";var sE=ce(),Di=mi(),{base64urlToBuffer:kd}=Ws(),oE=Od(),{toString:Tc}=(Ne(),ke),{concat:aE}=(Et(),wt),{equals:cE}=(St(),_t),Nd={"P-256":256,"P-384":384,"P-521":521};Md.generateEphmeralKeyPair=async function(t){oE(Object.keys(Nd),t);let e=await Di.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(i,s)=>{let o;s?o=await Di.get().subtle.importKey("jwk",fE(t,s),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):o=e.privateKey;let c=[await Di.get().subtle.importKey("jwk",Kd(t,i),{name:"ECDH",namedCurve:t},!1,[]),o],f=await Di.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:c[0]},c[1],Nd[t]);return new Uint8Array(f,f.byteOffset,f.byteLength)},n=await Di.get().subtle.exportKey("jwk",e.publicKey);return{key:uE(n),genSharedKey:r}};var Ld={"P-256":32,"P-384":48,"P-521":66};function uE(t){let e=Ld[t.crv];return aE([Uint8Array.from([4]),kd(t.x,e),kd(t.y,e)],1+e*2)}function Kd(t,e){let r=Ld[t];if(cE(!e.slice(0,1),Uint8Array.from([4])))throw sE(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:Tc(e.slice(1,r+1),"base64url"),y:Tc(e.slice(1+r),"base64url"),ext:!0}}var fE=(t,e)=>({...Kd(t,e.public),d:Tc(e.private,"base64url")})});var Ud=m((c4,Fd)=>{"use strict";var hE=qd();Fd.exports=async t=>hE.generateEphmeralKeyPair(t)});var jd=m((u4,Vd)=>{"use strict";var Gt=Rs();Xr();fc();var Rc=W(),Oi=ce(),{fromString:lE}=(De(),Pe),pE=bp(),ft={rsa:Fp(),ed25519:ed(),secp256k1:wd()(Gt,yc())},oo={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function Fn(t){let e=ft[t.toLowerCase()];if(!e){let r=Object.keys(ft).join(" / ");throw Oi(new Error(`invalid or unsupported key type ${t}. Must be ${r}`),"ERR_UNSUPPORTED_KEY_TYPE")}return e}var dE=async(t,e)=>Fn(t).generateKeyPair(e),yE=async(t,e,r)=>{let n=Fn(t);if(t.toLowerCase()!=="ed25519")throw Oi(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return n.generateKeyPairFromSeed(e,r)},gE=t=>{let e=Gt.PublicKey.decode(t),r=e.Data;switch(e.Type){case Gt.KeyType.RSA:return ft.rsa.unmarshalRsaPublicKey(r);case Gt.KeyType.Ed25519:return ft.ed25519.unmarshalEd25519PublicKey(r);case Gt.KeyType.Secp256k1:if(ft.secp256k1)return ft.secp256k1.unmarshalSecp256k1PublicKey(r);throw Oi(new Error(oo.message),oo.code);default:Fn(e.Type)}},bE=(t,e)=>(e=(e||"rsa").toLowerCase(),Fn(e),t.bytes),Gd=async t=>{let e=Gt.PrivateKey.decode(t),r=e.Data;switch(e.Type){case Gt.KeyType.RSA:return ft.rsa.unmarshalRsaPrivateKey(r);case Gt.KeyType.Ed25519:return ft.ed25519.unmarshalEd25519PrivateKey(r);case Gt.KeyType.Secp256k1:if(ft.secp256k1)return ft.secp256k1.unmarshalSecp256k1PrivateKey(r);throw Oi(new Error(oo.message),oo.code);default:Fn(e.Type)}},vE=(t,e)=>(e=(e||"rsa").toLowerCase(),Fn(e),t.bytes),mE=async(t,e)=>{try{let i=await pE.import(t,e);return Gd(i)}catch(i){}let r=Rc.pki.decryptRsaPrivateKey(t,e);if(r===null)throw Oi(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let n=Rc.asn1.toDer(Rc.pki.privateKeyToAsn1(r));return n=lE(n.getBytes(),"ascii"),ft.rsa.unmarshalRsaPrivateKey(n)};Vd.exports={supportedKeys:ft,keysPBM:Gt,keyStretcher:Pd(),generateEphemeralKeyPair:Ud(),generateKeyPair:dE,generateKeyPairFromSeed:yE,unmarshalPublicKey:gE,marshalPublicKey:bE,unmarshalPrivateKey:Gd,marshalPrivateKey:vE,import:mE}});var Hd=m((f4,Pc)=>{"use strict";function xE(t,{className:e,symbolName:r}){let n=Symbol.for(r),i={[e]:class extends t{constructor(...s){super(...s);Object.defineProperty(this,n,{value:!0})}get[Symbol.toStringTag](){return e}}}[e];return i[`is${e}`]=s=>!!(s&&s[n]),i}function wE(t,{className:e,symbolName:r,withoutNew:n}){let i=Symbol.for(r),s={[e]:function(...o){if(n&&!(this instanceof s))return new s(...o);let c=t.call(this,...o)||this;return c&&!c[i]&&Object.defineProperty(c,i,{value:!0}),c}}[e];return s.prototype=Object.create(t.prototype),s.prototype.constructor=s,Object.defineProperty(s.prototype,Symbol.toStringTag,{get(){return e}}),s[`is${e}`]=o=>!!(o&&o[i]),s}Pc.exports=xE;Pc.exports.proto=wE});var $d=m((h4,Wd)=>{"use strict";var Un=Vr(),zd=Un.Reader,EE=Un.Writer,_e=Un.util,ki=Un.roots["libp2p-peer-id"]||(Un.roots["libp2p-peer-id"]={});ki.PeerIdProto=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.id=_e.newBuffer([]),t.prototype.pubKey=_e.newBuffer([]),t.prototype.privKey=_e.newBuffer([]),t.encode=function(r,n){return n||(n=EE.create()),n.uint32(10).bytes(r.id),r.pubKey!=null&&Object.hasOwnProperty.call(r,"pubKey")&&n.uint32(18).bytes(r.pubKey),r.privKey!=null&&Object.hasOwnProperty.call(r,"privKey")&&n.uint32(26).bytes(r.privKey),n},t.decode=function(r,n){r instanceof zd||(r=zd.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new ki.PeerIdProto;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.id=r.bytes();break;case 2:s.pubKey=r.bytes();break;case 3:s.privKey=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("id"))throw _e.ProtocolError("missing required 'id'",{instance:s});return s},t.fromObject=function(r){if(r instanceof ki.PeerIdProto)return r;var n=new ki.PeerIdProto;return r.id!=null&&(typeof r.id=="string"?_e.base64.decode(r.id,n.id=_e.newBuffer(_e.base64.length(r.id)),0):r.id.length&&(n.id=r.id)),r.pubKey!=null&&(typeof r.pubKey=="string"?_e.base64.decode(r.pubKey,n.pubKey=_e.newBuffer(_e.base64.length(r.pubKey)),0):r.pubKey.length&&(n.pubKey=r.pubKey)),r.privKey!=null&&(typeof r.privKey=="string"?_e.base64.decode(r.privKey,n.privKey=_e.newBuffer(_e.base64.length(r.privKey)),0):r.privKey.length&&(n.privKey=r.privKey)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(n.bytes===String?i.id="":(i.id=[],n.bytes!==Array&&(i.id=_e.newBuffer(i.id))),n.bytes===String?i.pubKey="":(i.pubKey=[],n.bytes!==Array&&(i.pubKey=_e.newBuffer(i.pubKey))),n.bytes===String?i.privKey="":(i.privKey=[],n.bytes!==Array&&(i.privKey=_e.newBuffer(i.privKey)))),r.id!=null&&r.hasOwnProperty("id")&&(i.id=n.bytes===String?_e.base64.encode(r.id,0,r.id.length):n.bytes===Array?Array.prototype.slice.call(r.id):r.id),r.pubKey!=null&&r.hasOwnProperty("pubKey")&&(i.pubKey=n.bytes===String?_e.base64.encode(r.pubKey,0,r.pubKey.length):n.bytes===Array?Array.prototype.slice.call(r.pubKey):r.pubKey),r.privKey!=null&&r.hasOwnProperty("privKey")&&(i.privKey=n.bytes===String?_e.base64.encode(r.privKey,0,r.privKey.length):n.bytes===Array?Array.prototype.slice.call(r.privKey):r.privKey),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Un.util.toJSONOptions)},t}();Wd.exports=ki});var Gn=m((Me,ry)=>{"use strict";var{CID:Dc}=(Ma(),Hh),_E=(si(),ii),SE=(ka(),Es),IE=(Qr(),Yr),AE=(Jr(),xr),{base58btc:Oc}=(Qr(),Yr),{base32:CE}=(si(),ii),{base16:Yd}=(Oa(),ws),Ni=(ui(),Ss),Vt=jd(),BE=Hd(),{PeerIdProto:Qd}=$d(),{equals:cn}=(St(),_t),{fromString:Li}=(De(),Pe),{toString:TE}=(Ne(),ke),{identity:ao}=(hi(),Tn),Jd={..._E,...SE,...IE,...AE},RE=Object.keys(Jd).reduce((t,e)=>t.or(Jd[e]),CE.decoder),PE=112,Zd=114,Xd=class{constructor(e,r,n){if(!(e instanceof Uint8Array))throw new Error("invalid id provided");if(r&&n&&!cn(r.public.bytes,n.bytes))throw new Error("inconsistent arguments");this._id=e,this._idB58String=Oc.encode(this.id).substring(1),this._privKey=r,this._pubKey=n}get id(){return this._id}set id(e){throw new Error("Id is immutable")}get privKey(){return this._privKey}set privKey(e){this._privKey=e}get pubKey(){if(this._pubKey)return this._pubKey;if(this._privKey)return this._privKey.public;try{let e=Ni.decode(this.id);e.code===ao.code&&(this._pubKey=Vt.unmarshalPublicKey(e.digest))}catch(e){}return this._pubKey}set pubKey(e){this._pubKey=e}marshalPubKey(){if(this.pubKey)return Vt.marshalPublicKey(this.pubKey)}marshalPrivKey(){if(this.privKey)return Vt.marshalPrivateKey(this.privKey)}marshal(e){return Qd.encode({id:this.toBytes(),pubKey:this.marshalPubKey(),privKey:e?null:this.marshalPrivKey()}).finish()}toPrint(){let e=this.toB58String();e.startsWith("Qm")&&(e=e.slice(2));let r=6;return e.length<r&&(r=e.length),"<peer.ID "+e.substr(0,r)+">"}toJSON(){return{id:this.toB58String(),privKey:ty(this.marshalPrivKey()),pubKey:ty(this.marshalPubKey())}}toHexString(){return Yd.encode(this.id).substring(1)}toBytes(){return this.id}toB58String(){return this._idB58String}toString(){if(!this._idCIDString){let e=Dc.createV1(Zd,Ni.decode(this.id));Object.defineProperty(this,"_idCIDString",{value:e.toString(),enumerable:!1})}return this._idCIDString}equals(e){if(e instanceof Uint8Array)return cn(this.id,e);if(e.id)return cn(this.id,e.id);throw new Error("not valid Id")}isEqual(e){return this.equals(e)}isValid(){return Boolean(this.privKey&&this.privKey.public&&this.privKey.public.bytes&&this.pubKey.bytes instanceof Uint8Array&&cn(this.privKey.public.bytes,this.pubKey.bytes))}hasInlinePublicKey(){try{if(Ni.decode(this.id).code===ao.code)return!0}catch(e){}return!1}},jt=BE(Xd,{className:"PeerId",symbolName:"@libp2p/js-peer-id/PeerId"});Me=ry.exports=jt;var Ki=t=>t.bytes.length<=42?Ni.create(ao.code,t.bytes).bytes:t.hash(),kc=async(t,e)=>{let r=await Ki(e);return new jt(r,t,e)};Me.create=async t=>{t=t||{},t.bits=t.bits||2048,t.keyType=t.keyType||"RSA";let e=await Vt.generateKeyPair(t.keyType,t.bits);return kc(e,e.public)};Me.createFromHexString=t=>new jt(Yd.decode("f"+t));Me.createFromBytes=t=>{try{let e=Dc.decode(t);if(!ey(e))throw new Error("Supplied PeerID CID is invalid");return Me.createFromCID(e)}catch{if(Ni.decode(t).code!==ao.code)throw new Error("Supplied PeerID CID is invalid");return new jt(t)}};Me.createFromB58String=t=>Me.createFromBytes(Oc.decode("z"+t));var ey=t=>t.code===Zd||t.code===PE;Me.createFromCID=t=>{if(t=Dc.asCID(t),!t||!ey(t))throw new Error("Supplied PeerID CID is invalid");return new jt(t.multihash.bytes)};Me.createFromPubKey=async t=>{let e=t;if(typeof e=="string"&&(e=Li(t,"base64pad")),!(e instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let r=await Vt.unmarshalPublicKey(e);return kc(void 0,r)};Me.createFromPrivKey=async t=>{if(typeof t=="string"&&(t=Li(t,"base64pad")),!(t instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let e=await Vt.unmarshalPrivateKey(t);return kc(e,e.public)};Me.createFromJSON=async t=>{let e=Oc.decode("z"+t.id),r=t.privKey&&Li(t.privKey,"base64pad"),n=t.pubKey&&Li(t.pubKey,"base64pad"),i=n&&await Vt.unmarshalPublicKey(n);if(!r)return new jt(e,void 0,i);let s=await Vt.unmarshalPrivateKey(r),o=await Ki(s.public),c;if(i&&(c=await Ki(i)),i&&!cn(o,c))throw new Error("Public and private key do not match");if(e&&!cn(o,e))throw new Error("Id and private key do not match");return new jt(e,s,i)};Me.createFromProtobuf=async t=>{typeof t=="string"&&(t=Li(t,"base16"));let{id:e,privKey:r,pubKey:n}=Qd.decode(t);r=r?await Vt.unmarshalPrivateKey(r):!1,n=n?await Vt.unmarshalPublicKey(n):!1;let i,s;if(r&&(s=await Ki(r.public)),n&&(i=await Ki(n)),r){if(n&&!cn(s,i))throw new Error("Public and private key do not match");return new jt(s,r,r.public)}if(n)return new jt(i,void 0,n);if(e)return new jt(e);throw new Error("Protobuf did not contain any usable key material")};Me.parse=t=>((t.charAt(0)==="1"||t.charAt(0)==="Q")&&(t=`z${t}`),Me.createFromBytes(RE.decode(t)));Me.isPeerId=t=>Boolean(typeof t=="object"&&t._id&&t._idB58String);function ty(t){if(t)return TE(t,"base64pad")}});var Nc=m((l4,sy)=>{"use strict";var DE=bh(),{toString:OE}=(Ne(),ke),{fromString:ny}=(De(),Pe),iy=Gn(),{sha256:kE}=(vt(),nt),NE=()=>DE(8),LE=(t,e)=>{let r;t instanceof Uint8Array?r=iy.createFromBytes(t).id:r=iy.parse(t).id;let n=new Uint8Array(r.length+e.length);return n.set(r,0),n.set(e,r.length),n},KE=t=>kE.encode(t),ME=(t,e)=>{let r;Array.isArray(e)?r=n=>e.indexOf(n)>-1:r=n=>e.has(n);for(let n of t)if(r(n))return!0;return!1},qE=t=>Array.isArray(t)?t:[t],FE=(t,e)=>{let r=Object.assign({},t);return t.from instanceof Uint8Array&&(r.from=OE(t.from,"base58btc")),e&&(r.receivedFrom=e),r},UE=t=>{let e=Object.assign({},t);return typeof t.from=="string"&&(e.from=ny(t.from,"base58btc")),typeof t.data=="string"&&(e.data=ny(t.data)),e};sy.exports={randomSeqno:NE,msgId:LE,noSignMsgId:KE,anyMatch:ME,ensureArray:qE,normalizeInRpcMessage:FE,normalizeOutRpcMessage:UE}});var fy=m((p4,uy)=>{"use strict";var Lc=Gn(),{RPC:oy}=aa(),{concat:ay}=(Et(),wt),{fromString:GE}=(De(),Pe),Kc=GE("libp2p-pubsub:"),{normalizeOutRpcMessage:VE}=Nc();async function jE(t,e){let r=ay([Kc,oy.Message.encode(VE(e)).finish()]),n=await t.privKey.sign(r);return{...e,signature:n,key:t.pubKey.bytes}}async function HE(t){if(!t.signature)throw new Error("Message must contain a signature to be verified");if(!t.from)throw new Error("Message must contain a from property to be verified");let e=ay([Kc,oy.Message.encode({...t,from:Lc.createFromB58String(t.from).toBytes(),signature:void 0,key:void 0}).finish()]);return(await cy(t)).verify(e,t.signature)}async function cy(t){if(!t.from)throw new Error("Could not get the public key from the originator id");let e=Lc.createFromB58String(t.from);if(t.key){let r=await Lc.createFromPubKey(t.key);if(r.equals(e))return r.pubKey;throw new Error("Public Key does not match the originator")}else{if(e.pubKey)return e.pubKey;throw new Error("Could not get the public key from the originator id")}}uy.exports={messagePublicKey:cy,signMessage:jE,SignPrefix:Kc,verifySignature:HE}});var dy=m((d4,py)=>{"use strict";var hy=Xi(),{EventEmitter:zE}=qo(),Je=ce(),{pipe:WE}=Uo(),{default:$E}=Nu(),YE=ju(),{codes:It}=os(),{RPC:ly}=aa(),QE=lh(),{SignaturePolicy:sr}=dh(),Or=Nc(),{signMessage:JE,verifySignature:ZE}=fy(),co=class extends zE{constructor({debugName:e,multicodecs:r,libp2p:n,globalSignaturePolicy:i=sr.StrictSign,canRelayMessage:s=!1,emitSelf:o=!1,messageProcessingConcurrency:c=10}){if(typeof e!="string")throw new Error("a debugname `string` is required");if(!r)throw new Error("multicodecs are required");if(!n)throw new Error("libp2p is required");super();if(this.log=Object.assign(hy(e),{err:hy(`${e}:error`)}),this.multicodecs=Or.ensureArray(r),this._libp2p=n,this.registrar=n.registrar,this.peerId=n.peerId,this.started=!1,this.topics=new Map,this.subscriptions=new Set,this.peers=new Map,!sr[i])throw Je(new Error("Invalid global signature policy"),It.ERR_INVALID_SIGNATURE_POLICY);this.globalSignaturePolicy=i,this.canRelayMessage=s,this.emitSelf=o,this.topicValidators=new Map,this.queue=new $E({concurrency:c}),this._registrarId=void 0,this._onIncomingStream=this._onIncomingStream.bind(this),this._onPeerConnected=this._onPeerConnected.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this)}start(){if(this.started)return;this.log("starting"),this.registrar.handle(this.multicodecs,this._onIncomingStream);let e=new YE({multicodecs:this.multicodecs,handlers:{onConnect:this._onPeerConnected,onDisconnect:this._onPeerDisconnected}});this._registrarId=this.registrar.register(e),this.log("started"),this.started=!0}stop(){!this.started||(this.registrar.unregister(this._registrarId),this.log("stopping"),this.peers.forEach(e=>e.close()),this.peers=new Map,this.subscriptions=new Set,this.started=!1,this.log("stopped"))}_onIncomingStream({protocol:e,stream:r,connection:n}){let i=n.remotePeer,s=i.toB58String(),o=this._addPeer(i,e),c=o.attachInboundStream(r);this._processMessages(s,c,o)}async _onPeerConnected(e,r){let n=e.toB58String();this.log("connected",n);try{let{stream:i,protocol:s}=await r.newStream(this.multicodecs);await this._addPeer(e,s).attachOutboundStream(i)}catch(i){this.log.err(i)}this._sendSubscriptions(n,Array.from(this.subscriptions),!0)}_onPeerDisconnected(e,r){let n=e.toB58String();this.log("connection ended",n,r?r.message:""),this._removePeer(e)}_addPeer(e,r){let n=e.toB58String(),i=this.peers.get(n);if(i)return i;this.log("new peer",n);let s=new QE({id:e,protocol:r});return this.peers.set(n,s),s.once("close",()=>this._removePeer(e)),s}_removePeer(e){if(!e)return;let r=e.toB58String(),n=this.peers.get(r);if(!!n){n.removeAllListeners(),n.close(),this.log("delete peer",r),this.peers.delete(r);for(let i of this.topics.values())i.delete(r);return n}}async _processMessages(e,r,n){try{await WE(r,async i=>{for await(let s of i){let o=s instanceof Uint8Array?s:s.slice(),c=this._decodeRpc(o);(async()=>{try{await this._processRpc(e,n,c)}catch(f){this.log.err(f)}})()}})}catch(i){this._onPeerDisconnected(n.id,i)}}async _processRpc(e,r,n){this.log("rpc from",e);let i=n.subscriptions,s=n.msgs;return i.length&&(i.forEach(o=>{this._processRpcSubOpt(e,o)}),this.emit("pubsub:subscription-change",r.id,i)),this._acceptFrom(e)?(s.length&&this.queue.addAll(s.map(o=>async()=>{if(!(this.canRelayMessage||o.topicIDs&&o.topicIDs.some(c=>this.subscriptions.has(c)))){this.log("received message we didn't subscribe to. Dropping.");return}try{let c=Or.normalizeInRpcMessage(o,e);await this._processRpcMessage(c)}catch(c){this.log.err(c)}})),!0):(this.log("received message from unacceptable peer %s",e),!1)}_processRpcSubOpt(e,r){let n=r.topicID;if(!n)return;let i=this.topics.get(n);i||(i=new Set,this.topics.set(n,i)),r.subscribe?i.add(e):i.delete(e)}async _processRpcMessage(e){if(!(this.peerId.toB58String()===e.from&&!this.emitSelf)){try{await this.validate(e)}catch(r){this.log("Message is invalid, dropping it. %O",r);return}return this._emitMessage(e),this._publish(Or.normalizeOutRpcMessage(e))}}_emitMessage(e){e.topicIDs.forEach(r=>{this.subscriptions.has(r)&&this.emit(r,e)})}getMsgId(e){let r=this.globalSignaturePolicy;switch(r){case sr.StrictSign:return Or.msgId(e.from,e.seqno);case sr.StrictNoSign:return Or.noSignMsgId(e.data);default:throw Je(new Error("Cannot get message id: unhandled signature policy: "+r),It.ERR_UNHANDLED_SIGNATURE_POLICY)}}_acceptFrom(e){return!0}_decodeRpc(e){return ly.decode(e)}_encodeRpc(e){return ly.encode(e).finish()}_sendRpc(e,r){let n=this.peers.get(e);if(!n||!n.isWritable){let i=`Cannot send RPC to ${e} as there is no open stream to it available`;this.log.err(i);return}n.write(this._encodeRpc(r))}_sendSubscriptions(e,r,n){return this._sendRpc(e,{subscriptions:r.map(i=>({topicID:i,subscribe:n}))})}async validate(e){let r=this.globalSignaturePolicy;switch(r){case sr.StrictNoSign:if(e.from)throw Je(new Error("StrictNoSigning: from should not be present"),It.ERR_UNEXPECTED_FROM);if(e.signature)throw Je(new Error("StrictNoSigning: signature should not be present"),It.ERR_UNEXPECTED_SIGNATURE);if(e.key)throw Je(new Error("StrictNoSigning: key should not be present"),It.ERR_UNEXPECTED_KEY);if(e.seqno)throw Je(new Error("StrictNoSigning: seqno should not be present"),It.ERR_UNEXPECTED_SEQNO);break;case sr.StrictSign:if(!e.signature)throw Je(new Error("StrictSigning: Signing required and no signature was present"),It.ERR_MISSING_SIGNATURE);if(!e.seqno)throw Je(new Error("StrictSigning: Signing required and no seqno was present"),It.ERR_MISSING_SEQNO);if(!await ZE(e))throw Je(new Error("StrictSigning: Invalid message signature"),It.ERR_INVALID_SIGNATURE);break;default:throw Je(new Error("Cannot validate message: unhandled signature policy: "+r),It.ERR_UNHANDLED_SIGNATURE_POLICY)}for(let n of e.topicIDs){let i=this.topicValidators.get(n);i&&await i(n,e)}}_buildMessage(e){let r=this.globalSignaturePolicy;switch(r){case sr.StrictSign:return e.from=this.peerId.toB58String(),e.seqno=Or.randomSeqno(),JE(this.peerId,e);case sr.StrictNoSign:return Promise.resolve(e);default:throw Je(new Error("Cannot build message: unhandled signature policy: "+r),It.ERR_UNHANDLED_SIGNATURE_POLICY)}}getSubscribers(e){if(!this.started)throw Je(new Error("not started yet"),"ERR_NOT_STARTED_YET");if(!e||typeof e!="string")throw Je(new Error("a string topic must be provided"),"ERR_NOT_VALID_TOPIC");let r=this.topics.get(e);return r?Array.from(r):[]}async publish(e,r){if(!this.started)throw new Error("Pubsub has not started");this.log("publish",e,r);let i={receivedFrom:this.peerId.toB58String(),data:r,topicIDs:[e]},s=await this._buildMessage(i),o=Or.normalizeInRpcMessage(s);this.emitSelf&&this._emitMessage(o),await this._publish(o)}_publish(e){throw Je(new Error("publish must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}subscribe(e){if(!this.started)throw new Error("Pubsub has not started");this.subscriptions.has(e)||(this.subscriptions.add(e),this.peers.forEach((r,n)=>this._sendSubscriptions(n,[e],!0)))}unsubscribe(e){if(!this.started)throw new Error("Pubsub is not started");this.subscriptions.has(e)&&this.listenerCount(e)===0&&(this.subscriptions.delete(e),this.peers.forEach((r,n)=>this._sendSubscriptions(n,[e],!1)))}getTopics(){if(!this.started)throw new Error("Pubsub is not started");return Array.from(this.subscriptions)}};co.utils=Or;co.SignaturePolicy=sr;py.exports=co});var yy=m(uo=>{"use strict";Object.defineProperty(uo,"__esModule",{value:!0});uo.createGossipRpc=void 0;function XE(t=[],e={}){return{subscriptions:[],msgs:t,control:Object.assign({ihave:[],iwant:[],graft:[],prune:[]},e)}}uo.createGossipRpc=XE});var gy=m(fo=>{"use strict";Object.defineProperty(fo,"__esModule",{value:!0});fo.shuffle=void 0;function e_(t){if(t.length<=1)return t;let e=()=>Math.floor(Math.random()*Math.floor(t.length));for(let r=0;r<t.length;r++){let n=e(),i=t[r];t[r]=t[n],t[n]=i}return t}fo.shuffle=e_});var un=m(R=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0});R.ERR_TOPIC_VALIDATOR_IGNORE=R.ERR_TOPIC_VALIDATOR_REJECT=R.TimeCacheDuration=R.GossipsubSeenTTL=R.GossipsubIWantFollowupTime=R.GossipsubMaxIHaveMessages=R.GossipsubMaxIHaveLength=R.GossipsubGraftFloodThreshold=R.GossipsubOpportunisticGraftPeers=R.GossipsubOpportunisticGraftTicks=R.GossipsubDirectConnectInitialDelay=R.GossipsubDirectConnectTicks=R.GossipsubConnectionTimeout=R.GossipsubMaxPendingConnections=R.GossipsubConnectors=R.GossipsubPruneBackoffTicks=R.GossipsubPruneBackoff=R.GossipsubPrunePeers=R.GossipsubFanoutTTL=R.GossipsubHeartbeatInterval=R.GossipsubHeartbeatInitialDelay=R.GossipsubGossipRetransmission=R.GossipsubGossipFactor=R.GossipsubDlazy=R.GossipsubHistoryGossip=R.GossipsubHistoryLength=R.GossipsubDout=R.GossipsubDscore=R.GossipsubDhi=R.GossipsubDlo=R.GossipsubD=R.GossipsubIDv11=R.GossipsubIDv10=R.FloodsubID=R.minute=R.second=void 0;R.second=1e3;R.minute=60*R.second;R.FloodsubID="/floodsub/1.0.0";R.GossipsubIDv10="/meshsub/1.0.0";R.GossipsubIDv11="/meshsub/1.1.0";R.GossipsubD=6;R.GossipsubDlo=4;R.GossipsubDhi=12;R.GossipsubDscore=4;R.GossipsubDout=2;R.GossipsubHistoryLength=5;R.GossipsubHistoryGossip=3;R.GossipsubDlazy=6;R.GossipsubGossipFactor=.25;R.GossipsubGossipRetransmission=3;R.GossipsubHeartbeatInitialDelay=100;R.GossipsubHeartbeatInterval=R.second;R.GossipsubFanoutTTL=R.minute;R.GossipsubPrunePeers=16;R.GossipsubPruneBackoff=R.minute;R.GossipsubPruneBackoffTicks=15;R.GossipsubConnectors=8;R.GossipsubMaxPendingConnections=128;R.GossipsubConnectionTimeout=30*R.second;R.GossipsubDirectConnectTicks=300;R.GossipsubDirectConnectInitialDelay=R.second;R.GossipsubOpportunisticGraftTicks=60;R.GossipsubOpportunisticGraftPeers=2;R.GossipsubGraftFloodThreshold=10*R.second;R.GossipsubMaxIHaveLength=5e3;R.GossipsubMaxIHaveMessages=10;R.GossipsubIWantFollowupTime=3*R.second;R.GossipsubSeenTTL=30*R.second;R.TimeCacheDuration=120*1e3;R.ERR_TOPIC_VALIDATOR_REJECT="ERR_TOPIC_VALIDATOR_REJECT";R.ERR_TOPIC_VALIDATOR_IGNORE="ERR_TOPIC_VALIDATOR_IGNORE"});var vy=m(ho=>{"use strict";Object.defineProperty(ho,"__esModule",{value:!0});ho.hasGossipProtocol=void 0;var by=un();function t_(t){return t===by.GossipsubIDv10||t===by.GossipsubIDv11}ho.hasGossipProtocol=t_});var my=m(lo=>{"use strict";Object.defineProperty(lo,"__esModule",{value:!0});lo.messageIdToString=void 0;var r_=(Ne(),ke);function n_(t){return r_.toString(t,"base64")}lo.messageIdToString=n_});var fn=m(Ht=>{"use strict";var i_=Ht&&Ht.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),po=Ht&&Ht.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&i_(e,t,r)};Object.defineProperty(Ht,"__esModule",{value:!0});po(yy(),Ht);po(gy(),Ht);po(vy(),Ht);po(my(),Ht)});var wy=m(Vn=>{"use strict";var s_=Vn&&Vn.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(a){try{u(n.next(a))}catch(h){o(h)}}function f(a){try{u(n.throw(a))}catch(h){o(h)}}function u(a){a.done?s(a.value):i(a.value).then(c,f)}u((n=n.apply(t,e||[])).next())})};Object.defineProperty(Vn,"__esModule",{value:!0});Vn.MessageCache=void 0;var yo=fn(),xy=class{constructor(e,r,n){this.msgs=new Map,this.peertx=new Map,this.history=[];for(let i=0;i<r;i++)this.history[i]=[];this.gossip=e,this.msgIdFn=n}put(e){return s_(this,void 0,void 0,function*(){let r=yield this.getMsgId(e),n=yo.messageIdToString(r);this.msgs.set(n,e),this.history[0].push({msgID:r,topics:e.topicIDs})})}getMsgId(e){return this.msgIdFn(e)}get(e){return this.msgs.get(yo.messageIdToString(e))}getForPeer(e,r){let n=yo.messageIdToString(e),i=this.msgs.get(n);if(!i)return[void 0,0];let s=this.peertx.get(n);s||(s=new Map,this.peertx.set(n,s));let o=(s.get(r)||0)+1;return s.set(r,o),[i,o]}getGossipIDs(e){let r=[];for(let n=0;n<this.gossip;n++)this.history[n].forEach(i=>{for(let s of i.topics)if(s===e){r.push(i.msgID);break}});return r}shift(){this.history[this.history.length-1].forEach(r=>{let n=yo.messageIdToString(r.msgID);this.msgs.delete(n),this.peertx.delete(n)}),this.history.pop(),this.history.unshift([])}};Vn.MessageCache=xy});var _y=m((Ey,Mi)=>{(function(t,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof pn=="function"&&typeof Mi=="object"&&Mi&&Mi.exports&&(Mi.exports=e(Vr()))})(Ey,function(t){"use strict";var e=t.Reader,r=t.Writer,n=t.util,i=t.roots.default||(t.roots.default={});return i.RPC=function(){function s(c){if(this.subscriptions=[],this.msgs=[],c)for(var f=Object.keys(c),u=0;u<f.length;++u)c[f[u]]!=null&&(this[f[u]]=c[f[u]])}s.prototype.subscriptions=n.emptyArray,s.prototype.msgs=n.emptyArray,s.prototype.control=null;var o;return Object.defineProperty(s.prototype,"_control",{get:n.oneOfGetter(o=["control"]),set:n.oneOfSetter(o)}),s.encode=function(f,u){if(u||(u=r.create()),f.subscriptions!=null&&f.subscriptions.length)for(var a=0;a<f.subscriptions.length;++a)i.RPC.SubOpts.encode(f.subscriptions[a],u.uint32(10).fork()).ldelim();if(f.msgs!=null&&f.msgs.length)for(var a=0;a<f.msgs.length;++a)i.RPC.Message.encode(f.msgs[a],u.uint32(18).fork()).ldelim();return f.control!=null&&Object.hasOwnProperty.call(f,"control")&&i.RPC.ControlMessage.encode(f.control,u.uint32(26).fork()).ldelim(),u},s.decode=function(f,u){f instanceof e||(f=e.create(f));for(var a=u===void 0?f.len:f.pos+u,h=new i.RPC;f.pos<a;){var l=f.uint32();switch(l>>>3){case 1:h.subscriptions&&h.subscriptions.length||(h.subscriptions=[]),h.subscriptions.push(i.RPC.SubOpts.decode(f,f.uint32()));break;case 2:h.msgs&&h.msgs.length||(h.msgs=[]),h.msgs.push(i.RPC.Message.decode(f,f.uint32()));break;case 3:h.control=i.RPC.ControlMessage.decode(f,f.uint32());break;default:f.skipType(l&7);break}}return h},s.fromObject=function(f){if(f instanceof i.RPC)return f;var u=new i.RPC;if(f.subscriptions){if(!Array.isArray(f.subscriptions))throw TypeError(".RPC.subscriptions: array expected");u.subscriptions=[];for(var a=0;a<f.subscriptions.length;++a){if(typeof f.subscriptions[a]!="object")throw TypeError(".RPC.subscriptions: object expected");u.subscriptions[a]=i.RPC.SubOpts.fromObject(f.subscriptions[a])}}if(f.msgs){if(!Array.isArray(f.msgs))throw TypeError(".RPC.msgs: array expected");u.msgs=[];for(var a=0;a<f.msgs.length;++a){if(typeof f.msgs[a]!="object")throw TypeError(".RPC.msgs: object expected");u.msgs[a]=i.RPC.Message.fromObject(f.msgs[a])}}if(f.control!=null){if(typeof f.control!="object")throw TypeError(".RPC.control: object expected");u.control=i.RPC.ControlMessage.fromObject(f.control)}return u},s.toObject=function(f,u){u||(u={});var a={};if((u.arrays||u.defaults)&&(a.subscriptions=[],a.msgs=[]),f.subscriptions&&f.subscriptions.length){a.subscriptions=[];for(var h=0;h<f.subscriptions.length;++h)a.subscriptions[h]=i.RPC.SubOpts.toObject(f.subscriptions[h],u)}if(f.msgs&&f.msgs.length){a.msgs=[];for(var h=0;h<f.msgs.length;++h)a.msgs[h]=i.RPC.Message.toObject(f.msgs[h],u)}return f.control!=null&&f.hasOwnProperty("control")&&(a.control=i.RPC.ControlMessage.toObject(f.control,u),u.oneofs&&(a._control="control")),a},s.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},s.SubOpts=function(){function c(u){if(u)for(var a=Object.keys(u),h=0;h<a.length;++h)u[a[h]]!=null&&(this[a[h]]=u[a[h]])}c.prototype.subscribe=null,c.prototype.topicID=null;var f;return Object.defineProperty(c.prototype,"_subscribe",{get:n.oneOfGetter(f=["subscribe"]),set:n.oneOfSetter(f)}),Object.defineProperty(c.prototype,"_topicID",{get:n.oneOfGetter(f=["topicID"]),set:n.oneOfSetter(f)}),c.encode=function(a,h){return h||(h=r.create()),a.subscribe!=null&&Object.hasOwnProperty.call(a,"subscribe")&&h.uint32(8).bool(a.subscribe),a.topicID!=null&&Object.hasOwnProperty.call(a,"topicID")&&h.uint32(18).string(a.topicID),h},c.decode=function(a,h){a instanceof e||(a=e.create(a));for(var l=h===void 0?a.len:a.pos+h,d=new i.RPC.SubOpts;a.pos<l;){var p=a.uint32();switch(p>>>3){case 1:d.subscribe=a.bool();break;case 2:d.topicID=a.string();break;default:a.skipType(p&7);break}}return d},c.fromObject=function(a){if(a instanceof i.RPC.SubOpts)return a;var h=new i.RPC.SubOpts;return a.subscribe!=null&&(h.subscribe=Boolean(a.subscribe)),a.topicID!=null&&(h.topicID=String(a.topicID)),h},c.toObject=function(a,h){h||(h={});var l={};return a.subscribe!=null&&a.hasOwnProperty("subscribe")&&(l.subscribe=a.subscribe,h.oneofs&&(l._subscribe="subscribe")),a.topicID!=null&&a.hasOwnProperty("topicID")&&(l.topicID=a.topicID,h.oneofs&&(l._topicID="topicID")),l},c.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},c}(),s.Message=function(){function c(u){if(this.topicIDs=[],u)for(var a=Object.keys(u),h=0;h<a.length;++h)u[a[h]]!=null&&(this[a[h]]=u[a[h]])}c.prototype.from=null,c.prototype.data=null,c.prototype.seqno=null,c.prototype.topicIDs=n.emptyArray,c.prototype.signature=null,c.prototype.key=null;var f;return Object.defineProperty(c.prototype,"_from",{get:n.oneOfGetter(f=["from"]),set:n.oneOfSetter(f)}),Object.defineProperty(c.prototype,"_data",{get:n.oneOfGetter(f=["data"]),set:n.oneOfSetter(f)}),Object.defineProperty(c.prototype,"_seqno",{get:n.oneOfGetter(f=["seqno"]),set:n.oneOfSetter(f)}),Object.defineProperty(c.prototype,"_signature",{get:n.oneOfGetter(f=["signature"]),set:n.oneOfSetter(f)}),Object.defineProperty(c.prototype,"_key",{get:n.oneOfGetter(f=["key"]),set:n.oneOfSetter(f)}),c.encode=function(a,h){if(h||(h=r.create()),a.from!=null&&Object.hasOwnProperty.call(a,"from")&&h.uint32(10).bytes(a.from),a.data!=null&&Object.hasOwnProperty.call(a,"data")&&h.uint32(18).bytes(a.data),a.seqno!=null&&Object.hasOwnProperty.call(a,"seqno")&&h.uint32(26).bytes(a.seqno),a.topicIDs!=null&&a.topicIDs.length)for(var l=0;l<a.topicIDs.length;++l)h.uint32(34).string(a.topicIDs[l]);return a.signature!=null&&Object.hasOwnProperty.call(a,"signature")&&h.uint32(42).bytes(a.signature),a.key!=null&&Object.hasOwnProperty.call(a,"key")&&h.uint32(50).bytes(a.key),h},c.decode=function(a,h){a instanceof e||(a=e.create(a));for(var l=h===void 0?a.len:a.pos+h,d=new i.RPC.Message;a.pos<l;){var p=a.uint32();switch(p>>>3){case 1:d.from=a.bytes();break;case 2:d.data=a.bytes();break;case 3:d.seqno=a.bytes();break;case 4:d.topicIDs&&d.topicIDs.length||(d.topicIDs=[]),d.topicIDs.push(a.string());break;case 5:d.signature=a.bytes();break;case 6:d.key=a.bytes();break;default:a.skipType(p&7);break}}return d},c.fromObject=function(a){if(a instanceof i.RPC.Message)return a;var h=new i.RPC.Message;if(a.from!=null&&(typeof a.from=="string"?n.base64.decode(a.from,h.from=n.newBuffer(n.base64.length(a.from)),0):a.from.length&&(h.from=a.from)),a.data!=null&&(typeof a.data=="string"?n.base64.decode(a.data,h.data=n.newBuffer(n.base64.length(a.data)),0):a.data.length&&(h.data=a.data)),a.seqno!=null&&(typeof a.seqno=="string"?n.base64.decode(a.seqno,h.seqno=n.newBuffer(n.base64.length(a.seqno)),0):a.seqno.length&&(h.seqno=a.seqno)),a.topicIDs){if(!Array.isArray(a.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");h.topicIDs=[];for(var l=0;l<a.topicIDs.length;++l)h.topicIDs[l]=String(a.topicIDs[l])}return a.signature!=null&&(typeof a.signature=="string"?n.base64.decode(a.signature,h.signature=n.newBuffer(n.base64.length(a.signature)),0):a.signature.length&&(h.signature=a.signature)),a.key!=null&&(typeof a.key=="string"?n.base64.decode(a.key,h.key=n.newBuffer(n.base64.length(a.key)),0):a.key.length&&(h.key=a.key)),h},c.toObject=function(a,h){h||(h={});var l={};if((h.arrays||h.defaults)&&(l.topicIDs=[]),a.from!=null&&a.hasOwnProperty("from")&&(l.from=h.bytes===String?n.base64.encode(a.from,0,a.from.length):h.bytes===Array?Array.prototype.slice.call(a.from):a.from,h.oneofs&&(l._from="from")),a.data!=null&&a.hasOwnProperty("data")&&(l.data=h.bytes===String?n.base64.encode(a.data,0,a.data.length):h.bytes===Array?Array.prototype.slice.call(a.data):a.data,h.oneofs&&(l._data="data")),a.seqno!=null&&a.hasOwnProperty("seqno")&&(l.seqno=h.bytes===String?n.base64.encode(a.seqno,0,a.seqno.length):h.bytes===Array?Array.prototype.slice.call(a.seqno):a.seqno,h.oneofs&&(l._seqno="seqno")),a.topicIDs&&a.topicIDs.length){l.topicIDs=[];for(var d=0;d<a.topicIDs.length;++d)l.topicIDs[d]=a.topicIDs[d]}return a.signature!=null&&a.hasOwnProperty("signature")&&(l.signature=h.bytes===String?n.base64.encode(a.signature,0,a.signature.length):h.bytes===Array?Array.prototype.slice.call(a.signature):a.signature,h.oneofs&&(l._signature="signature")),a.key!=null&&a.hasOwnProperty("key")&&(l.key=h.bytes===String?n.base64.encode(a.key,0,a.key.length):h.bytes===Array?Array.prototype.slice.call(a.key):a.key,h.oneofs&&(l._key="key")),l},c.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},c}(),s.ControlMessage=function(){function c(f){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],f)for(var u=Object.keys(f),a=0;a<u.length;++a)f[u[a]]!=null&&(this[u[a]]=f[u[a]])}return c.prototype.ihave=n.emptyArray,c.prototype.iwant=n.emptyArray,c.prototype.graft=n.emptyArray,c.prototype.prune=n.emptyArray,c.encode=function(u,a){if(a||(a=r.create()),u.ihave!=null&&u.ihave.length)for(var h=0;h<u.ihave.length;++h)i.RPC.ControlIHave.encode(u.ihave[h],a.uint32(10).fork()).ldelim();if(u.iwant!=null&&u.iwant.length)for(var h=0;h<u.iwant.length;++h)i.RPC.ControlIWant.encode(u.iwant[h],a.uint32(18).fork()).ldelim();if(u.graft!=null&&u.graft.length)for(var h=0;h<u.graft.length;++h)i.RPC.ControlGraft.encode(u.graft[h],a.uint32(26).fork()).ldelim();if(u.prune!=null&&u.prune.length)for(var h=0;h<u.prune.length;++h)i.RPC.ControlPrune.encode(u.prune[h],a.uint32(34).fork()).ldelim();return a},c.decode=function(u,a){u instanceof e||(u=e.create(u));for(var h=a===void 0?u.len:u.pos+a,l=new i.RPC.ControlMessage;u.pos<h;){var d=u.uint32();switch(d>>>3){case 1:l.ihave&&l.ihave.length||(l.ihave=[]),l.ihave.push(i.RPC.ControlIHave.decode(u,u.uint32()));break;case 2:l.iwant&&l.iwant.length||(l.iwant=[]),l.iwant.push(i.RPC.ControlIWant.decode(u,u.uint32()));break;case 3:l.graft&&l.graft.length||(l.graft=[]),l.graft.push(i.RPC.ControlGraft.decode(u,u.uint32()));break;case 4:l.prune&&l.prune.length||(l.prune=[]),l.prune.push(i.RPC.ControlPrune.decode(u,u.uint32()));break;default:u.skipType(d&7);break}}return l},c.fromObject=function(u){if(u instanceof i.RPC.ControlMessage)return u;var a=new i.RPC.ControlMessage;if(u.ihave){if(!Array.isArray(u.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");a.ihave=[];for(var h=0;h<u.ihave.length;++h){if(typeof u.ihave[h]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");a.ihave[h]=i.RPC.ControlIHave.fromObject(u.ihave[h])}}if(u.iwant){if(!Array.isArray(u.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");a.iwant=[];for(var h=0;h<u.iwant.length;++h){if(typeof u.iwant[h]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");a.iwant[h]=i.RPC.ControlIWant.fromObject(u.iwant[h])}}if(u.graft){if(!Array.isArray(u.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");a.graft=[];for(var h=0;h<u.graft.length;++h){if(typeof u.graft[h]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");a.graft[h]=i.RPC.ControlGraft.fromObject(u.graft[h])}}if(u.prune){if(!Array.isArray(u.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");a.prune=[];for(var h=0;h<u.prune.length;++h){if(typeof u.prune[h]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");a.prune[h]=i.RPC.ControlPrune.fromObject(u.prune[h])}}return a},c.toObject=function(u,a){a||(a={});var h={};if((a.arrays||a.defaults)&&(h.ihave=[],h.iwant=[],h.graft=[],h.prune=[]),u.ihave&&u.ihave.length){h.ihave=[];for(var l=0;l<u.ihave.length;++l)h.ihave[l]=i.RPC.ControlIHave.toObject(u.ihave[l],a)}if(u.iwant&&u.iwant.length){h.iwant=[];for(var l=0;l<u.iwant.length;++l)h.iwant[l]=i.RPC.ControlIWant.toObject(u.iwant[l],a)}if(u.graft&&u.graft.length){h.graft=[];for(var l=0;l<u.graft.length;++l)h.graft[l]=i.RPC.ControlGraft.toObject(u.graft[l],a)}if(u.prune&&u.prune.length){h.prune=[];for(var l=0;l<u.prune.length;++l)h.prune[l]=i.RPC.ControlPrune.toObject(u.prune[l],a)}return h},c.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},c}(),s.ControlIHave=function(){function c(u){if(this.messageIDs=[],u)for(var a=Object.keys(u),h=0;h<a.length;++h)u[a[h]]!=null&&(this[a[h]]=u[a[h]])}c.prototype.topicID=null,c.prototype.messageIDs=n.emptyArray;var f;return Object.defineProperty(c.prototype,"_topicID",{get:n.oneOfGetter(f=["topicID"]),set:n.oneOfSetter(f)}),c.encode=function(a,h){if(h||(h=r.create()),a.topicID!=null&&Object.hasOwnProperty.call(a,"topicID")&&h.uint32(10).string(a.topicID),a.messageIDs!=null&&a.messageIDs.length)for(var l=0;l<a.messageIDs.length;++l)h.uint32(18).bytes(a.messageIDs[l]);return h},c.decode=function(a,h){a instanceof e||(a=e.create(a));for(var l=h===void 0?a.len:a.pos+h,d=new i.RPC.ControlIHave;a.pos<l;){var p=a.uint32();switch(p>>>3){case 1:d.topicID=a.string();break;case 2:d.messageIDs&&d.messageIDs.length||(d.messageIDs=[]),d.messageIDs.push(a.bytes());break;default:a.skipType(p&7);break}}return d},c.fromObject=function(a){if(a instanceof i.RPC.ControlIHave)return a;var h=new i.RPC.ControlIHave;if(a.topicID!=null&&(h.topicID=String(a.topicID)),a.messageIDs){if(!Array.isArray(a.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");h.messageIDs=[];for(var l=0;l<a.messageIDs.length;++l)typeof a.messageIDs[l]=="string"?n.base64.decode(a.messageIDs[l],h.messageIDs[l]=n.newBuffer(n.base64.length(a.messageIDs[l])),0):a.messageIDs[l].length&&(h.messageIDs[l]=a.messageIDs[l])}return h},c.toObject=function(a,h){h||(h={});var l={};if((h.arrays||h.defaults)&&(l.messageIDs=[]),a.topicID!=null&&a.hasOwnProperty("topicID")&&(l.topicID=a.topicID,h.oneofs&&(l._topicID="topicID")),a.messageIDs&&a.messageIDs.length){l.messageIDs=[];for(var d=0;d<a.messageIDs.length;++d)l.messageIDs[d]=h.bytes===String?n.base64.encode(a.messageIDs[d],0,a.messageIDs[d].length):h.bytes===Array?Array.prototype.slice.call(a.messageIDs[d]):a.messageIDs[d]}return l},c.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},c}(),s.ControlIWant=function(){function c(f){if(this.messageIDs=[],f)for(var u=Object.keys(f),a=0;a<u.length;++a)f[u[a]]!=null&&(this[u[a]]=f[u[a]])}return c.prototype.messageIDs=n.emptyArray,c.encode=function(u,a){if(a||(a=r.create()),u.messageIDs!=null&&u.messageIDs.length)for(var h=0;h<u.messageIDs.length;++h)a.uint32(10).bytes(u.messageIDs[h]);return a},c.decode=function(u,a){u instanceof e||(u=e.create(u));for(var h=a===void 0?u.len:u.pos+a,l=new i.RPC.ControlIWant;u.pos<h;){var d=u.uint32();switch(d>>>3){case 1:l.messageIDs&&l.messageIDs.length||(l.messageIDs=[]),l.messageIDs.push(u.bytes());break;default:u.skipType(d&7);break}}return l},c.fromObject=function(u){if(u instanceof i.RPC.ControlIWant)return u;var a=new i.RPC.ControlIWant;if(u.messageIDs){if(!Array.isArray(u.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");a.messageIDs=[];for(var h=0;h<u.messageIDs.length;++h)typeof u.messageIDs[h]=="string"?n.base64.decode(u.messageIDs[h],a.messageIDs[h]=n.newBuffer(n.base64.length(u.messageIDs[h])),0):u.messageIDs[h].length&&(a.messageIDs[h]=u.messageIDs[h])}return a},c.toObject=function(u,a){a||(a={});var h={};if((a.arrays||a.defaults)&&(h.messageIDs=[]),u.messageIDs&&u.messageIDs.length){h.messageIDs=[];for(var l=0;l<u.messageIDs.length;++l)h.messageIDs[l]=a.bytes===String?n.base64.encode(u.messageIDs[l],0,u.messageIDs[l].length):a.bytes===Array?Array.prototype.slice.call(u.messageIDs[l]):u.messageIDs[l]}return h},c.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},c}(),s.ControlGraft=function(){function c(u){if(u)for(var a=Object.keys(u),h=0;h<a.length;++h)u[a[h]]!=null&&(this[a[h]]=u[a[h]])}c.prototype.topicID=null;var f;return Object.defineProperty(c.prototype,"_topicID",{get:n.oneOfGetter(f=["topicID"]),set:n.oneOfSetter(f)}),c.encode=function(a,h){return h||(h=r.create()),a.topicID!=null&&Object.hasOwnProperty.call(a,"topicID")&&h.uint32(10).string(a.topicID),h},c.decode=function(a,h){a instanceof e||(a=e.create(a));for(var l=h===void 0?a.len:a.pos+h,d=new i.RPC.ControlGraft;a.pos<l;){var p=a.uint32();switch(p>>>3){case 1:d.topicID=a.string();break;default:a.skipType(p&7);break}}return d},c.fromObject=function(a){if(a instanceof i.RPC.ControlGraft)return a;var h=new i.RPC.ControlGraft;return a.topicID!=null&&(h.topicID=String(a.topicID)),h},c.toObject=function(a,h){h||(h={});var l={};return a.topicID!=null&&a.hasOwnProperty("topicID")&&(l.topicID=a.topicID,h.oneofs&&(l._topicID="topicID")),l},c.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},c}(),s.ControlPrune=function(){function c(u){if(this.peers=[],u)for(var a=Object.keys(u),h=0;h<a.length;++h)u[a[h]]!=null&&(this[a[h]]=u[a[h]])}c.prototype.topicID=null,c.prototype.peers=n.emptyArray,c.prototype.backoff=null;var f;return Object.defineProperty(c.prototype,"_topicID",{get:n.oneOfGetter(f=["topicID"]),set:n.oneOfSetter(f)}),Object.defineProperty(c.prototype,"_backoff",{get:n.oneOfGetter(f=["backoff"]),set:n.oneOfSetter(f)}),c.encode=function(a,h){if(h||(h=r.create()),a.topicID!=null&&Object.hasOwnProperty.call(a,"topicID")&&h.uint32(10).string(a.topicID),a.peers!=null&&a.peers.length)for(var l=0;l<a.peers.length;++l)i.RPC.PeerInfo.encode(a.peers[l],h.uint32(18).fork()).ldelim();return a.backoff!=null&&Object.hasOwnProperty.call(a,"backoff")&&h.uint32(24).uint64(a.backoff),h},c.decode=function(a,h){a instanceof e||(a=e.create(a));for(var l=h===void 0?a.len:a.pos+h,d=new i.RPC.ControlPrune;a.pos<l;){var p=a.uint32();switch(p>>>3){case 1:d.topicID=a.string();break;case 2:d.peers&&d.peers.length||(d.peers=[]),d.peers.push(i.RPC.PeerInfo.decode(a,a.uint32()));break;case 3:d.backoff=a.uint64();break;default:a.skipType(p&7);break}}return d},c.fromObject=function(a){if(a instanceof i.RPC.ControlPrune)return a;var h=new i.RPC.ControlPrune;if(a.topicID!=null&&(h.topicID=String(a.topicID)),a.peers){if(!Array.isArray(a.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");h.peers=[];for(var l=0;l<a.peers.length;++l){if(typeof a.peers[l]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");h.peers[l]=i.RPC.PeerInfo.fromObject(a.peers[l])}}return a.backoff!=null&&(n.Long?(h.backoff=n.Long.fromValue(a.backoff)).unsigned=!0:typeof a.backoff=="string"?h.backoff=parseInt(a.backoff,10):typeof a.backoff=="number"?h.backoff=a.backoff:typeof a.backoff=="object"&&(h.backoff=new n.LongBits(a.backoff.low>>>0,a.backoff.high>>>0).toNumber(!0))),h},c.toObject=function(a,h){h||(h={});var l={};if((h.arrays||h.defaults)&&(l.peers=[]),a.topicID!=null&&a.hasOwnProperty("topicID")&&(l.topicID=a.topicID,h.oneofs&&(l._topicID="topicID")),a.peers&&a.peers.length){l.peers=[];for(var d=0;d<a.peers.length;++d)l.peers[d]=i.RPC.PeerInfo.toObject(a.peers[d],h)}return a.backoff!=null&&a.hasOwnProperty("backoff")&&(typeof a.backoff=="number"?l.backoff=h.longs===String?String(a.backoff):a.backoff:l.backoff=h.longs===String?n.Long.prototype.toString.call(a.backoff):h.longs===Number?new n.LongBits(a.backoff.low>>>0,a.backoff.high>>>0).toNumber(!0):a.backoff,h.oneofs&&(l._backoff="backoff")),l},c.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},c}(),s.PeerInfo=function(){function c(u){if(u)for(var a=Object.keys(u),h=0;h<a.length;++h)u[a[h]]!=null&&(this[a[h]]=u[a[h]])}c.prototype.peerID=null,c.prototype.signedPeerRecord=null;var f;return Object.defineProperty(c.prototype,"_peerID",{get:n.oneOfGetter(f=["peerID"]),set:n.oneOfSetter(f)}),Object.defineProperty(c.prototype,"_signedPeerRecord",{get:n.oneOfGetter(f=["signedPeerRecord"]),set:n.oneOfSetter(f)}),c.encode=function(a,h){return h||(h=r.create()),a.peerID!=null&&Object.hasOwnProperty.call(a,"peerID")&&h.uint32(10).bytes(a.peerID),a.signedPeerRecord!=null&&Object.hasOwnProperty.call(a,"signedPeerRecord")&&h.uint32(18).bytes(a.signedPeerRecord),h},c.decode=function(a,h){a instanceof e||(a=e.create(a));for(var l=h===void 0?a.len:a.pos+h,d=new i.RPC.PeerInfo;a.pos<l;){var p=a.uint32();switch(p>>>3){case 1:d.peerID=a.bytes();break;case 2:d.signedPeerRecord=a.bytes();break;default:a.skipType(p&7);break}}return d},c.fromObject=function(a){if(a instanceof i.RPC.PeerInfo)return a;var h=new i.RPC.PeerInfo;return a.peerID!=null&&(typeof a.peerID=="string"?n.base64.decode(a.peerID,h.peerID=n.newBuffer(n.base64.length(a.peerID)),0):a.peerID.length&&(h.peerID=a.peerID)),a.signedPeerRecord!=null&&(typeof a.signedPeerRecord=="string"?n.base64.decode(a.signedPeerRecord,h.signedPeerRecord=n.newBuffer(n.base64.length(a.signedPeerRecord)),0):a.signedPeerRecord.length&&(h.signedPeerRecord=a.signedPeerRecord)),h},c.toObject=function(a,h){h||(h={});var l={};return a.peerID!=null&&a.hasOwnProperty("peerID")&&(l.peerID=h.bytes===String?n.base64.encode(a.peerID,0,a.peerID.length):h.bytes===Array?Array.prototype.slice.call(a.peerID):a.peerID,h.oneofs&&(l._peerID="peerID")),a.signedPeerRecord!=null&&a.hasOwnProperty("signedPeerRecord")&&(l.signedPeerRecord=h.bytes===String?n.base64.encode(a.signedPeerRecord,0,a.signedPeerRecord.length):h.bytes===Array?Array.prototype.slice.call(a.signedPeerRecord):a.signedPeerRecord,h.oneofs&&(l._signedPeerRecord="signedPeerRecord")),l},c.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},c}(),s}(),i})});var Mc=m(go=>{"use strict";Object.defineProperty(go,"__esModule",{value:!0});go.getGossipPeers=void 0;var Sy=fn();function o_(t,e,r,n=()=>!0){let i=t.topics.get(e);if(!i)return new Set;let s=[];return i.forEach(o=>{let c=t.peers.get(o);!c||Sy.hasGossipProtocol(c.protocol)&&n(o)&&s.push(o)}),s=Sy.shuffle(s),r>0&&s.length>r&&(s=s.slice(0,r)),new Set(s)}go.getGossipPeers=o_});var Ay=m(zt=>{"use strict";var a_=zt&&zt.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),c_=zt&&zt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u_=zt&&zt.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&a_(e,t,r);return c_(e,t),e};Object.defineProperty(zt,"__esModule",{value:!0});zt.Heartbeat=void 0;var qc=u_(un()),bo=Mc(),f_=fn(),Iy=class{constructor(e){this.gossipsub=e}start(){if(this._heartbeatTimer)return;let e=this._heartbeat.bind(this),r=setTimeout(()=>{e(),this._heartbeatTimer.runPeriodically(e,this.gossipsub._options.heartbeatInterval)},qc.GossipsubHeartbeatInitialDelay);this._heartbeatTimer={_intervalId:void 0,runPeriodically:(n,i)=>{this._heartbeatTimer._intervalId=setInterval(n,i)},cancel:()=>{clearTimeout(r),clearInterval(this._heartbeatTimer._intervalId)}}}stop(){!this._heartbeatTimer||(this._heartbeatTimer.cancel(),this._heartbeatTimer=null)}_heartbeat(){let{D:e,Dlo:r,Dhi:n,Dscore:i,Dout:s,fanoutTTL:o}=this.gossipsub._options;this.gossipsub.heartbeatTicks++;let c=new Map,f=d=>{let p=c.get(d);return p===void 0&&(p=this.gossipsub.score.score(d),c.set(d,p)),p},u=new Map,a=new Map,h=new Map;this.gossipsub._clearBackoff(),this.gossipsub.peerhave.clear(),this.gossipsub.iasked.clear(),this.gossipsub._applyIwantPenalties(),this.gossipsub._directConnect(),this.gossipsub.mesh.forEach((d,p)=>{let y=b=>{this.gossipsub.log("HEARTBEAT: Remove mesh link to %s in %s",b,p),this.gossipsub.score.prune(b,p),this.gossipsub._addBackoff(b,p),d.delete(b);let w=a.get(b);w?w.push(p):a.set(b,[p])},v=b=>{this.gossipsub.log("HEARTBEAT: Add mesh link to %s in %s",b,p),this.gossipsub.score.graft(b,p),d.add(b);let w=u.get(b);w?w.push(p):u.set(b,[p])};if(d.forEach(b=>{let w=f(b);w<0&&(this.gossipsub.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",b,w,p),y(b),h.set(b,!0))}),d.size<r){let b=this.gossipsub.backoff.get(p),w=e-d.size;bo.getGossipPeers(this.gossipsub,p,w,P=>!d.has(P)&&!this.gossipsub.direct.has(P)&&(!b||!b.has(P))&&f(P)>=0).forEach(v)}if(d.size>n){let b=Array.from(d);b.sort((I,P)=>f(P)-f(I)),b=b.slice(0,i).concat(f_.shuffle(b.slice(i)));let w=0;if(b.slice(0,e).forEach(I=>{this.gossipsub.outbound.get(I)&&w++}),w<s){let I=T=>{let S=b[T];for(let K=T;K>0;K--)b[K]=b[K-1];b[0]=S};if(w>0){let T=w;for(let S=1;S<e&&T>0;S++)this.gossipsub.outbound.get(b[S])&&(I(S),T--)}let P=e-w;for(let T=e;T<b.length&&P>0;T++)this.gossipsub.outbound.get(b[T])&&(I(T),P--)}b.slice(e).forEach(y)}if(d.size>=r){let b=0;if(d.forEach(w=>{this.gossipsub.outbound.get(w)&&b++}),b<s){let w=s-b,I=this.gossipsub.backoff.get(p);bo.getGossipPeers(this.gossipsub,p,w,P=>!d.has(P)&&!this.gossipsub.direct.has(P)&&(!I||!I.has(P))&&f(P)>=0).forEach(v)}}if(this.gossipsub.heartbeatTicks%qc.GossipsubOpportunisticGraftTicks==0&&d.size>1){let b=Array.from(d).sort((P,T)=>f(P)-f(T)),w=Math.floor(d.size/2),I=f(b[w]);if(I<this.gossipsub._options.scoreThresholds.opportunisticGraftThreshold){let P=this.gossipsub.backoff.get(p);bo.getGossipPeers(this.gossipsub,p,qc.GossipsubOpportunisticGraftPeers,S=>d.has(S)&&!this.gossipsub.direct.has(S)&&(!P||!P.has(S))&&f(S)>I).forEach(S=>{this.gossipsub.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",S,p),v(S)})}}this.gossipsub._emitGossip(p,d)});let l=this.gossipsub._now();this.gossipsub.lastpub.forEach((d,p)=>{d+o<l&&(this.gossipsub.fanout.delete(p),this.gossipsub.lastpub.delete(p))}),this.gossipsub.fanout.forEach((d,p)=>{let y=this.gossipsub.topics.get(p);if(d.forEach(v=>{(!y.has(v)||f(v)<this.gossipsub._options.scoreThresholds.publishThreshold)&&d.delete(v)}),d.size<e){let v=e-d.size;bo.getGossipPeers(this.gossipsub,p,v,w=>!d.has(w)&&!this.gossipsub.direct.has(w)&&f(w)>=this.gossipsub._options.scoreThresholds.publishThreshold).forEach(w=>{d.add(w)})}this.gossipsub._emitGossip(p,d)}),this.gossipsub._sendGraftPrune(u,a,h),this.gossipsub._flush(),this.gossipsub.messageCache.shift(),this.gossipsub.emit("gossipsub:heartbeat")}};zt.Heartbeat=Iy});var Fc=m(jn=>{"use strict";Object.defineProperty(jn,"__esModule",{value:!0});jn.ERR_INVALID_PEER_SCORE_THRESHOLDS=jn.ERR_INVALID_PEER_SCORE_PARAMS=void 0;jn.ERR_INVALID_PEER_SCORE_PARAMS="ERR_INVALID_PEER_SCORE_PARAMS";jn.ERR_INVALID_PEER_SCORE_THRESHOLDS="ERR_INVALID_PEER_SCORE_THRESHOLDS"});var Uc=m(qe=>{"use strict";Object.defineProperty(qe,"__esModule",{value:!0});qe.validateTopicScoreParams=qe.validatePeerScoreParams=qe.createTopicScoreParams=qe.createPeerScoreParams=qe.defaultTopicScoreParams=qe.defaultPeerScoreParams=void 0;var ne=Fc(),ie=ce();qe.defaultPeerScoreParams={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3};qe.defaultTopicScoreParams={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function h_(t={}){return Object.assign(Object.assign(Object.assign({},qe.defaultPeerScoreParams),t),{topics:t.topics?Object.entries(t.topics).reduce((e,[r,n])=>(e[r]=Cy(n),e),{}):{}})}qe.createPeerScoreParams=h_;function Cy(t={}){return Object.assign(Object.assign({},qe.defaultTopicScoreParams),t)}qe.createTopicScoreParams=Cy;function l_(t){for(let[e,r]of Object.entries(t.topics))try{By(r)}catch(n){throw ie(new Error(`invalid score parameters for topic ${e}: ${n.message}`),ne.ERR_INVALID_PEER_SCORE_PARAMS)}if(t.topicScoreCap<0)throw ie(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.appSpecificScore===null||t.appSpecificScore===void 0)throw ie(new Error("missing application specific score function"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.IPColocationFactorWeight>0)throw ie(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.IPColocationFactorWeight!==0&&t.IPColocationFactorThreshold<1)throw ie(new Error("invalid IPColocationFactorThreshold; must be at least 1"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.behaviourPenaltyWeight>0)throw ie(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.behaviourPenaltyWeight!==0&&(t.behaviourPenaltyDecay<=0||t.behaviourPenaltyDecay>=1))throw ie(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.decayInterval<1e3)throw ie(new Error("invalid DecayInterval; must be at least 1s"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.decayToZero<=0||t.decayToZero>=1)throw ie(new Error("invalid DecayToZero; must be between 0 and 1"),ne.ERR_INVALID_PEER_SCORE_PARAMS)}qe.validatePeerScoreParams=l_;function By(t){if(t.topicWeight<0)throw ie(new Error("invalid topic weight; must be >= 0"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshQuantum===0)throw ie(new Error("invalid TimeInMeshQuantum; must be non zero"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight<0)throw ie(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight!==0&&t.timeInMeshQuantum<=0)throw ie(new Error("invalid TimeInMeshQuantum; must be positive"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.timeInMeshWeight!==0&&t.timeInMeshCap<=0)throw ie(new Error("invalid TimeInMeshCap; must be positive"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight<0)throw ie(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight!==0&&(t.firstMessageDeliveriesDecay<=0||t.firstMessageDeliveriesDecay>=1))throw ie(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.firstMessageDeliveriesWeight!==0&&t.firstMessageDeliveriesCap<=0)throw ie(new Error("invalid FirstMessageDeliveriesCap; must be positive"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight>0)throw ie(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&(t.meshMessageDeliveriesDecay<=0||t.meshMessageDeliveriesDecay>=1))throw ie(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesCap<=0)throw ie(new Error("invalid MeshMessageDeliveriesCap; must be positive"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesThreshold<=0)throw ie(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWindow<0)throw ie(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesActivation<1e3)throw ie(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshFailurePenaltyWeight>0)throw ie(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.meshFailurePenaltyWeight!==0&&(t.meshFailurePenaltyDecay<=0||t.meshFailurePenaltyDecay>=1))throw ie(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.invalidMessageDeliveriesWeight>0)throw ie(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),ne.ERR_INVALID_PEER_SCORE_PARAMS);if(t.invalidMessageDeliveriesDecay<=0||t.invalidMessageDeliveriesDecay>=1)throw ie(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),ne.ERR_INVALID_PEER_SCORE_PARAMS)}qe.validateTopicScoreParams=By});var Ty=m(or=>{"use strict";Object.defineProperty(or,"__esModule",{value:!0});or.validatePeerScoreThresholds=or.createPeerScoreThresholds=or.defaultPeerScoreThresholds=void 0;var qi=Fc(),Fi=ce();or.defaultPeerScoreThresholds={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function p_(t={}){return Object.assign(Object.assign({},or.defaultPeerScoreThresholds),t)}or.createPeerScoreThresholds=p_;function d_(t){if(t.gossipThreshold>0)throw Fi(new Error("invalid gossip threshold; it must be <= 0"),qi.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.publishThreshold>0||t.publishThreshold>t.gossipThreshold)throw Fi(new Error("invalid publish threshold; it must be <= 0 and <= gossip threshold"),qi.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.graylistThreshold>0||t.graylistThreshold>t.publishThreshold)throw Fi(new Error("invalid graylist threshold; it must be <= 0 and <= publish threshold"),qi.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.acceptPXThreshold<0)throw Fi(new Error("invalid accept PX threshold; it must be >= 0"),qi.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(t.opportunisticGraftThreshold<0)throw Fi(new Error("invalid opportunistic grafting threshold; it must be >= 0"),qi.ERR_INVALID_PEER_SCORE_THRESHOLDS)}or.validatePeerScoreThresholds=d_});var Ry=m(kr=>{"use strict";Object.defineProperty(kr,"__esModule",{value:!0});kr.ensureTopicStats=kr.createTopicStats=kr.createPeerStats=void 0;function y_(t={}){return Object.assign(Object.assign({connected:!1,expire:0,ips:[],behaviourPenalty:0},t),{topics:t.topics?Object.entries(t.topics).reduce((e,[r,n])=>(e[r]=Gc(n),e),{}):{}})}kr.createPeerStats=y_;function Gc(t={}){return Object.assign({inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},t)}kr.createTopicStats=Gc;function g_(t,e,r){let n=e.topics[t];if(n)return n;if(!!r.topics[t])return e.topics[t]=n=Gc(),n}kr.ensureTopicStats=g_});var Py=m(vo=>{"use strict";Object.defineProperty(vo,"__esModule",{value:!0});vo.computeScore=void 0;function b_(t,e,r,n){let i=0;return Object.entries(e.topics).forEach(([c,f])=>{let u=r.topics[c];if(!u)return;let a=0;if(f.inMesh){let p=f.meshTime/u.timeInMeshQuantum;p>u.timeInMeshCap&&(p=u.timeInMeshCap),a+=p*u.timeInMeshWeight}if(a+=f.firstMessageDeliveries*u.firstMessageDeliveriesWeight,f.meshMessageDeliveriesActive&&f.meshMessageDeliveries<u.meshMessageDeliveriesThreshold){let p=u.meshMessageDeliveriesThreshold-f.meshMessageDeliveries;a+=p*p*u.meshMessageDeliveriesWeight}a+=f.meshFailurePenalty*u.meshFailurePenaltyWeight,a+=f.invalidMessageDeliveries*f.invalidMessageDeliveries*u.invalidMessageDeliveriesWeight,i+=a*u.topicWeight}),r.topicScoreCap>0&&i>r.topicScoreCap&&(i=r.topicScoreCap),i+=r.appSpecificScore(t)*r.appSpecificWeight,e.ips.forEach(c=>{if(r.IPColocationFactorWhitelist.has(c))return;let f=n.get(c),u=f?f.size:0;if(u>r.IPColocationFactorThreshold){let a=u-r.IPColocationFactorThreshold;i+=a*a*r.IPColocationFactorWeight}}),i+=e.behaviourPenalty*e.behaviourPenalty*r.behaviourPenaltyWeight,i}vo.computeScore=b_});var Oy=m((T4,Dy)=>{"use strict";function be(t,e){var e=e||{};this._head=0,this._tail=0,this._capacity=e.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(t)&&this._fromArray(t)}be.prototype.peekAt=function(e){var r=e;if(r===(r|0)){var n=this.size();if(!(r>=n||r<-n))return r<0&&(r+=n),r=this._head+r&this._capacityMask,this._list[r]}};be.prototype.get=function(e){return this.peekAt(e)};be.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};be.prototype.peekFront=function(){return this.peek()};be.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(be.prototype,"length",{get:function(){return this.size()}});be.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};be.prototype.unshift=function(e){if(e===void 0)return this.size();var r=this._list.length;return this._head=this._head-1+r&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};be.prototype.shift=function(){var e=this._head;if(e!==this._tail){var r=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),r}};be.prototype.push=function(e){if(e===void 0)return this.size();var r=this._tail;return this._list[r]=e,this._tail=r+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};be.prototype.pop=function(){var e=this._tail;if(e!==this._head){var r=this._list.length;this._tail=e-1+r&this._capacityMask;var n=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=r>>>2&&this._shrinkArray(),n}};be.prototype.removeOne=function(e){var r=e;if(r===(r|0)&&this._head!==this._tail){var n=this.size(),i=this._list.length;if(!(r>=n||r<-n)){r<0&&(r+=n),r=this._head+r&this._capacityMask;var s=this._list[r],o;if(e<n/2){for(o=e;o>0;o--)this._list[r]=this._list[r=r-1+i&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+i&this._capacityMask}else{for(o=n-1-e;o>0;o--)this._list[r]=this._list[r=r+1+i&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+i&this._capacityMask}return s}}};be.prototype.remove=function(e,r){var n=e,i,s=r;if(n===(n|0)&&this._head!==this._tail){var o=this.size(),c=this._list.length;if(!(n>=o||n<-o||r<1)){if(n<0&&(n+=o),r===1||!r)return i=new Array(1),i[0]=this.removeOne(n),i;if(n===0&&n+r>=o)return i=this.toArray(),this.clear(),i;n+r>o&&(r=o-n);var f;for(i=new Array(r),f=0;f<r;f++)i[f]=this._list[this._head+n+f&this._capacityMask];if(n=this._head+n&this._capacityMask,e+r===o){for(this._tail=this._tail-r+c&this._capacityMask,f=r;f>0;f--)this._list[n=n+1+c&this._capacityMask]=void 0;return i}if(e===0){for(this._head=this._head+r+c&this._capacityMask,f=r-1;f>0;f--)this._list[n=n+1+c&this._capacityMask]=void 0;return i}if(n<o/2){for(this._head=this._head+e+r+c&this._capacityMask,f=e;f>0;f--)this.unshift(this._list[n=n-1+c&this._capacityMask]);for(n=this._head-1+c&this._capacityMask;s>0;)this._list[n=n-1+c&this._capacityMask]=void 0,s--;e<0&&(this._tail=n)}else{for(this._tail=n,n=n+r+c&this._capacityMask,f=o-(r+e);f>0;f--)this.push(this._list[n++]);for(n=this._tail;s>0;)this._list[n=n+1+c&this._capacityMask]=void 0,s--}return this._head<2&&this._tail>1e4&&this._tail<=c>>>2&&this._shrinkArray(),i}}};be.prototype.splice=function(e,r){var n=e;if(n===(n|0)){var i=this.size();if(n<0&&(n+=i),!(n>i))if(arguments.length>2){var s,o,c,f=arguments.length,u=this._list.length,a=2;if(!i||n<i/2){for(o=new Array(n),s=0;s<n;s++)o[s]=this._list[this._head+s&this._capacityMask];for(r===0?(c=[],n>0&&(this._head=this._head+n+u&this._capacityMask)):(c=this.remove(n,r),this._head=this._head+n+u&this._capacityMask);f>a;)this.unshift(arguments[--f]);for(s=n;s>0;s--)this.unshift(o[s-1])}else{o=new Array(i-(n+r));var h=o.length;for(s=0;s<h;s++)o[s]=this._list[this._head+n+r+s&this._capacityMask];for(r===0?(c=[],n!=i&&(this._tail=this._head+n+u&this._capacityMask)):(c=this.remove(n,r),this._tail=this._tail-h+u&this._capacityMask);a<f;)this.push(arguments[a++]);for(s=0;s<h;s++)this.push(o[s])}return c}else return this.remove(n,r)}};be.prototype.clear=function(){this._head=0,this._tail=0};be.prototype.isEmpty=function(){return this._head===this._tail};be.prototype.toArray=function(){return this._copyArray(!1)};be.prototype._fromArray=function(e){for(var r=0;r<e.length;r++)this.push(e[r])};be.prototype._copyArray=function(e){var r=[],n=this._list,i=n.length,s;if(e||this._head>this._tail){for(s=this._head;s<i;s++)r.push(n[s]);for(s=0;s<this._tail;s++)r.push(n[s])}else for(s=this._head;s<this._tail;s++)r.push(n[s]);return r};be.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1};be.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};Dy.exports=be});var Ly=m(ar=>{"use strict";var v_=ar&&ar.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ar,"__esModule",{value:!0});ar.MessageDeliveries=ar.DeliveryRecordStatus=void 0;var m_=un(),x_=v_(Oy()),w_=fn(),ky;(function(t){t[t.unknown=0]="unknown",t[t.valid=1]="valid",t[t.invalid=2]="invalid",t[t.ignored=3]="ignored"})(ky=ar.DeliveryRecordStatus||(ar.DeliveryRecordStatus={}));var Ny=class{constructor(){this.records=new Map,this.queue=new x_.default}ensureRecord(e){let r=w_.messageIdToString(e),n=this.records.get(r);if(n)return n;n={status:ky.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(r,n);let i={msgId:r,expire:Date.now()+m_.TimeCacheDuration};return this.queue.push(i),n}gc(){let e=Date.now(),r=this.queue.peekFront();for(;r&&r.expire<e;)this.records.delete(r.msgId),this.queue.shift(),r=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}};ar.MessageDeliveries=Ny});var My=m(Nr=>{"use strict";var mo=Nr&&Nr.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(a){try{u(n.next(a))}catch(h){o(h)}}function f(a){try{u(n.throw(a))}catch(h){o(h)}}function u(a){a.done?s(a.value):i(a.value).then(c,f)}u((n=n.apply(t,e||[])).next())})},E_=Nr&&Nr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Nr,"__esModule",{value:!0});Nr.PeerScore=void 0;var __=Uc(),Hn=Ry(),S_=Py(),At=Ly(),I_=un(),A_=E_(Gn()),C_=Xi(),B_=os(),{ERR_INVALID_SIGNATURE:T_,ERR_MISSING_SIGNATURE:R_}=B_.codes,zn=C_("libp2p:gossipsub:score"),Ky=class{constructor(e,r,n){__.validatePeerScoreParams(e),this.params=e,this._connectionManager=r,this.peerStats=new Map,this.peerIPs=new Map,this.deliveryRecords=new At.MessageDeliveries,this.msgId=n}start(){if(this._backgroundInterval){zn("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),zn("started")}stop(){if(!this._backgroundInterval){zn("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),zn("stopped")}background(){this._refreshScores(),this._updateIPs(),this.deliveryRecords.gc()}_refreshScores(){let e=Date.now(),r=this.params.decayToZero;this.peerStats.forEach((n,i)=>{if(!n.connected){e>n.expire&&(this._removeIPs(i,n.ips),this.peerStats.delete(i));return}Object.entries(n.topics).forEach(([s,o])=>{let c=this.params.topics[s];!c||(o.firstMessageDeliveries*=c.firstMessageDeliveriesDecay,o.firstMessageDeliveries<r&&(o.firstMessageDeliveries=0),o.meshMessageDeliveries*=c.meshMessageDeliveriesDecay,o.meshMessageDeliveries<r&&(o.meshMessageDeliveries=0),o.meshFailurePenalty*=c.meshFailurePenaltyDecay,o.meshFailurePenalty<r&&(o.meshFailurePenalty=0),o.invalidMessageDeliveries*=c.invalidMessageDeliveriesDecay,o.invalidMessageDeliveries<r&&(o.invalidMessageDeliveries=0),o.inMesh&&(o.meshTime=e-o.graftTime,o.meshTime>c.meshMessageDeliveriesActivation&&(o.meshMessageDeliveriesActive=!0)))}),n.behaviourPenalty*=this.params.behaviourPenaltyDecay,n.behaviourPenalty<r&&(n.behaviourPenalty=0)})}score(e){let r=this.peerStats.get(e);return r?S_.computeScore(e,r,this.params,this.peerIPs):0}addPenalty(e,r){let n=this.peerStats.get(e);!n||(n.behaviourPenalty+=r)}addPeer(e){let r=Hn.createPeerStats({connected:!0});this.peerStats.set(e,r);let n=this._getIPs(e);this._setIPs(e,n,r.ips),r.ips=n}removePeer(e){let r=this.peerStats.get(e);if(!!r){if(this.score(e)>0){this._removeIPs(e,r.ips),this.peerStats.delete(e);return}Object.entries(r.topics).forEach(([n,i])=>{i.firstMessageDeliveries=0;let s=this.params.topics[n].meshMessageDeliveriesThreshold;if(i.inMesh&&i.meshMessageDeliveriesActive&&i.meshMessageDeliveries<s){let o=s-i.meshMessageDeliveries;i.meshFailurePenalty+=o*o}i.inMesh=!1}),r.connected=!1,r.expire=Date.now()+this.params.retainScore}}graft(e,r){let n=this.peerStats.get(e);if(!n)return;let i=Hn.ensureTopicStats(r,n,this.params);!i||(i.inMesh=!0,i.graftTime=Date.now(),i.meshTime=0,i.meshMessageDeliveriesActive=!1)}prune(e,r){let n=this.peerStats.get(e);if(!n)return;let i=Hn.ensureTopicStats(r,n,this.params);if(!i)return;let s=this.params.topics[r].meshMessageDeliveriesThreshold;if(i.meshMessageDeliveriesActive&&i.meshMessageDeliveries<s){let o=s-i.meshMessageDeliveries;i.meshFailurePenalty+=o*o}i.inMesh=!1}validateMessage(e){return mo(this,void 0,void 0,function*(){this.deliveryRecords.ensureRecord(yield this.msgId(e))})}deliverMessage(e){return mo(this,void 0,void 0,function*(){let r=e.receivedFrom;this._markFirstMessageDelivery(r,e);let n=this.deliveryRecords.ensureRecord(yield this.msgId(e)),i=Date.now();if(n.status!==At.DeliveryRecordStatus.unknown){zn("unexpected delivery: message from %s was first seen %s ago and has delivery status %d",r,i-n.firstSeen,At.DeliveryRecordStatus[n.status]);return}n.status=At.DeliveryRecordStatus.valid,n.validated=i,n.peers.forEach(s=>{s!==r&&this._markDuplicateMessageDelivery(s,e)})})}rejectMessage(e,r){return mo(this,void 0,void 0,function*(){let n=e.receivedFrom;switch(r){case R_:case T_:this._markInvalidMessageDelivery(n,e);return}let i=this.deliveryRecords.ensureRecord(yield this.msgId(e));if(i.status!==At.DeliveryRecordStatus.unknown){zn("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",n,Date.now()-i.firstSeen,At.DeliveryRecordStatus[i.status]);return}switch(r){case I_.ERR_TOPIC_VALIDATOR_IGNORE:i.status=At.DeliveryRecordStatus.ignored;return}i.status=At.DeliveryRecordStatus.invalid,this._markInvalidMessageDelivery(n,e),i.peers.forEach(s=>{this._markInvalidMessageDelivery(s,e)})})}duplicateMessage(e){return mo(this,void 0,void 0,function*(){let r=e.receivedFrom,n=this.deliveryRecords.ensureRecord(yield this.msgId(e));if(!n.peers.has(r))switch(n.status){case At.DeliveryRecordStatus.unknown:n.peers.add(r);break;case At.DeliveryRecordStatus.valid:n.peers.add(r),this._markDuplicateMessageDelivery(r,e,n.validated);break;case At.DeliveryRecordStatus.invalid:this._markInvalidMessageDelivery(r,e);break}})}_markInvalidMessageDelivery(e,r){let n=this.peerStats.get(e);!n||r.topicIDs.forEach(i=>{let s=Hn.ensureTopicStats(i,n,this.params);!s||(s.invalidMessageDeliveries+=1)})}_markFirstMessageDelivery(e,r){let n=this.peerStats.get(e);!n||r.topicIDs.forEach(i=>{let s=Hn.ensureTopicStats(i,n,this.params);if(!s)return;let o=this.params.topics[i].firstMessageDeliveriesCap;s.firstMessageDeliveries+=1,s.firstMessageDeliveries>o&&(s.firstMessageDeliveries=o),!!s.inMesh&&(o=this.params.topics[i].meshMessageDeliveriesCap,s.meshMessageDeliveries+=1,s.meshMessageDeliveries>o&&(s.meshMessageDeliveries=o))})}_markDuplicateMessageDelivery(e,r,n=0){let i=this.peerStats.get(e);if(!i)return;let s=n?Date.now():0;r.topicIDs.forEach(o=>{let c=Hn.ensureTopicStats(o,i,this.params);if(!c||!c.inMesh)return;let f=this.params.topics[o];if(n&&s>n+f.meshMessageDeliveriesWindow)return;let u=f.meshMessageDeliveriesCap;c.meshMessageDeliveries+=1,c.meshMessageDeliveries>u&&(c.meshMessageDeliveries=u)})}_getIPs(e){return this._connectionManager.getAll(A_.default.createFromB58String(e)).map(r=>r.remoteAddr.toOptions().host)}_setIPs(e,r,n){e:for(let i of r){for(let o of n)if(i===o)continue e;let s=this.peerIPs.get(i);s||(s=new Set,this.peerIPs.set(i,s)),s.add(e)}e:for(let i of n){for(let o of r)if(i===o)continue e;let s=this.peerIPs.get(i);!s||(s.delete(e),s.size||this.peerIPs.delete(i))}}_removeIPs(e,r){r.forEach(n=>{let i=this.peerIPs.get(n);!i||(i.delete(e),i.size||this.peerIPs.delete(n))})}_updateIPs(){this.peerStats.forEach((e,r)=>{let n=this._getIPs(r);this._setIPs(r,n,e.ips),e.ips=n})}};Nr.PeerScore=Ky});var qy=m(cr=>{"use strict";var P_=cr&&cr.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Vc=cr&&cr.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&P_(e,t,r)};Object.defineProperty(cr,"__esModule",{value:!0});Vc(Uc(),cr);Vc(Ty(),cr);Vc(My(),cr)});var Gy=m(Wn=>{"use strict";var Fy=Wn&&Wn.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(a){try{u(n.next(a))}catch(h){o(h)}}function f(a){try{u(n.throw(a))}catch(h){o(h)}}function u(a){a.done?s(a.value):i(a.value).then(c,f)}u((n=n.apply(t,e||[])).next())})};Object.defineProperty(Wn,"__esModule",{value:!0});Wn.IWantTracer=void 0;var D_=un(),jc=fn(),O_=os(),{ERR_INVALID_SIGNATURE:k_,ERR_MISSING_SIGNATURE:N_}=O_.codes,Uy=class{constructor(e){this.getMsgId=e,this.promises=new Map}addPromise(e,r){let n=Math.floor(Math.random()*r.length),i=r[n],s=jc.messageIdToString(i),o=this.promises.get(s);o||(o=new Map,this.promises.set(s,o)),o.has(e)||o.set(e,Date.now()+D_.GossipsubIWantFollowupTime)}getBrokenPromises(){let e=Date.now(),r=new Map;return this.promises.forEach((n,i)=>{n.forEach((s,o)=>{s<e&&(r.set(o,(r.get(o)||0)+1),n.delete(o))}),n.size||this.promises.delete(i)}),r}deliverMessage(e){return Fy(this,void 0,void 0,function*(){let r=yield this.getMsgId(e),n=jc.messageIdToString(r);this.promises.delete(n)})}rejectMessage(e,r){return Fy(this,void 0,void 0,function*(){switch(r){case k_:case N_:return}let n=yield this.getMsgId(e),i=jc.messageIdToString(n);this.promises.delete(i)})}clear(){this.promises.clear()}};Wn.IWantTracer=Uy});var Wy=m((k4,zy)=>{var Vy="Expected a function",jy=0/0,L_="[object Symbol]",K_=/^\s+|\s+$/g,M_=/^[-+]0x[0-9a-f]+$/i,q_=/^0b[01]+$/i,F_=/^0o[0-7]+$/i,U_=parseInt,G_=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,V_=typeof self=="object"&&self&&self.Object===Object&&self,j_=G_||V_||Function("return this")(),H_=Object.prototype,z_=H_.toString,W_=Math.max,$_=Math.min,Hc=function(){return j_.Date.now()};function Y_(t,e,r){var n,i,s,o,c,f,u=0,a=!1,h=!1,l=!0;if(typeof t!="function")throw new TypeError(Vy);e=Hy(e)||0,xo(r)&&(a=!!r.leading,h="maxWait"in r,s=h?W_(Hy(r.maxWait)||0,e):s,l="trailing"in r?!!r.trailing:l);function d(S){var K=n,U=i;return n=i=void 0,u=S,o=t.apply(U,K),o}function p(S){return u=S,c=setTimeout(b,e),a?d(S):o}function y(S){var K=S-f,U=S-u,ye=e-K;return h?$_(ye,s-U):ye}function v(S){var K=S-f,U=S-u;return f===void 0||K>=e||K<0||h&&U>=s}function b(){var S=Hc();if(v(S))return w(S);c=setTimeout(b,y(S))}function w(S){return c=void 0,l&&n?d(S):(n=i=void 0,o)}function I(){c!==void 0&&clearTimeout(c),u=0,n=f=i=c=void 0}function P(){return c===void 0?o:w(Hc())}function T(){var S=Hc(),K=v(S);if(n=arguments,i=this,f=S,K){if(c===void 0)return p(f);if(h)return c=setTimeout(b,e),d(f)}return c===void 0&&(c=setTimeout(b,e)),o}return T.cancel=I,T.flush=P,T}function Q_(t,e,r){var n=!0,i=!0;if(typeof t!="function")throw new TypeError(Vy);return xo(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),Y_(t,e,{leading:n,maxWait:e,trailing:i})}function xo(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function J_(t){return!!t&&typeof t=="object"}function Z_(t){return typeof t=="symbol"||J_(t)&&z_.call(t)==L_}function Hy(t){if(typeof t=="number")return t;if(Z_(t))return jy;if(xo(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=xo(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(K_,"");var r=q_.test(t);return r||F_.test(t)?U_(t.slice(2),r?2:8):M_.test(t)?jy:+t}zy.exports=Q_});var Qy=m(($y,Yy)=>{"use strict";var X_=Wy();$y=Yy.exports=zc;function zc(t){if(!(this instanceof zc))return new zc(t);t=t||{};let e=t.validity||30,r=new Map,n=X_(()=>{r.forEach((i,s)=>{let o=i.validity||e;eS(i.timestamp)>o&&r.delete(s)})},200);this.put=(i,s,o)=>{this.has(i)||r.set(i,{value:s,timestamp:new Date,validity:o}),n()},this.get=i=>{if(r.has(i))return r.get(i).value;throw new Error("key does not exist")},this.has=i=>r.has(i)}function eS(t){let r=new Date().getTime()-t.getTime();return Math.floor(r/1e3)}});var Eo=m((N4,Zy)=>{"use strict";var hn=Vr(),wo=hn.Reader,Jy=hn.Writer,Fe=hn.util,ht=hn.roots["libp2p-crypto-keys"]||(hn.roots["libp2p-crypto-keys"]={});ht.KeyType=function(){var t={},e=Object.create(t);return e[t[0]="RSA"]=0,e[t[1]="Ed25519"]=1,e[t[2]="Secp256k1"]=2,e}();ht.PublicKey=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.Type=0,t.prototype.Data=Fe.newBuffer([]),t.encode=function(r,n){return n||(n=Jy.create()),n.uint32(8).int32(r.Type),n.uint32(18).bytes(r.Data),n},t.decode=function(r,n){r instanceof wo||(r=wo.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new ht.PublicKey;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw Fe.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw Fe.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof ht.PublicKey)return r;var n=new ht.PublicKey;switch(r.Type){case"RSA":case 0:n.Type=0;break;case"Ed25519":case 1:n.Type=1;break;case"Secp256k1":case 2:n.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?Fe.base64.decode(r.Data,n.Data=Fe.newBuffer(Fe.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.Type=n.enums===String?"RSA":0,n.bytes===String?i.Data="":(i.Data=[],n.bytes!==Array&&(i.Data=Fe.newBuffer(i.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(i.Type=n.enums===String?ht.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(i.Data=n.bytes===String?Fe.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,hn.util.toJSONOptions)},t}();ht.PrivateKey=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.Type=0,t.prototype.Data=Fe.newBuffer([]),t.encode=function(r,n){return n||(n=Jy.create()),n.uint32(8).int32(r.Type),n.uint32(18).bytes(r.Data),n},t.decode=function(r,n){r instanceof wo||(r=wo.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new ht.PrivateKey;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw Fe.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw Fe.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof ht.PrivateKey)return r;var n=new ht.PrivateKey;switch(r.Type){case"RSA":case 0:n.Type=0;break;case"Ed25519":case 1:n.Type=1;break;case"Secp256k1":case 2:n.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?Fe.base64.decode(r.Data,n.Data=Fe.newBuffer(Fe.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.Type=n.enums===String?"RSA":0,n.bytes===String?i.Data="":(i.Data=[],n.bytes!==Array&&(i.Data=Fe.newBuffer(i.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(i.Type=n.enums===String?ht.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(i.Data=n.bytes===String?Fe.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,hn.util.toJSONOptions)},t}();Zy.exports=ht});var Ui=m(Xy=>{"use strict";Xy.get=(t=globalThis)=>{let e=t.crypto;if(!e||!e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}});var Wc=m((K4,tg)=>{"use strict";var{concat:tS}=(Et(),wt),{fromString:eg}=(De(),Pe),rS=Ui();function nS({algorithm:t="AES-GCM",nonceLength:e=12,keyLength:r=16,digest:n="SHA-256",saltLength:i=16,iterations:s=32767}={}){let o=rS.get();r*=8;async function c(u,a){let h=o.getRandomValues(new Uint8Array(i)),l=o.getRandomValues(new Uint8Array(e)),d={name:t,iv:l},p={name:"PBKDF2",salt:h,iterations:s,hash:{name:n}},y=await o.subtle.importKey("raw",eg(a),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),v=await o.subtle.deriveKey(p,y,{name:t,length:r},!0,["encrypt"]),b=await o.subtle.encrypt(d,v,u);return tS([h,d.iv,new Uint8Array(b)])}async function f(u,a){let h=u.slice(0,i),l=u.slice(i,i+e),d=u.slice(i+e),p={name:t,iv:l},y={name:"PBKDF2",salt:h,iterations:s,hash:{name:n}},v=await o.subtle.importKey("raw",eg(a),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),b=await o.subtle.deriveKey(y,v,{name:t,length:r},!0,["decrypt"]),w=await o.subtle.decrypt(p,b,d);return new Uint8Array(w)}return{encrypt:c,decrypt:f}}tg.exports={create:nS}});var ng=m((M4,rg)=>{"use strict";var{base64:iS}=(Jr(),xr),sS=Wc();rg.exports={import:async function(t,e){let r=iS.decode(t);return await sS.create().decrypt(r,e)}}});var $c=m((q4,ig)=>{"use strict";var oS=ms(),aS=ce();ig.exports=function(t){if(isNaN(t)||t<=0)throw aS(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return oS(t)}});var _o=m(Gi=>{"use strict";me();vi();var cS=W(),{fromString:uS}=(De(),Pe),{toString:sg}=(Ne(),ke),{concat:og}=(Et(),wt);Gi.bigIntegerToUintBase64url=(t,e)=>{let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=og([new Uint8Array(e-r.length),r])}return sg(r,"base64url")};Gi.base64urlToBigInteger=t=>{let e=Gi.base64urlToBuffer(t);return new cS.jsbn.BigInteger(sg(e,"base16"),16)};Gi.base64urlToBuffer=(t,e)=>{let r=uS(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=og([new Uint8Array(e-r.length),r])}return r}});var ug=m(Vi=>{"use strict";Xr();Nn();var Lr=W(),{bigIntegerToUintBase64url:Wt,base64urlToBigInteger:$t}=_o(),{fromString:ag}=(De(),Pe),{toString:cg}=(Ne(),ke);Vi.pkcs1ToJwk=function(t){let e=Lr.asn1.fromDer(cg(t,"ascii")),r=Lr.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Wt(r.n),e:Wt(r.e),d:Wt(r.d),p:Wt(r.p),q:Wt(r.q),dp:Wt(r.dP),dq:Wt(r.dQ),qi:Wt(r.qInv),alg:"RS256",kid:"2011-04-29"}};Vi.jwkToPkcs1=function(t){let e=Lr.pki.privateKeyToAsn1({n:$t(t.n),e:$t(t.e),d:$t(t.d),p:$t(t.p),q:$t(t.q),dP:$t(t.dp),dQ:$t(t.dq),qInv:$t(t.qi)});return ag(Lr.asn1.toDer(e).getBytes(),"ascii")};Vi.pkixToJwk=function(t){let e=Lr.asn1.fromDer(cg(t,"ascii")),r=Lr.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Wt(r.n),e:Wt(r.e),alg:"RS256",kid:"2011-04-29"}};Vi.jwkToPkix=function(t){let e=Lr.pki.publicKeyToAsn1({n:$t(t.n),e:$t(t.e)});return ag(Lr.asn1.toDer(e).getBytes(),"ascii")}});var pg=m((G4,lg)=>{"use strict";Nn();var fg=W(),{base64urlToBigInteger:fS}=_o();function hg(t,e){return e.map(r=>fS(t[r]))}function hS(t){return fg.pki.setRsaPrivateKey(...hg(t,["n","e","d","p","q","dp","dq","qi"]))}function lS(t){return fg.pki.setRsaPublicKey(...hg(t,["n","e"]))}lg.exports={jwk2pub:lS,jwk2priv:hS}});var gg=m(fr=>{"use strict";var ur=Ui(),pS=$c(),{toString:dS}=(Ne(),ke),{fromString:yS}=(De(),Pe);fr.utils=ug();fr.generateKey=async function(t){let e=await ur.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await dg(e);return{privateKey:r[0],publicKey:r[1]}};fr.unmarshalPrivateKey=async function(t){let r=[await ur.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await gS(t)],n=await dg({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}};fr.getRandomValues=pS;fr.hashAndSign=async function(t,e){let r=await ur.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await ur.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,n.byteOffset,n.byteLength)};fr.hashAndVerify=async function(t,e,r){let n=await ur.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return ur.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)};function dg(t){return Promise.all([ur.get().subtle.exportKey("jwk",t.privateKey),ur.get().subtle.exportKey("jwk",t.publicKey)])}function gS(t){return ur.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:bS,jwk2priv:vS}=pg();function yg(t,e,r,n){let i=e?bS(t):vS(t),s=dS(Uint8Array.from(r),"ascii"),o=n(s,i);return yS(o,"ascii")}fr.encrypt=function(t,e){return yg(t,!0,e,(r,n)=>n.encrypt(r))};fr.decrypt=function(t,e){return yg(t,!1,e,(r,n)=>n.decrypt(r))}});var So=m((j4,bg)=>{"use strict";var{base64:mS}=(Jr(),xr),xS=Wc();bg.exports={export:async function(t,e){let n=await xS.create().encrypt(t,e);return mS.encode(n)}}});var Eg=m((H4,wg)=>{"use strict";var{sha256:vg}=(vt(),nt),mg=ce(),{equals:xg}=(St(),_t),{toString:wS}=(Ne(),ke);dc();var Io=W(),lt=gg(),Ao=Eo(),ES=So(),Co=class{constructor(e){this._key=e}async verify(e,r){return lt.hashAndVerify(this._key,r,e)}marshal(){return lt.utils.jwkToPkix(this._key)}get bytes(){return Ao.PublicKey.encode({Type:Ao.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(e){return lt.encrypt(this._key,e)}equals(e){return xg(this.bytes,e.bytes)}async hash(){let{bytes:e}=await vg.digest(this.bytes);return e}},ji=class{constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return lt.getRandomValues(16)}async sign(e){return lt.hashAndSign(this._key,e)}get public(){if(!this._publicKey)throw mg(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new Co(this._publicKey)}decrypt(e){return lt.decrypt(this._key,e)}marshal(){return lt.utils.jwkToPkcs1(this._key)}get bytes(){return Ao.PrivateKey.encode({Type:Ao.KeyType.RSA,Data:this.marshal()}).finish()}equals(e){return xg(this.bytes,e.bytes)}async hash(){let{bytes:e}=await vg.digest(this.bytes);return e}async id(){let e=await this.public.hash();return wS(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new Io.util.ByteBuffer(this.marshal()),i=Io.asn1.fromDer(n),s=Io.pki.privateKeyFromAsn1(i),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Io.pki.encryptRsaPrivateKey(s,e,o)}else{if(r==="libp2p-key")return ES.export(this.bytes,e);throw mg(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function _S(t){let e=lt.utils.pkcs1ToJwk(t),r=await lt.unmarshalPrivateKey(e);return new ji(r.privateKey,r.publicKey)}function SS(t){let e=lt.utils.pkixToJwk(t);return new Co(e)}async function IS(t){let e=await lt.unmarshalPrivateKey(t);return new ji(e.privateKey,e.publicKey)}async function AS(t){let e=await lt.generateKey(t);return new ji(e.privateKey,e.publicKey)}wg.exports={RsaPublicKey:Co,RsaPrivateKey:ji,unmarshalRsaPublicKey:SS,unmarshalRsaPrivateKey:_S,generateKeyPair:AS,fromJwk:IS}});var Sg=m(Kr=>{"use strict";var Hi=_c(),CS=32,BS=64,Bo=32;Kr.publicKeyLength=CS;Kr.privateKeyLength=BS;Kr.generateKey=async function(){let t=Hi.utils.randomPrivateKey(),e=await Hi.getPublicKey(t);return{privateKey:_g(t,e),publicKey:e}};Kr.generateKeyFromSeed=async function(t){if(t.length!==Bo)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await Hi.getPublicKey(e);return{privateKey:_g(e,r),publicKey:r}};Kr.hashAndSign=function(t,e){let r=t.slice(0,Bo);return Hi.sign(e,r)};Kr.hashAndVerify=function(t,e,r){return Hi.verify(e,r,t)};function _g(t,e){let r=new Uint8Array(Kr.privateKeyLength);for(let n=0;n<Bo;n++)r[n]=t[n],r[Bo+n]=e[n];return r}});var Tg=m((W4,Bg)=>{"use strict";var Ig=ce(),{equals:Ag}=(St(),_t),{sha256:Cg}=(vt(),nt),{base58btc:TS}=(Qr(),Yr),{identity:RS}=(hi(),Tn),Ue=Sg(),To=Eo(),PS=So(),Ro=class{constructor(e){this._key=Yn(e,Ue.publicKeyLength)}async verify(e,r){return Ue.hashAndVerify(this._key,r,e)}marshal(){return this._key}get bytes(){return To.PublicKey.encode({Type:To.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return Ag(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Cg.digest(this.bytes);return e}},$n=class{constructor(e,r){this._key=Yn(e,Ue.privateKeyLength),this._publicKey=Yn(r,Ue.publicKeyLength)}async sign(e){return Ue.hashAndSign(this._key,e)}get public(){return new Ro(this._publicKey)}marshal(){return this._key}get bytes(){return To.PrivateKey.encode({Type:To.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return Ag(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Cg.digest(this.bytes);return e}async id(){let e=await RS.digest(this.public.bytes);return TS.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return PS.export(this.bytes,e);throw Ig(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function DS(t){if(t.length>Ue.privateKeyLength){t=Yn(t,Ue.privateKeyLength+Ue.publicKeyLength);let n=t.slice(0,Ue.privateKeyLength),i=t.slice(Ue.privateKeyLength,t.length);return new $n(n,i)}t=Yn(t,Ue.privateKeyLength);let e=t.slice(0,Ue.privateKeyLength),r=t.slice(Ue.publicKeyLength);return new $n(e,r)}function OS(t){return t=Yn(t,Ue.publicKeyLength),new Ro(t)}async function kS(){let{privateKey:t,publicKey:e}=await Ue.generateKey();return new $n(t,e)}async function NS(t){let{privateKey:e,publicKey:r}=await Ue.generateKeyFromSeed(t);return new $n(e,r)}function Yn(t,e){if(t=Uint8Array.from(t||[]),t.length!==e)throw Ig(new Error(`Key must be a Uint8Array of length ${e}, got ${t.length}`),"ERR_INVALID_KEY_TYPE");return t}Bg.exports={Ed25519PublicKey:Ro,Ed25519PrivateKey:$n,unmarshalEd25519PrivateKey:DS,unmarshalEd25519PublicKey:OS,generateKeyPair:kS,generateKeyPairFromSeed:NS}});var Dg=m(($4,Pg)=>{"use strict";var zi=ce(),Mr=Bc(),{sha256:Rg}=(vt(),nt);Pg.exports=()=>{let t=32;function e(){return Mr.utils.randomPrivateKey()}async function r(u,a){let{digest:h}=await Rg.digest(a);try{return await Mr.sign(h,u)}catch(l){throw zi(l,"ERR_INVALID_INPUT")}}async function n(u,a,h){try{let{digest:l}=await Rg.digest(h);return Mr.verify(a,l,u)}catch(l){throw zi(l,"ERR_INVALID_INPUT")}}function i(u){return Mr.Point.fromHex(u).toRawBytes(!0)}function s(u){return Mr.Point.fromHex(u).toRawBytes(!1)}function o(u){try{Mr.getPublicKey(u,!0)}catch(a){throw zi(a,"ERR_INVALID_PRIVATE_KEY")}}function c(u){try{Mr.Point.fromHex(u)}catch(a){throw zi(a,"ERR_INVALID_PUBLIC_KEY")}}function f(u){try{return Mr.getPublicKey(u,!0)}catch(a){throw zi(a,"ERR_INVALID_PRIVATE_KEY")}}return{generateKey:e,privateKeyLength:t,hashAndSign:r,hashAndVerify:n,compressPublicKey:i,decompressPublicKey:s,validatePrivateKey:o,validatePublicKey:c,computePublicKey:f}}});var Lg=m((Y4,Ng)=>{"use strict";var{sha256:Og}=(vt(),nt),LS=ce(),{equals:kg}=(St(),_t),{toString:KS}=(Ne(),ke),MS=So();Ng.exports=(t,e,r)=>{r=r||Dg()();class n{constructor(u){r.validatePublicKey(u),this._key=u}verify(u,a){return r.hashAndVerify(this._key,a,u)}marshal(){return r.compressPublicKey(this._key)}get bytes(){return t.PublicKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return kg(this.bytes,u.bytes)}async hash(){let{bytes:u}=await Og.digest(this.bytes);return u}}class i{constructor(u,a){this._key=u,this._publicKey=a||r.computePublicKey(u),r.validatePrivateKey(this._key),r.validatePublicKey(this._publicKey)}sign(u){return r.hashAndSign(this._key,u)}get public(){return new n(this._publicKey)}marshal(){return this._key}get bytes(){return t.PrivateKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return kg(this.bytes,u.bytes)}async hash(){let{bytes:u}=await Og.digest(this.bytes);return u}async id(){let u=await this.public.hash();return KS(u,"base58btc")}async export(u,a="libp2p-key"){if(a==="libp2p-key")return MS.export(this.bytes,u);throw LS(new Error(`export format '${a}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function s(f){return new i(f)}function o(f){return new n(f)}async function c(){let f=await r.generateKey();return new i(f)}return{Secp256k1PublicKey:n,Secp256k1PrivateKey:i,unmarshalSecp256k1PrivateKey:s,unmarshalSecp256k1PublicKey:o,generateKeyPair:c}}});var Mg=m((Q4,Kg)=>{"use strict";Kg.exports={SHA1:20,SHA256:32,SHA512:64}});var Ug=m(Fg=>{"use strict";var qg=Ui(),qS=Mg(),FS={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},US=async(t,e)=>{let r=await qg.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,r.byteOffset,r.byteLength)};Fg.create=async function(t,e){let r=FS[t],n=await qg.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(i){return US(n,i)},length:qS[t]}}});var zg=m((Z4,Hg)=>{"use strict";var Gg=ce(),{concat:Vg}=(Et(),wt),{fromString:GS}=(De(),Pe),VS=Ug(),jg={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};Hg.exports=async(t,e,r)=>{let n=jg[t];if(!n){let w=Object.keys(jg).join(" / ");throw Gg(new Error(`unknown cipher type '${t}'. Must be ${w}`),"ERR_INVALID_CIPHER_TYPE")}if(!e)throw Gg(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let i=n.keySize,s=n.ivSize,o=20,c=GS("key expansion"),f=2*(s+i+o),u=await VS.create(e,r),a=await u.digest(c),h=[],l=0;for(;l<f;){let w=await u.digest(Vg([a,c])),I=w.length;l+I>f&&(I=f-l),h.push(w),l+=I,a=await u.digest(a)}let d=f/2,p=Vg(h),y=p.slice(0,d),v=p.slice(d,f),b=w=>({iv:w.slice(0,s),cipherKey:w.slice(s,s+i),macKey:w.slice(s+i)});return{k1:b(y),k2:b(v)}}});var $g=m((X4,Wg)=>{"use strict";var jS=ce();Wg.exports=function(t,e){if(!t.includes(e)){let r=t.join(" / ");throw jS(new Error(`Unknown curve: ${e}. Must be ${r}`),"ERR_INVALID_CURVE")}}});var e1=m(Xg=>{"use strict";var HS=ce(),Wi=Ui(),{base64urlToBuffer:Yg}=_o(),zS=$g(),{toString:Yc}=(Ne(),ke),{concat:WS}=(Et(),wt),{equals:$S}=(St(),_t),Qg={"P-256":256,"P-384":384,"P-521":521};Xg.generateEphmeralKeyPair=async function(t){zS(Object.keys(Qg),t);let e=await Wi.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(i,s)=>{let o;s?o=await Wi.get().subtle.importKey("jwk",QS(t,s),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):o=e.privateKey;let c=[await Wi.get().subtle.importKey("jwk",Zg(t,i),{name:"ECDH",namedCurve:t},!1,[]),o],f=await Wi.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:c[0]},c[1],Qg[t]);return new Uint8Array(f,f.byteOffset,f.byteLength)},n=await Wi.get().subtle.exportKey("jwk",e.publicKey);return{key:YS(n),genSharedKey:r}};var Jg={"P-256":32,"P-384":48,"P-521":66};function YS(t){let e=Jg[t.crv];return WS([Uint8Array.from([4]),Yg(t.x,e),Yg(t.y,e)],1+e*2)}function Zg(t,e){let r=Jg[t];if($S(!e.slice(0,1),Uint8Array.from([4])))throw HS(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:Yc(e.slice(1,r+1),"base64url"),y:Yc(e.slice(1+r),"base64url"),ext:!0}}var QS=(t,e)=>({...Zg(t,e.public),d:Yc(e.private,"base64url")})});var r1=m((tC,t1)=>{"use strict";var JS=e1();t1.exports=async t=>JS.generateEphmeralKeyPair(t)});var s1=m((rC,i1)=>{"use strict";var Yt=Eo();Xr();fc();var Qc=W(),$i=ce(),{fromString:ZS}=(De(),Pe),XS=ng(),pt={rsa:Eg(),ed25519:Tg(),secp256k1:Lg()(Yt,$c())},Po={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function Qn(t){let e=pt[t.toLowerCase()];if(!e){let r=Object.keys(pt).join(" / ");throw $i(new Error(`invalid or unsupported key type ${t}. Must be ${r}`),"ERR_UNSUPPORTED_KEY_TYPE")}return e}var eI=async(t,e)=>Qn(t).generateKeyPair(e),tI=async(t,e,r)=>{let n=Qn(t);if(t.toLowerCase()!=="ed25519")throw $i(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return n.generateKeyPairFromSeed(e,r)},rI=t=>{let e=Yt.PublicKey.decode(t),r=e.Data;switch(e.Type){case Yt.KeyType.RSA:return pt.rsa.unmarshalRsaPublicKey(r);case Yt.KeyType.Ed25519:return pt.ed25519.unmarshalEd25519PublicKey(r);case Yt.KeyType.Secp256k1:if(pt.secp256k1)return pt.secp256k1.unmarshalSecp256k1PublicKey(r);throw $i(new Error(Po.message),Po.code);default:Qn(e.Type)}},nI=(t,e)=>(e=(e||"rsa").toLowerCase(),Qn(e),t.bytes),n1=async t=>{let e=Yt.PrivateKey.decode(t),r=e.Data;switch(e.Type){case Yt.KeyType.RSA:return pt.rsa.unmarshalRsaPrivateKey(r);case Yt.KeyType.Ed25519:return pt.ed25519.unmarshalEd25519PrivateKey(r);case Yt.KeyType.Secp256k1:if(pt.secp256k1)return pt.secp256k1.unmarshalSecp256k1PrivateKey(r);throw $i(new Error(Po.message),Po.code);default:Qn(e.Type)}},iI=(t,e)=>(e=(e||"rsa").toLowerCase(),Qn(e),t.bytes),sI=async(t,e)=>{try{let i=await XS.import(t,e);return n1(i)}catch(i){}let r=Qc.pki.decryptRsaPrivateKey(t,e);if(r===null)throw $i(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let n=Qc.asn1.toDer(Qc.pki.privateKeyToAsn1(r));return n=ZS(n.getBytes(),"ascii"),pt.rsa.unmarshalRsaPrivateKey(n)};i1.exports={supportedKeys:pt,keysPBM:Yt,keyStretcher:zg(),generateEphemeralKeyPair:r1(),generateKeyPair:eI,generateKeyPairFromSeed:tI,unmarshalPublicKey:rI,marshalPublicKey:nI,unmarshalPrivateKey:n1,marshalPrivateKey:iI,import:sI}});var o1=m(Jc=>{"use strict";Jc.messages={NOT_STARTED_YET:"The libp2p node is not started yet",DHT_DISABLED:"DHT is not available",CONN_ENCRYPTION_REQUIRED:"At least one connection encryption module is required",NOT_FOUND:"Not found"};Jc.codes={DHT_DISABLED:"ERR_DHT_DISABLED",PUBSUB_NOT_STARTED:"ERR_PUBSUB_NOT_STARTED",DHT_NOT_STARTED:"ERR_DHT_NOT_STARTED",CONN_ENCRYPTION_REQUIRED:"ERR_CONN_ENCRYPTION_REQUIRED",ERR_INVALID_PROTOCOLS_FOR_STREAM:"ERR_INVALID_PROTOCOLS_FOR_STREAM",ERR_CONNECTION_ENDED:"ERR_CONNECTION_ENDED",ERR_CONNECTION_FAILED:"ERR_CONNECTION_FAILED",ERR_NODE_NOT_STARTED:"ERR_NODE_NOT_STARTED",ERR_ALREADY_ABORTED:"ERR_ALREADY_ABORTED",ERR_TOO_MANY_ADDRESSES:"ERR_TOO_MANY_ADDRESSES",ERR_NO_VALID_ADDRESSES:"ERR_NO_VALID_ADDRESSES",ERR_RELAYED_DIAL:"ERR_RELAYED_DIAL",ERR_DIALED_SELF:"ERR_DIALED_SELF",ERR_DISCOVERED_SELF:"ERR_DISCOVERED_SELF",ERR_DUPLICATE_TRANSPORT:"ERR_DUPLICATE_TRANSPORT",ERR_ENCRYPTION_FAILED:"ERR_ENCRYPTION_FAILED",ERR_HOP_REQUEST_FAILED:"ERR_HOP_REQUEST_FAILED",ERR_INVALID_KEY:"ERR_INVALID_KEY",ERR_INVALID_MESSAGE:"ERR_INVALID_MESSAGE",ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_INVALID_PEER:"ERR_INVALID_PEER",ERR_MUXER_UNAVAILABLE:"ERR_MUXER_UNAVAILABLE",ERR_NOT_FOUND:"ERR_NOT_FOUND",ERR_TIMEOUT:"ERR_TIMEOUT",ERR_TRANSPORT_UNAVAILABLE:"ERR_TRANSPORT_UNAVAILABLE",ERR_TRANSPORT_DIAL_FAILED:"ERR_TRANSPORT_DIAL_FAILED",ERR_UNSUPPORTED_PROTOCOL:"ERR_UNSUPPORTED_PROTOCOL",ERR_INVALID_MULTIADDR:"ERR_INVALID_MULTIADDR",ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"}});var u1=m((iC,c1)=>{"use strict";var Jn=Vr(),a1=Jn.Reader,oI=Jn.Writer,pe=Jn.util,Yi=Jn.roots["libp2p-envelope"]||(Jn.roots["libp2p-envelope"]={});Yi.Envelope=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.publicKey=pe.newBuffer([]),t.prototype.payloadType=pe.newBuffer([]),t.prototype.payload=pe.newBuffer([]),t.prototype.signature=pe.newBuffer([]),t.encode=function(r,n){return n||(n=oI.create()),r.publicKey!=null&&Object.hasOwnProperty.call(r,"publicKey")&&n.uint32(10).bytes(r.publicKey),r.payloadType!=null&&Object.hasOwnProperty.call(r,"payloadType")&&n.uint32(18).bytes(r.payloadType),r.payload!=null&&Object.hasOwnProperty.call(r,"payload")&&n.uint32(26).bytes(r.payload),r.signature!=null&&Object.hasOwnProperty.call(r,"signature")&&n.uint32(42).bytes(r.signature),n},t.decode=function(r,n){r instanceof a1||(r=a1.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Yi.Envelope;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.publicKey=r.bytes();break;case 2:s.payloadType=r.bytes();break;case 3:s.payload=r.bytes();break;case 5:s.signature=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Yi.Envelope)return r;var n=new Yi.Envelope;return r.publicKey!=null&&(typeof r.publicKey=="string"?pe.base64.decode(r.publicKey,n.publicKey=pe.newBuffer(pe.base64.length(r.publicKey)),0):r.publicKey.length&&(n.publicKey=r.publicKey)),r.payloadType!=null&&(typeof r.payloadType=="string"?pe.base64.decode(r.payloadType,n.payloadType=pe.newBuffer(pe.base64.length(r.payloadType)),0):r.payloadType.length&&(n.payloadType=r.payloadType)),r.payload!=null&&(typeof r.payload=="string"?pe.base64.decode(r.payload,n.payload=pe.newBuffer(pe.base64.length(r.payload)),0):r.payload.length&&(n.payload=r.payload)),r.signature!=null&&(typeof r.signature=="string"?pe.base64.decode(r.signature,n.signature=pe.newBuffer(pe.base64.length(r.signature)),0):r.signature.length&&(n.signature=r.signature)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(n.bytes===String?i.publicKey="":(i.publicKey=[],n.bytes!==Array&&(i.publicKey=pe.newBuffer(i.publicKey))),n.bytes===String?i.payloadType="":(i.payloadType=[],n.bytes!==Array&&(i.payloadType=pe.newBuffer(i.payloadType))),n.bytes===String?i.payload="":(i.payload=[],n.bytes!==Array&&(i.payload=pe.newBuffer(i.payload))),n.bytes===String?i.signature="":(i.signature=[],n.bytes!==Array&&(i.signature=pe.newBuffer(i.signature)))),r.publicKey!=null&&r.hasOwnProperty("publicKey")&&(i.publicKey=n.bytes===String?pe.base64.encode(r.publicKey,0,r.publicKey.length):n.bytes===Array?Array.prototype.slice.call(r.publicKey):r.publicKey),r.payloadType!=null&&r.hasOwnProperty("payloadType")&&(i.payloadType=n.bytes===String?pe.base64.encode(r.payloadType,0,r.payloadType.length):n.bytes===Array?Array.prototype.slice.call(r.payloadType):r.payloadType),r.payload!=null&&r.hasOwnProperty("payload")&&(i.payload=n.bytes===String?pe.base64.encode(r.payload,0,r.payload.length):n.bytes===Array?Array.prototype.slice.call(r.payload):r.payload),r.signature!=null&&r.hasOwnProperty("signature")&&(i.signature=n.bytes===String?pe.base64.encode(r.signature,0,r.signature.length):n.bytes===Array?Array.prototype.slice.call(r.signature):r.signature),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Jn.util.toJSONOptions)},t}();c1.exports=Yi});var p1=m((sC,l1)=>{"use strict";var aI=ce(),{concat:cI}=(Et(),wt),{fromString:uI}=(De(),Pe),fI=s1(),hI=Gn(),Zc=ds(),{equals:Do}=(St(),_t),{codes:lI}=o1(),{Envelope:f1}=u1(),qr=class{constructor({peerId:e,payloadType:r,payload:n,signature:i}){this.peerId=e,this.payloadType=r,this.payload=n,this.signature=i,this._marshal=void 0}marshal(){if(this._marshal)return this._marshal;let e=fI.marshalPublicKey(this.peerId.pubKey);return this._marshal=f1.encode({publicKey:e,payloadType:this.payloadType,payload:this.payload,signature:this.signature}).finish(),this._marshal}equals(e){return Do(this.peerId.pubKey.bytes,e.peerId.pubKey.bytes)&&Do(this.payloadType,e.payloadType)&&Do(this.payload,e.payload)&&Do(this.signature,e.signature)}validate(e){let r=h1(e,this.payloadType,this.payload);return this.peerId.pubKey.verify(r,this.signature)}},h1=(t,e,r)=>{let n=uI(t),i=Zc.encode(n.byteLength),s=Zc.encode(e.length),o=Zc.encode(r.length);return cI([new Uint8Array(i),n,new Uint8Array(s),e,new Uint8Array(o),r])};qr.createFromProtobuf=async t=>{let e=f1.decode(t),r=await hI.createFromPubKey(e.publicKey);return new qr({peerId:r,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};qr.seal=async(t,e)=>{let r=t.domain,n=t.codec,i=t.marshal(),s=h1(r,n,i),o=await e.privKey.sign(s);return new qr({peerId:e,payloadType:n,payload:i,signature:o})};qr.openAndCertify=async(t,e)=>{let r=await qr.createFromProtobuf(t);if(!await r.validate(e))throw aI(new Error("envelope signature is not valid for the given domain"),lI.ERR_SIGNATURE_NOT_VALID);return r};l1.exports=qr});var xI=m((hr,y1)=>{"use strict";var pI=hr&&hr.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),dI=hr&&hr.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),d1=hr&&hr.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&pI(e,t,r);return dI(e,t),e},Zn=hr&&hr.__awaiter||function(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(a){try{u(n.next(a))}catch(h){o(h)}}function f(a){try{u(n.throw(a))}catch(h){o(h)}}function u(a){a.done?s(a.value):i(a.value).then(c,f)}u((n=n.apply(t,e||[])).next())})},Xc=d1(dy()),yI=wy(),eu=_y(),j=d1(un()),gI=Ay(),Oo=Mc(),Te=fn(),tu=qy(),bI=Gy(),vI=Qy(),ru=Gn(),mI=p1(),nu=class extends Xc.default{constructor(e,r={}){let n=[j.GossipsubIDv11,j.GossipsubIDv10],i=Object.assign(Object.assign({gossipIncoming:!0,fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:j.GossipsubD,Dlo:j.GossipsubDlo,Dhi:j.GossipsubDhi,Dscore:j.GossipsubDscore,Dout:j.GossipsubDout,Dlazy:j.GossipsubDlazy,heartbeatInterval:j.GossipsubHeartbeatInterval,fanoutTTL:j.GossipsubFanoutTTL,mcacheLength:j.GossipsubHistoryLength,mcacheGossip:j.GossipsubHistoryGossip,seenTTL:j.GossipsubSeenTTL},r),{scoreParams:tu.createPeerScoreParams(r.scoreParams),scoreThresholds:tu.createPeerScoreThresholds(r.scoreThresholds)});i.fallbackToFloodsub&&n.push(j.FloodsubID);super(Object.assign({debugName:"libp2p:gossipsub",multicodecs:n,libp2p:e},i));this._options=i,this.direct=new Set(i.directPeers.map(s=>s.id.toB58String())),i.directPeers.forEach(s=>{e.peerStore.addressBook.add(s.id,s.addrs)}),this.seenCache=new vI({validity:i.seenTTL/1e3}),this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.messageCache=r.messageCache||new yI.MessageCache(i.mcacheGossip,i.mcacheLength,this.getMsgId.bind(this)),this.heartbeat=new gI.Heartbeat(this),this.heartbeatTicks=0,this.gossipTracer=new bI.IWantTracer(this.getMsgId.bind(this)),this._libp2p=e,this.score=new tu.PeerScore(this._options.scoreParams,e.connectionManager,this.getMsgId.bind(this))}_decodeRpc(e){return eu.RPC.decode(e)}_encodeRpc(e){return eu.RPC.encode(e).finish()}_addPeer(e,r){let n=super._addPeer(e,r);this.score.addPeer(e.toB58String());let i=!1;for(let s of this._libp2p.connectionManager.getAll(e))if(s.stat.direction==="outbound"&&Array.from(s.registry.values()).some(o=>r===o.protocol)){i=!0;break}return this.outbound.set(n.id.toB58String(),i),n}_removePeer(e){let r=super._removePeer(e),n=e.toB58String();for(let i of this.mesh.values())i.delete(n);for(let i of this.fanout.values())i.delete(n);return this.gossip.delete(n),this.control.delete(n),this.outbound.delete(n),this.score.removePeer(n),r}_processRpc(e,r,n){let i=Object.create(null,{_processRpc:{get:()=>super._processRpc}});return Zn(this,void 0,void 0,function*(){return(yield i._processRpc.call(this,e,r,n))?(n.control&&this._processRpcControlMessage(e,n.control),!0):!1})}_processRpcControlMessage(e,r){if(!r)return;let n=r.ihave?this._handleIHave(e,r.ihave):[],i=r.iwant?this._handleIWant(e,r.iwant):[],s=r.graft?this._handleGraft(e,r.graft):[];if(r.prune&&this._handlePrune(e,r.prune),!n.length&&!i.length&&!s.length)return;let o=Te.createGossipRpc(i,{iwant:n,prune:s});this._sendRpc(e,o)}_processRpcMessage(e){let r=Object.create(null,{_processRpcMessage:{get:()=>super._processRpcMessage}});return Zn(this,void 0,void 0,function*(){let n=yield this.getMsgId(e),i=Te.messageIdToString(n);if(this.seenCache.has(i)){this.score.duplicateMessage(e);return}this.seenCache.put(i),yield this.score.validateMessage(e),yield r._processRpcMessage.call(this,e)})}_acceptFrom(e){return this.direct.has(e)||this.score.score(e)>=this._options.scoreThresholds.graylistThreshold}validate(e){let r=Object.create(null,{validate:{get:()=>super.validate}});return Zn(this,void 0,void 0,function*(){try{yield r.validate.call(this,e)}catch(n){throw this.score.rejectMessage(e,n.code),this.gossipTracer.rejectMessage(e,n.code),n}})}_handleIHave(e,r){if(!r.length)return[];let n=this.score.score(e);if(n<this._options.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,n),[];let i=(this.peerhave.get(e)||0)+1;if(this.peerhave.set(e,i),i>j.GossipsubMaxIHaveMessages)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,i),[];let s=this.iasked.get(e)||0;if(s>=j.GossipsubMaxIHaveLength)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,s),[];let o=new Map;if(r.forEach(({topicID:u,messageIDs:a})=>{!u||!a||!this.mesh.has(u)||a.forEach(h=>{let l=Te.messageIdToString(h);this.seenCache.has(l)||o.set(l,h)})}),!o.size)return[];let c=o.size;c+s>j.GossipsubMaxIHaveLength&&(c=j.GossipsubMaxIHaveLength-s),this.log("IHAVE: Asking for %d out of %d messages from %s",c,o.size,e);let f=Array.from(o.values());return Te.shuffle(f),f=f.slice(0,c),this.iasked.set(e,s+c),this.gossipTracer.addPromise(e,f),[{messageIDs:f}]}_handleIWant(e,r){if(!r.length)return[];let n=this.score.score(e);if(n<this._options.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,n),[];let i=new Map;return r.forEach(({messageIDs:s})=>{s&&s.forEach(o=>{let[c,f]=this.messageCache.getForPeer(o,e);if(!!c){if(f>j.GossipsubGossipRetransmission){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,o);return}i.set(Te.messageIdToString(o),c)}})}),i.size?(this.log("IWANT: Sending %d messages to %s",i.size,e),Array.from(i.values()).map(Xc.utils.normalizeOutRpcMessage)):[]}_handleGraft(e,r){let n=[],i=this.score.score(e),s=this._now(),o=this._options.doPX;return r.forEach(({topicID:c})=>{var f;if(!c)return;let u=this.mesh.get(c);if(!u){o=!1;return}if(u.has(e))return;if(this.direct.has(e)){this.log("GRAFT: ignoring request from direct peer %s",e),n.push(c),o=!1;return}let a=(f=this.backoff.get(c))===null||f===void 0?void 0:f.get(e);if(typeof a=="number"&&s<a){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1),o=!1;let h=a+j.GossipsubGraftFloodThreshold-j.GossipsubPruneBackoff;s<h&&this.score.addPenalty(e,1),this._addBackoff(e,c),n.push(c);return}if(i<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,i,c),n.push(c),o=!1,this._addBackoff(e,c);return}if(u.size>=this._options.Dhi&&!this.outbound.get(e)){n.push(c),this._addBackoff(e,c);return}this.log("GRAFT: Add mesh link from %s in %s",e,c),this.score.graft(e,c),u.add(e)}),n.length?n.map(c=>this._makePrune(e,c,o)):[]}_handlePrune(e,r){let n=this.score.score(e);r.forEach(({topicID:i,backoff:s,peers:o})=>{if(!i)return;let c=this.mesh.get(i);if(!!c&&(this.log("PRUNE: Remove mesh link to %s in %s",e,i),this.score.prune(e,i),c.delete(e),typeof s=="number"&&s>0?this._doAddBackoff(e,i,s*1e3):this._addBackoff(e,i),o&&o.length)){if(n<this._options.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,n,i);return}this._pxConnect(o)}})}_addBackoff(e,r){this._doAddBackoff(e,r,j.GossipsubPruneBackoff)}_doAddBackoff(e,r,n){let i=this.backoff.get(r);i||(i=new Map,this.backoff.set(r,i));let s=this._now()+n;(i.get(e)||0)<s&&i.set(e,s)}_applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,r)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",r,e),this.score.addPenalty(r,e)})}_clearBackoff(){if(this.heartbeatTicks%j.GossipsubPruneBackoffTicks!=0)return;let e=this._now();this.backoff.forEach((r,n)=>{r.forEach((i,s)=>{i<e&&r.delete(s)}),r.size===0&&this.backoff.delete(n)})}_directConnect(){if(this.heartbeatTicks%j.GossipsubDirectConnectTicks!=0)return;let e=[];this.direct.forEach(r=>{let n=this.peers.get(r);(!n||!n.isWritable)&&e.push(r)}),e.length&&e.forEach(r=>{this._connect(r)})}_pxConnect(e){return Zn(this,void 0,void 0,function*(){e.length>j.GossipsubPrunePeers&&(Te.shuffle(e),e=e.slice(0,j.GossipsubPrunePeers));let r=[];yield Promise.all(e.map(n=>Zn(this,void 0,void 0,function*(){if(!n.peerID)return;let s=ru.createFromBytes(n.peerID).toB58String();if(!this.peers.has(s)){if(!n.signedPeerRecord){r.push(s);return}try{let o=yield mI.openAndCertify(n.signedPeerRecord,"libp2p-peer-record"),c=o.peerId.toB58String();if(s!==c){this.log("bogus peer record obtained through px: peer ID %s doesn't match expected peer %s",c,s);return}if(!this._libp2p.peerStore.addressBook.consumePeerRecord(o)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}r.push(s)}catch(o){this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}}))),!!r.length&&r.forEach(n=>this._connect(n))})}start(){super.start(),this.heartbeat.start(),this.score.start(),this._directPeerInitial=setTimeout(()=>{this.direct.forEach(e=>{this._connect(e)})},j.GossipsubDirectConnectInitialDelay)}stop(){super.stop(),this.heartbeat.stop(),this.score.stop(),this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.gossipTracer.clear(),clearTimeout(this._directPeerInitial)}_connect(e){this.log("Initiating connection with %s",e),this._libp2p.dialProtocol(ru.createFromB58String(e),this.multicodecs)}subscribe(e){super.subscribe(e),this.join(e)}unsubscribe(e){super.unsubscribe(e),this.leave(e)}join(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("JOIN %s",e);let r=this.fanout.get(e);if(r)r.forEach(n=>{this.score.score(n)<0&&r.delete(n)}),r.size<this._options.D&&Oo.getGossipPeers(this,e,this._options.D-r.size,n=>!r.has(n)&&!this.direct.has(n)&&this.score.score(n)>=0).forEach(n=>r.add(n)),this.mesh.set(e,r),this.fanout.delete(e),this.lastpub.delete(e);else{let n=Oo.getGossipPeers(this,e,this._options.D,i=>!this.direct.has(i)&&this.score.score(i)>=0);this.mesh.set(e,n)}this.mesh.get(e).forEach(n=>{this.log("JOIN: Add mesh link to %s in %s",n,e),this._sendGraft(n,e)})}leave(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e);let r=this.mesh.get(e);r&&(r.forEach(n=>{this.log("LEAVE: Remove mesh link to %s in %s",n,e),this._sendPrune(n,e)}),this.mesh.delete(e))}_publish(e){return Zn(this,void 0,void 0,function*(){e.receivedFrom!==this.peerId.toB58String()&&(this.score.deliverMessage(e),this.gossipTracer.deliverMessage(e));let r=yield this.getMsgId(e),n=Te.messageIdToString(r);this.seenCache.put(n),this.messageCache.put(e);let i=new Set;e.topicIDs.forEach(o=>{let c=this.topics.get(o);if(!!c)if(this._options.floodPublish&&e.from===this.peerId.toB58String())c.forEach(f=>{(this.direct.has(f)||this.score.score(f)>=this._options.scoreThresholds.publishThreshold)&&i.add(f)});else{this.direct.forEach(u=>{i.add(u)}),c.forEach(u=>{let a=this.score.score(u),h=this.peers.get(u);!h||h.protocol===j.FloodsubID&&a>=this._options.scoreThresholds.publishThreshold&&i.add(u)});let f=this.mesh.get(o);if(!f||!f.size){if(f=this.fanout.get(o),!f){let u=Oo.getGossipPeers(this,o,this._options.D,a=>this.score.score(a)>=this._options.scoreThresholds.publishThreshold);u.size>0?(f=u,this.fanout.set(o,u)):f=new Set}this.lastpub.set(o,this._now())}f.forEach(u=>{i.add(u)})}});let s=Te.createGossipRpc([Xc.utils.normalizeOutRpcMessage(e)]);i.forEach(o=>{o!==e.from&&this._sendRpc(o,s)})})}_sendGraft(e,r){let n=[{topicID:r}],i=Te.createGossipRpc([],{graft:n});this._sendRpc(e,i)}_sendPrune(e,r){let n=[this._makePrune(e,r,this._options.doPX)],i=Te.createGossipRpc([],{prune:n});this._sendRpc(e,i)}_sendRpc(e,r){let n=this.peers.get(e);if(!n||!n.isWritable)return;let i=this.control.get(e);i&&(this._piggybackControl(e,r,i),this.control.delete(e));let s=this.gossip.get(e);s&&(this._piggybackGossip(e,r,s),this.gossip.delete(e)),n.write(eu.RPC.encode(r).finish())}_piggybackControl(e,r,n){let i=(n.graft||[]).filter(({topicID:o})=>(o&&this.mesh.get(o)||new Set).has(e)),s=(n.prune||[]).filter(({topicID:o})=>!(o&&this.mesh.get(o)||new Set).has(e));!i.length&&!s.length||(r.control?(r.control.graft=r.control.graft&&r.control.graft.concat(i),r.control.prune=r.control.prune&&r.control.prune.concat(s)):r.control={ihave:[],iwant:[],graft:i,prune:s})}_piggybackGossip(e,r,n){r.control||(r.control={ihave:[],iwant:[],graft:[],prune:[]}),r.control.ihave=n}_sendGraftPrune(e,r,n){let i=this._options.doPX;for(let[s,o]of e){let c=o.map(h=>({topicID:h})),f=[],u=r.get(s);u&&(f=u.map(h=>this._makePrune(s,h,i&&!n.get(s))),r.delete(s));let a=Te.createGossipRpc([],{graft:c,prune:f});this._sendRpc(s,a)}for(let[s,o]of r){let c=o.map(u=>this._makePrune(s,u,i&&!n.get(s))),f=Te.createGossipRpc([],{prune:c});this._sendRpc(s,f)}}_emitGossip(e,r){let n=this.messageCache.getGossipIDs(e);if(!n.length)return;Te.shuffle(n),n.length>j.GossipsubMaxIHaveLength&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",n.length);let i=[],s=this.topics.get(e);if(!s)return;s.forEach(f=>{let u=this.peers.get(f);!u||!r.has(f)&&!this.direct.has(f)&&Te.hasGossipProtocol(u.protocol)&&this.score.score(f)>=this._options.scoreThresholds.gossipThreshold&&i.push(f)});let o=this._options.Dlazy,c=j.GossipsubGossipFactor*i.length;c>o&&(o=c),o>i.length?o=i.length:Te.shuffle(i),i.slice(0,o).forEach(f=>{let u=n;n.length>j.GossipsubMaxIHaveLength&&(u=Te.shuffle(u.slice()).slice(0,j.GossipsubMaxIHaveLength)),this._pushGossip(f,{topicID:e,messageIDs:u})})}_flush(){for(let[e,r]of this.gossip.entries()){this.gossip.delete(e);let n=Te.createGossipRpc([],{ihave:r});this._sendRpc(e,n)}for(let[e,r]of this.control.entries()){this.control.delete(e);let n=Te.createGossipRpc([],{graft:r.graft,prune:r.prune});this._sendRpc(e,n)}}_pushGossip(e,r){this.log("Add gossip to %s",e);let n=this.gossip.get(e)||[];this.gossip.set(e,n.concat(r))}_now(){return Date.now()}_makePrune(e,r,n){if(this.peers.get(e).protocol===j.GossipsubIDv10)return{topicID:r,peers:[]};let i=j.GossipsubPruneBackoff/1e3,s=[];return n&&Oo.getGossipPeers(this,r,j.GossipsubPrunePeers,c=>c!==e&&this.score.score(c)>=0).forEach(c=>{let f=ru.createFromB58String(c);s.push({peerID:f.toBytes(),signedPeerRecord:this._libp2p.peerStore.addressBook.getRawEnvelope(f)})}),{topicID:r,peers:s,backoff:i}}};nu.multicodec=j.GossipsubIDv11;y1.exports=nu});return xI();})();
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! noble-ed25519 - MIT License (c) Paul Miller (paulmillr.com) */
/*! noble-secp256k1 - MIT License (c) Paul Miller (paulmillr.com) */
return Libp2pGossipsub}));
